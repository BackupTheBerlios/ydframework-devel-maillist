<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm: .	backend
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/ydframework-devel/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2034%20-%20in%20YDFramework2.0/trunk/examples/cm%3A%20.%0A%09backend&In-Reply-To=%3C4aef63030608220843u77b8e1c3jb68a4d1e8daa7de2%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000541.html">
   <LINK REL="Next"  HREF="000544.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm: .	backend</H1>
    <B>Pieter Claerhout</B> 
    <A HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2034%20-%20in%20YDFramework2.0/trunk/examples/cm%3A%20.%0A%09backend&In-Reply-To=%3C4aef63030608220843u77b8e1c3jb68a4d1e8daa7de2%40mail.gmail.com%3E"
       TITLE="[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm: .	backend">pieter at yellowduck.be
       </A><BR>
    <I>Tue Aug 22 17:43:59 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000541.html">[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm: . backend
</A></li>
        <LI>Next message: <A HREF="000544.html">[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm:	.	backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#542">[ date ]</a>
              <a href="thread.html#542">[ thread ]</a>
              <a href="subject.html#542">[ subject ]</a>
              <a href="author.html#542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ximian,

I think it would be very handy if you could also include the SQL script to
create the database in the commits. It might scare people off having to
install DBDesigner just to get the database export...

cheers,


pieter

On 8/22/06, <A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">ximian at mail.berlios.de</A> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">ximian at mail.berlios.de</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Author: ximian
</I>&gt;<i> Date: 2006-08-22 17:38:40 +0200 (Tue, 22 Aug 2006)
</I>&gt;<i> New Revision: 2034
</I>&gt;<i>
</I>&gt;<i> Modified:
</I>&gt;<i>   YDFramework2.0/trunk/examples/cm/DBDesigner4.xml
</I>&gt;<i>   YDFramework2.0/trunk/examples/cm/backend/userdetails.php
</I>&gt;<i>   YDFramework2.0/trunk/examples/cm/cm.php
</I>&gt;<i> Log:
</I>&gt;<i> updated userdetails cm example and db scheme for new YDCMUsers version
</I>&gt;<i>
</I>&gt;<i> Modified: YDFramework2.0/trunk/examples/cm/DBDesigner4.xml
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- YDFramework2.0/trunk/examples/cm/DBDesigner4.xml    2006-08-22
</I>&gt;<i> 15:33:32 UTC (rev 2033)
</I>&gt;<i> +++ YDFramework2.0/trunk/examples/cm/DBDesigner4.xml    2006-08-22
</I>&gt;<i> 15:38:40 UTC (rev 2034)
</I>&gt;<i> @@ -1,7 +1,7 @@
</I>&gt;<i> &lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot; ?&gt;
</I>&gt;<i> &lt;DBMODEL Version=&quot;4.0&quot;&gt;
</I>&gt;<i> &lt;SETTINGS&gt;
</I>&gt;<i> -&lt;GLOBALSETTINGS ModelName=&quot;YDCM scheme&quot; IDModel=&quot;0&quot; IDVersion=&quot;0&quot;
</I>&gt;<i> VersionStr=&quot;1.0.0.0&quot; Comments=&quot;&quot; UseVersionHistroy=&quot;1&quot; AutoIncVersion=&quot;1&quot;
</I>&gt;<i> DatabaseType=&quot;MySQL&quot; ZoomFac=&quot;74.00&quot; XPos=&quot;119&quot; YPos=&quot;31&quot;
</I>&gt;<i> DefaultDataType=&quot;5&quot; DefaultTablePrefix=&quot;0&quot; DefSaveDBConn=&quot;&quot; DefSyncDBConn=&quot;&quot;
</I>&gt;<i> DefQueryDBConn=&quot;&quot; Printer=&quot;&quot; HPageCount=&quot;4.0&quot; PageAspectRatio=&quot;
</I>&gt;<i> 1.440892512336408&quot; PageOrientation=&quot;1&quot; PageFormat=&quot;A4 (210x297 mm,
</I>&gt;<i> 8.26x11.7 inches)&quot; SelectedPages=&quot;&quot; UsePositionGrid=&quot;1&quot; PositionGridX=&quot;20&quot;
</I>&gt;<i> PositionGridY=&quot;20&quot; TableNameInRefs=&quot;0&quot; DefaultTableType=&quot;0&quot;
</I>&gt;<i> ActivateRefDefForNewRelations=&quot;1&quot; FKPrefix=&quot;&quot; FKPostfix=&quot;&quot;
</I>&gt;<i> CreateFKRefDefIndex=&quot;0&quot; DBQuoteCharacter=&quot;`&quot; CreateSQLforLinkedObjects=&quot;0&quot;
</I>&gt;<i> DefModelFont=&quot;Tahoma&quot; CanvasWidth=&quot;4096&quot; CanvasHeight=&quot;2842&quot; /&gt;
</I>&gt;<i> +&lt;GLOBALSETTINGS ModelName=&quot;YDCM scheme&quot; IDModel=&quot;0&quot; IDVersion=&quot;0&quot;
</I>&gt;<i> VersionStr=&quot;1.0.0.0&quot; Comments=&quot;&quot; UseVersionHistroy=&quot;1&quot; AutoIncVersion=&quot;1&quot;
</I>&gt;<i> DatabaseType=&quot;MySQL&quot; ZoomFac=&quot;74.00&quot; XPos=&quot;102&quot; YPos=&quot;31&quot;
</I>&gt;<i> DefaultDataType=&quot;5&quot; DefaultTablePrefix=&quot;0&quot; DefSaveDBConn=&quot;&quot; DefSyncDBConn=&quot;&quot;
</I>&gt;<i> DefQueryDBConn=&quot;&quot; Printer=&quot;&quot; HPageCount=&quot;4.0&quot; PageAspectRatio=&quot;
</I>&gt;<i> 1.440892512336408&quot; PageOrientation=&quot;1&quot; PageFormat=&quot;A4 (210x297 mm,
</I>&gt;<i> 8.26x11.7 inches)&quot; SelectedPages=&quot;&quot; UsePositionGrid=&quot;1&quot; PositionGridX=&quot;20&quot;
</I>&gt;<i> PositionGridY=&quot;20&quot; TableNameInRefs=&quot;0&quot; DefaultTableType=&quot;0&quot;
</I>&gt;<i> ActivateRefDefForNewRelations=&quot;1&quot; FKPrefix=&quot;&quot; FKPostfix=&quot;&quot;
</I>&gt;<i> CreateFKRefDefIndex=&quot;0&quot; DBQuoteCharacter=&quot;`&quot; CreateSQLforLinkedObjects=&quot;0&quot;
</I>&gt;<i> DefModelFont=&quot;Tahoma&quot; CanvasWidth=&quot;4096&quot; CanvasHeight=&quot;2842&quot; /&gt;
</I>&gt;<i> &lt;DATATYPEGROUPS&gt;
</I>&gt;<i> &lt;DATATYPEGROUP Name=&quot;Numeric Types&quot; Icon=&quot;1&quot; /&gt;
</I>&gt;<i> &lt;DATATYPEGROUP Name=&quot;Date and Time Types&quot; Icon=&quot;2&quot; /&gt;
</I>&gt;<i> @@ -1027,7 +1027,7 @@
</I>&gt;<i> &lt;/INDEX&gt;
</I>&gt;<i> &lt;/INDICES&gt;
</I>&gt;<i> &lt;/TABLE&gt;
</I>&gt;<i> -&lt;TABLE ID=&quot;1771&quot; Tablename=&quot;YDCMPermissions&quot; PrevTableName=&quot;Table_14&quot;
</I>&gt;<i> XPos=&quot;800&quot; YPos=&quot;620&quot; TableType=&quot;0&quot; TablePrefix=&quot;0&quot; nmTable=&quot;0&quot;
</I>&gt;<i> Temporary=&quot;0&quot; UseStandardInserts=&quot;0&quot; StandardInserts=&quot;INSERT INTO
</I>&gt;<i> `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`object_id`,`schedule`,`date_start`,`date_end`,`user_id`)
</I>&gt;<i> VALUES (117,\aYDCMRootmenu\a,\adelete\a,NULL,0,\a0000-00-00
</I>&gt;<i> 00:00:00\a,\a0000-00-00 00:00:00\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`object_id`,`schedule`,`date_start`,`date_end`,`user_id`)
</I>&gt;<i> VALUES (118,\aYDCMPage\a,\apublish\a,NULL,0,\a0000-00-00
</I>&gt;<i> 00:00:00\a,\a0000-00-00 00:00:00\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`object_id`,`schedule`,`date_start`,`date_end`,`user_id`)
</I>&gt;<i> VALUES (119,\aYDCMPage\a,\acreate\a,NULL,0,\a0000-00-00
</I>&gt;<i> 00:00:00\a,\a0000-00-00 00:00:00\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`object_id`,`schedule`,`date_start`,`da!
</I>&gt;<i> te_end`,`user_id`) VALUES
</I>&gt;<i> (120,\aYDCMPage\a,\apublish\a,NULL,0,\a0000-00-00 00:00:00\a,\a0000-00-00
</I>&gt;<i> 00:00:00\a,101);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`object_id`,`schedule`,`date_start`,`date_end`,`user_id`)
</I>&gt;<i> VALUES (121,\aYDCMPage\a,\acreate\a,NULL,0,\a0000-00-00
</I>&gt;<i> 00:00:00\a,\a0000-00-00 00:00:00\a,101);\n&quot;
</I>&gt;<i> TableOptions=&quot;DelayKeyTblUpdates=0\nPackKeys=0\nRowChecksum=0\nRowFormat=0\nUseRaid=0\nRaidType=0\n&quot;
</I>&gt;<i> Comments=&quot;&quot; Collapsed=&quot;0&quot; IsLinkedObject=&quot;0&quot; IDLinkedModel=&quot;-1&quot;
</I>&gt;<i> Obj_id_Linked=&quot;-1&quot; OrderPos=&quot;37&quot; &gt;
</I>&gt;<i> +&lt;TABLE ID=&quot;1771&quot; Tablename=&quot;YDCMPermissions&quot; PrevTableName=&quot;Table_14&quot;
</I>&gt;<i> XPos=&quot;800&quot; YPos=&quot;620&quot; TableType=&quot;0&quot; TablePrefix=&quot;0&quot; nmTable=&quot;0&quot;
</I>&gt;<i> Temporary=&quot;0&quot; UseStandardInserts=&quot;0&quot; StandardInserts=&quot;INSERT INTO
</I>&gt;<i> `ydcmpermissions` (`permission_id`,`object`,`object_action`,`user_id`)
</I>&gt;<i> VALUES (117,\aYDCMRootmenu\a,\adelete\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`user_id`) VALUES
</I>&gt;<i> (118,\aYDCMPage\a,\adelete\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`user_id`) VALUES
</I>&gt;<i> (119,\aYDCMPage\a,\acreate\a,100);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`user_id`) VALUES
</I>&gt;<i> (120,\aYDCMPage\a,\adelete\a,101);\nINSERT INTO `ydcmpermissions`
</I>&gt;<i> (`permission_id`,`object`,`object_action`,`user_id`) VALUES
</I>&gt;<i> (121,\aYDCMPage\a,\acreate\a,101);\n&quot;
</I>&gt;<i> TableOptions=&quot;DelayKeyTblUpdates=0\nPackKeys=0\nRowChecksum=0\nRowFormat=0\nUseRaid=0\nRaidType=0\n&quot;
</I>&gt;<i> Comments=&quot;&quot; Collapsed=&quot;0&quot; IsLinkedObject=&quot;0&quot; IDLinkedModel=&quot;-1&quot;!
</I>&gt;<i> Obj_id_Linked=&quot;-1&quot; OrderPos=&quot;37&quot; &gt;
</I>&gt;<i> &lt;COLUMNS&gt;
</I>&gt;<i> &lt;COLUMN ID=&quot;1781&quot; ColName=&quot;permission_id&quot; PrevColName=&quot;&quot; Pos=&quot;7&quot;
</I>&gt;<i> idDatatype=&quot;5&quot; DatatypeParams=&quot;&quot; Width=&quot;-1&quot; Prec=&quot;-1&quot; PrimaryKey=&quot;1&quot;
</I>&gt;<i> NotNull=&quot;1&quot; AutoInc=&quot;1&quot; IsForeignKey=&quot;0&quot; DefaultValue=&quot;&quot; Comments=&quot;&quot;&gt;
</I>&gt;<i> &lt;OPTIONSELECTED&gt;
</I>&gt;<i> @@ -1051,26 +1051,6 @@
</I>&gt;<i> &lt;OPTIONSELECT Value=&quot;0&quot; /&gt;
</I>&gt;<i> &lt;/OPTIONSELECTED&gt;
</I>&gt;<i> &lt;/COLUMN&gt;
</I>&gt;<i> -&lt;COLUMN ID=&quot;1777&quot; ColName=&quot;object_id&quot; PrevColName=&quot;&quot; Pos=&quot;3&quot;
</I>&gt;<i> idDatatype=&quot;5&quot; DatatypeParams=&quot;&quot; Width=&quot;-1&quot; Prec=&quot;-1&quot; PrimaryKey=&quot;0&quot;
</I>&gt;<i> NotNull=&quot;0&quot; AutoInc=&quot;0&quot; IsForeignKey=&quot;0&quot; DefaultValue=&quot;&quot; Comments=&quot;&quot;&gt;
</I>&gt;<i> -&lt;OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;OPTIONSELECT Value=&quot;1&quot; /&gt;
</I>&gt;<i> -&lt;OPTIONSELECT Value=&quot;0&quot; /&gt;
</I>&gt;<i> -&lt;/OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/COLUMN&gt;
</I>&gt;<i> -&lt;COLUMN ID=&quot;1778&quot; ColName=&quot;schedule&quot; PrevColName=&quot;&quot; Pos=&quot;4&quot;
</I>&gt;<i> idDatatype=&quot;1&quot; DatatypeParams=&quot;(1)&quot; Width=&quot;-1&quot; Prec=&quot;-1&quot; PrimaryKey=&quot;0&quot;
</I>&gt;<i> NotNull=&quot;1&quot; AutoInc=&quot;0&quot; IsForeignKey=&quot;0&quot; DefaultValue=&quot;0&quot; Comments=&quot;This
</I>&gt;<i> permission has start and date time&quot;&gt;
</I>&gt;<i> -&lt;OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;OPTIONSELECT Value=&quot;1&quot; /&gt;
</I>&gt;<i> -&lt;OPTIONSELECT Value=&quot;0&quot; /&gt;
</I>&gt;<i> -&lt;/OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/COLUMN&gt;
</I>&gt;<i> -&lt;COLUMN ID=&quot;1779&quot; ColName=&quot;date_start&quot; PrevColName=&quot;&quot; Pos=&quot;5&quot;
</I>&gt;<i> idDatatype=&quot;15&quot; DatatypeParams=&quot;&quot; Width=&quot;-1&quot; Prec=&quot;-1&quot; PrimaryKey=&quot;0&quot;
</I>&gt;<i> NotNull=&quot;1&quot; AutoInc=&quot;0&quot; IsForeignKey=&quot;0&quot; DefaultValue=&quot;&quot; Comments=&quot;&quot;&gt;
</I>&gt;<i> -&lt;OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/COLUMN&gt;
</I>&gt;<i> -&lt;COLUMN ID=&quot;1780&quot; ColName=&quot;date_end&quot; PrevColName=&quot;&quot; Pos=&quot;6&quot;
</I>&gt;<i> idDatatype=&quot;15&quot; DatatypeParams=&quot;&quot; Width=&quot;-1&quot; Prec=&quot;-1&quot; PrimaryKey=&quot;0&quot;
</I>&gt;<i> NotNull=&quot;1&quot; AutoInc=&quot;0&quot; IsForeignKey=&quot;0&quot; DefaultValue=&quot;&quot; Comments=&quot;&quot;&gt;
</I>&gt;<i> -&lt;OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/OPTIONSELECTED&gt;
</I>&gt;<i> -&lt;/COLUMN&gt;
</I>&gt;<i> &lt;/COLUMNS&gt;
</I>&gt;<i> &lt;RELATIONS_START&gt;
</I>&gt;<i> &lt;RELATION_START ID=&quot;1785&quot; /&gt;
</I>&gt;<i>
</I>&gt;<i> Modified: YDFramework2.0/trunk/examples/cm/backend/userdetails.php
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- YDFramework2.0/trunk/examples/cm/backend/userdetails.php    2006-08-22
</I>&gt;<i> 15:33:32 UTC (rev 2033)
</I>&gt;<i> +++ YDFramework2.0/trunk/examples/cm/backend/userdetails.php    2006-08-22
</I>&gt;<i> 15:38:40 UTC (rev 2034)
</I>&gt;<i> @@ -17,57 +17,62 @@
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         // Default action (that shows user details form with some editable
</I>&gt;<i> fields)
</I>&gt;<i> -               // User should only update his details eg name, email
</I>&gt;<i>         function actionDefault() {
</I>&gt;<i>
</I>&gt;<i> -                       // add form. User cannot edit username, cannot see
</I>&gt;<i> password, cannot edit login details, can edit user details
</I>&gt;<i> -                       $this-&gt;users-&gt;addFormDetails( false, false, false,
</I>&gt;<i> true );
</I>&gt;<i> +                       // get user id 101 details and display them
</I>&gt;<i> +                       YDDebugUtil::dump( $this-&gt;users-&gt;getUser( 101,
</I>&gt;<i> true ) );
</I>&gt;<i> +        }
</I>&gt;<i>
</I>&gt;<i> -                       // get info of user id 100
</I>&gt;<i> -                       $defaults = $this-&gt;users-&gt;getUser( 100 );
</I>&gt;<i>
</I>&gt;<i> -                       // get user form (filled with previous defaults)
</I>&gt;<i> -                       $form = $this-&gt;users-&gt;getForm( $defaults );
</I>&gt;<i> +        // Edit user example
</I>&gt;<i> +        function actionEdit() {
</I>&gt;<i>
</I>&gt;<i> -                       // show form :)
</I>&gt;<i> -                       $form-&gt;display();
</I>&gt;<i> -        }
</I>&gt;<i> +                       // add form of user 101. User cannot edit
</I>&gt;<i> username, cannot see password, cannot see login details, can edit user
</I>&gt;<i> details, cannot see access info, cannot see permissions
</I>&gt;<i> +                       $this-&gt;users-&gt;addFormEdit( 101, false, null, null,
</I>&gt;<i> true, null, true );
</I>&gt;<i>
</I>&gt;<i> +                       // get user form and add a custom submit button
</I>&gt;<i> +                       $form = &amp; $this-&gt;users-&gt;getForm();
</I>&gt;<i>
</I>&gt;<i> -        // Change details example
</I>&gt;<i> -        function actionChangeDetails() {
</I>&gt;<i> +                       // if form is not submitted just show it
</I>&gt;<i> +                       if ( ! $form-&gt;isSubmitted() ) return
</I>&gt;<i> $form-&gt;display();
</I>&gt;<i>
</I>&gt;<i> -                       // add form. User cannot edit username, cannot see
</I>&gt;<i> password, cannot edit login details, can edit user details
</I>&gt;<i> -                       $this-&gt;users-&gt;addFormDetails( false, false, false,
</I>&gt;<i> true );
</I>&gt;<i> +                       // update user 101 with submitted information,
</I>&gt;<i> magic isn't it ;) 100 is our id (created user, for loggin)
</I>&gt;<i> +                       $result = $this-&gt;users-&gt;saveFormEdit( 101, 100 );
</I>&gt;<i>
</I>&gt;<i> -                       // get form filled with details from user id 100
</I>&gt;<i> -                       $defaults = $this-&gt;users-&gt;getUser( 100 );
</I>&gt;<i> +                       // check if result is a array (form error
</I>&gt;<i> messages)
</I>&gt;<i> +                       if( is_array( $result ) ) return $form-&gt;display();
</I>&gt;<i>
</I>&gt;<i> -                       // get user details form with a submit button
</I>&gt;<i> -                       $form = $this-&gt;users-&gt;getForm( $defaults );
</I>&gt;<i> -                       $form-&gt;addElement( 'submit', '_cmdSubmit',
</I>&gt;<i> 'Submit' );
</I>&gt;<i> +                       // if update was sucessfull, show ok message in
</I>&gt;<i> current language
</I>&gt;<i> +                       if ( $result == 1 ) return print( t( 'user details
</I>&gt;<i> updated' ) );
</I>&gt;<i>
</I>&gt;<i> -                       // if we have submitted the form, update user
</I>&gt;<i> -                       if ( $form-&gt;isSubmitted() ){
</I>&gt;<i> +                       // if form is valid but details are not changed
</I>&gt;<i> (because are same as the db ones)
</I>&gt;<i> +                       if ( $result == 0 ) return print( t( 'user not
</I>&gt;<i> updated' ) );
</I>&gt;<i> +        }
</I>&gt;<i>
</I>&gt;<i> -                               // update user 100 with submitted
</I>&gt;<i> information, magic isn't it ;)
</I>&gt;<i> -                               $result = $this-&gt;users-&gt;changeUserForm(
</I>&gt;<i> 100 );
</I>&gt;<i>
</I>&gt;<i> -                               // check if result is a array (form error
</I>&gt;<i> messages)
</I>&gt;<i> -                               if( is_array( $result ) ) return print(
</I>&gt;<i> implode( '&lt;br&gt;', $result ) );
</I>&gt;<i> +               // this action will add a new sub-user of the root
</I>&gt;<i> (super-administrator: id 100)
</I>&gt;<i> +               function actionNew(){
</I>&gt;<i>
</I>&gt;<i> -                               // if update was sucessfull, show ok
</I>&gt;<i> message in current language
</I>&gt;<i> -                               if ( $result == 1 ) return print( t( 'user
</I>&gt;<i> details updated' ) );
</I>&gt;<i> +                       // add element as child of user 100. User can edit
</I>&gt;<i> username, can edit password, can edit login details, can edit user details,
</I>&gt;<i> cannot see access info, can edit permissions
</I>&gt;<i> +                       $this-&gt;users-&gt;addFormNew( 100, true, true, true,
</I>&gt;<i> true, null, true );
</I>&gt;<i>
</I>&gt;<i> -                               // if form is valid but details are not
</I>&gt;<i> changed (because are same as the db ones)
</I>&gt;<i> -                               if ( $result == 0 ) return print( t( 'user
</I>&gt;<i> not updated' ) );
</I>&gt;<i> -                       }
</I>&gt;<i> +                       // get form and add a custom submition button
</I>&gt;<i> +                       $form = &amp; $this-&gt;users-&gt;getForm();
</I>&gt;<i>
</I>&gt;<i> -                       // show form :)
</I>&gt;<i> -                       $form-&gt;display();
</I>&gt;<i> -        }
</I>&gt;<i> +                       // if form is not submitted just show it
</I>&gt;<i> +                       if ( ! $form-&gt;isSubmitted() ) return
</I>&gt;<i> $form-&gt;display();
</I>&gt;<i>
</I>&gt;<i> +                       // add user ( 1st argument 100: parent of new user
</I>&gt;<i> is 100; 2nd arg 100: we (user id that is creating this element) have id 100
</I>&gt;<i> +                       $result = $this-&gt;users-&gt;saveFormNew( 100, 100 );
</I>&gt;<i> +
</I>&gt;<i> +                       // check if result has form errors
</I>&gt;<i> +                       if ( is_array( $result ) ) return
</I>&gt;<i> $form-&gt;display();
</I>&gt;<i>
</I>&gt;<i> +                       // if creation is sucessfull, show ok message in
</I>&gt;<i> current language
</I>&gt;<i> +                       print( t( 'user added' ) );
</I>&gt;<i> +               }
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     // Process the request
</I>&gt;<i>
</I>&gt;<i> Modified: YDFramework2.0/trunk/examples/cm/cm.php
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- YDFramework2.0/trunk/examples/cm/cm.php     2006-08-22 15:33:32 UTC
</I>&gt;<i> (rev 2033)
</I>&gt;<i> +++ YDFramework2.0/trunk/examples/cm/cm.php     2006-08-22 15:38:40 UTC
</I>&gt;<i> (rev 2034)
</I>&gt;<i> @@ -10,7 +10,7 @@
</I>&gt;<i>     YDInclude( 'YDCMComponent.php' );
</I>&gt;<i>
</I>&gt;<i>     // set YDDatabase instance connection
</I>&gt;<i> -    YDDatabase::registerInstance( 'default', 'mysql', 'tppp', 'root', '',
</I>&gt;<i> 'localhost' );
</I>&gt;<i> +    YDDatabase::registerInstance( 'default', 'mysql', 'ph', 'root', '',
</I>&gt;<i> 'localhost' );
</I>&gt;<i>
</I>&gt;<i>        // set portal language. Currently you can user 'en' and 'pt'.
</I>&gt;<i>        YDLocale::set( 'en' );
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> YDFramework-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">YDFramework-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">https://lists.berlios.de/mailman/listinfo/ydframework-devel</A>
</I>&gt;<i>
</I>


-- 
pieter claerhout . <A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">pieter at yellowduck.be</A> . <A HREF="http://www.yellowduck.be/">http://www.yellowduck.be/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/ydframework-devel/attachments/20060822/cd394b1d/attachment.html">https://lists.berlios.de/pipermail/ydframework-devel/attachments/20060822/cd394b1d/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000541.html">[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm: . backend
</A></li>
	<LI>Next message: <A HREF="000544.html">[ydf-devel] r2034 - in YDFramework2.0/trunk/examples/cm:	.	backend
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#542">[ date ]</a>
              <a href="thread.html#542">[ thread ]</a>
              <a href="subject.html#542">[ subject ]</a>
              <a href="author.html#542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/ydframework-devel">More information about the YDFramework-devel
mailing list</a><br>
</body></html>
