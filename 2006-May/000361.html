<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ydf-devel] r1899 - YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/ydframework-devel/2006-May/index.html" >
   <LINK REL="made" HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r1899%20-%20YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js&In-Reply-To=%3C200605021011.k42ABQjJ017777%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000362.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ydf-devel] r1899 - YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js</H1>
    <B>ximian at berlios.de</B> 
    <A HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r1899%20-%20YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js&In-Reply-To=%3C200605021011.k42ABQjJ017777%40sheep.berlios.de%3E"
       TITLE="[ydf-devel] r1899 - YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js">ximian at berlios.de
       </A><BR>
    <I>Tue May  2 12:11:26 CEST 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000362.html">[ydf-devel] r1900 - YDFramework2.0/trunk/YDFramework2/addons/YDCMPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#361">[ date ]</a>
              <a href="thread.html#361">[ thread ]</a>
              <a href="subject.html#361">[ subject ]</a>
              <a href="author.html#361">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ximian
Date: 2006-05-02 12:11:15 +0200 (Tue, 02 May 2006)
New Revision: 1899

Modified:
   YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js/xajax.js
Log:
YDAjax by default, in the latest xajax release, used a 400ms delay to show the waiting message.
I really didn't like that because it shows an slow ajax processing to an common user (and it's not true).. so.. now we have 0ms ;)

Modified: YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js/xajax.js
===================================================================
--- YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js/xajax.js	2006-04-26 14:41:36 UTC (rev 1898)
+++ YDFramework2.0/trunk/YDFramework2/addons/YDAjax/js/xajax.js	2006-05-02 10:11:15 UTC (rev 1899)
@@ -1 +1 @@
-function Xajax(){this.DebugMessage=function(text){try{if(this.debugWindow==undefined||this.debugWindow.closed==true){this.debugWindow=window.open('about:blank','xajax-debug','width=800,height=600,scrollbars=1,resizable,status');this.debugWindow.document.write('&lt;html&gt;&lt;head&gt;&lt;title&gt;Xajax debug output&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h2&gt;Xajax debug output&lt;/h2&gt;&lt;div id=&quot;debugTag&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;');}; text=text.replace(/&amp;/g,&quot;&amp;&quot;); text=text.replace(/&lt;/g,&quot;&lt;&quot;); text=text.replace(/&gt;/g,&quot;&gt;&quot;); debugTag=this.debugWindow.document.getElementById('debugTag');debugTag.innerHTML=('&lt;b&gt;'+(new Date()).toString()+'&lt;/b&gt;: '+text+'&lt;hr/&gt;')+debugTag.innerHTML;}catch(e){alert(&quot;Xajax Debug:\n &quot;+text);} };this.workId='xajaxWork'+new Date().getTime();this.depth=0;this.getRequestObject=function(){if(xajaxDebug)this.DebugMessage(&quot;Initializing Request Object..&quot;);var req=null;if(typeof XMLHttpRequest!=&quot;undefined&quot;) req=new XMLHttpRequest();if(!req&amp;&amp;typeof ActiveXObject!=&quot;undefined&quot;){try{req=new ActiveXObject!
 (&quot;Msxml2.XMLHTTP&quot;);} catch(e){try{req=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);} catch(e2){try{req=new ActiveXObject(&quot;Msxml2.XMLHTTP.4.0&quot;);} catch(e3){req=null;} } } } if(!req&amp;&amp;window.createRequest) req=window.createRequest();if(!req)this.DebugMessage(&quot;Request Object Instantiation failed.&quot;);return req;}; this.$=function(sId){if(!sId){return null;} var returnObj=document.getElementById(sId);if(!returnObj&amp;&amp;document.all){returnObj=document.all[sId];} if(xajaxDebug&amp;&amp;!returnObj&amp;&amp;sId!=this.workId){this.DebugMessage(&quot;Element with the id \&quot;&quot;+sId+&quot;\&quot; not found.&quot;);} return returnObj;}; this.include=function(sFileName){var objHead=document.getElementsByTagName('head');var objScript=document.createElement('script');objScript.type='text/javascript';objScript.src=sFileName;objHead[0].appendChild(objScript);}; this.stripOnPrefix=function(sEventName){sEventName=sEventName.toLowerCase();if(sEventName.indexOf('on')==0){sEventName=sEventName.replace(/on/,'');} return sEventName;}; this.addOnPre!
 fix=function(sEventName){sEventName=sEventName.toLowerCase();i!
 f(sEvent
Name.indexOf('on')!=0){sEventName='on'+sEventName;} return sEventName;}; this.addHandler=function(sElementId,sEvent,sFunctionName){if(window.addEventListener){sEvent=this.stripOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').addEventListener('&quot;+sEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} else{sAltEvent=this.addOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').attachEvent('&quot;+sAltEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} }; this.removeHandler=function(sElementId,sEvent,sFunctionName){if(window.addEventListener){sEvent=this.stripOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').removeEventListener('&quot;+sEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} else{sAltEvent=this.addOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').detachEvent('&quot;+sAltEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} }; this.create=function(sParentId,sTag,sId){var objParent=this.$(sParentId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);if(objParent) objParent.appendChild(objElement);}; this.insert=function(sBefo!
 reId,sTag,sId){var objSibling=this.$(sBeforeId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);objSibling.parentNode.insertBefore(objElement,objSibling);}; this.insertAfter=function(sAfterId,sTag,sId){var objSibling=this.$(sAfterId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);objSibling.parentNode.insertBefore(objElement,objSibling.nextSibling);}; this.getInput=function(sType,sName,sId){var Obj;if(sType==&quot;radio&quot;&amp;&amp;!window.addEventListener){Obj=document.createElement('&lt;input type=&quot;radio&quot; id=&quot;'+sId+'&quot; name=&quot;'+sName+'&quot;&gt;');} else{Obj=document.createElement('input');Obj.setAttribute('type',sType);Obj.setAttribute('name',sName);Obj.setAttribute('id',sId);} return Obj;}; this.createInput=function(sParentId,sType,sName,sId){var objParent=this.$(sParentId);var objElement=this.getInput(sType,sName,sId);if(objParent&amp;&amp;objElement) objParent.appendChild(objElement);}; this.insertInput=function(sBeforeId,sType,sName,sId){var objSibli!
 ng=this.$(sBeforeId);var objElement=this.getInput(sType,sName,!
 sId);if(
objElement&amp;&amp;objSibling&amp;&amp;objSibling.parentNode) objSibling.parentNode.insertBefore(objElement,objSibling);}; this.remove=function(sId){objElement=this.$(sId);if(objElement&amp;&amp;objElement.parentNode&amp;&amp;objElement.parentNode.removeChild){objElement.parentNode.removeChild(objElement);} }; this.replace=function(sId,sAttribute,sSearch,sReplace){var bFunction=false;if(sAttribute==&quot;innerHTML&quot;) sSearch=this.getBrowserHTML(sSearch);eval(&quot;var txt=this.$('&quot;+sId+&quot;').&quot;+sAttribute);if(typeof txt==&quot;function&quot;){txt=txt.toString();bFunction=true;} if(txt.indexOf(sSearch)&gt;-1){var newTxt='';while(txt.indexOf(sSearch)&gt;-1){x=txt.indexOf(sSearch)+sSearch.length+1;newTxt+=txt.substr(0,x).replace(sSearch,sReplace);txt=txt.substr(x,txt.length-x);} newTxt+=txt;if(bFunction){eval('this.$(&quot;'+sId+'&quot;).'+sAttribute+'=newTxt;');} else if(this.willChange(sId,sAttribute,newTxt)){eval('this.$(&quot;'+sId+'&quot;).'+sAttribute+'=newTxt;');} } }; this.getFormValues=function(frm){var objForm;var submitDisabledElements=false;if(a!
 rguments.length &gt; 1&amp;&amp;arguments[1]==true) submitDisabledElements=true;var prefix=&quot;&quot;;if(arguments.length &gt; 2) prefix=arguments[2];if(typeof(frm)==&quot;string&quot;) objForm=this.$(frm);else objForm=frm;var sXml=&quot;&lt;xjxquery&gt;&lt;q&gt;&quot;;if(objForm&amp;&amp;objForm.tagName=='FORM'){var formElements=objForm.elements;for(var i=0;i &lt; formElements.length;i++){if(!formElements[i].name) continue;if(formElements[i].name.substring(0,prefix.length)!=prefix) continue;if(formElements[i].type&amp;&amp;(formElements[i].type=='radio'||formElements[i].type=='checkbox')&amp;&amp;formElements[i].checked==false) continue;if(formElements[i].disabled&amp;&amp;formElements[i].disabled==true&amp;&amp;submitDisabledElements==false) continue;var name=formElements[i].name;if(name){if(sXml!='&lt;xjxquery&gt;&lt;q&gt;') sXml+='&amp;';if(formElements[i].type=='select-multiple'){for(var j=0;j &lt; formElements[i].length;j++){if(formElements[i].options[j].selected==true) sXml+=name+&quot;=&quot;+encodeURIComponent(formElements[i].options[j].value)+&quot;&amp;&quot;;} } else{sXml+=name+&quot;=&quot;+encodeURIComponen!
 t(formElements[i].value);} } } } sXml+=&quot;&lt;/q&gt;&lt;/xjxquery&gt;&quot;;retur!
 n sXml;}
; this.objectToXML=function(obj){var sXml=&quot;&lt;xjxobj&gt;&quot;;for(i in obj){try{if(i=='constructor') continue;if(obj[i]&amp;&amp;typeof(obj[i])=='function') continue;var key=i;var value=obj[i];if(value&amp;&amp;typeof(value)==&quot;object&quot;&amp;&amp;this.depth &lt;=50){this.depth++;value=this.objectToXML(value);this.depth--;} sXml+=&quot;&lt;e&gt;&lt;k&gt;&quot;+key+&quot;&lt;/k&gt;&lt;v&gt;&quot;+value+&quot;&lt;/v&gt;&lt;/e&gt;&quot;;}  catch(e){if(xajaxDebug)this.DebugMessage(e.name+&quot;: &quot;+e.message);} } sXml+=&quot;&lt;/xjxobj&gt;&quot;;return sXml;}; this.loadingFunction=function(){};this.doneLoadingFunction=function(){};var loadingTimeout;this.call=function(sFunction,aArgs,sRequestType){var i,r,postData;if(document.body&amp;&amp;xajaxWaitCursor) document.body.style.cursor='wait';if(xajaxStatusMessages==true)window.status='Sending Request...';clearTimeout(loadingTimeout);loadingTimeout=setTimeout(&quot;xajax.loadingFunction();&quot;,400);if(xajaxDebug)this.DebugMessage(&quot;Starting xajax...&quot;);if(sRequestType==null){var xajaxRequestType=xajaxDefinedPost;} else{var xajaxRequestType=sRequestType;} var uri=xajaxReques!
 tUri;var value;switch(xajaxRequestType){case xajaxDefinedGet:{var uriGet=uri.indexOf(&quot;?&quot;)==-1?&quot;?xajax=&quot;+encodeURIComponent(sFunction):&quot;&amp;xajax=&quot;+encodeURIComponent(sFunction);if(aArgs){for(i=0;i&lt;aArgs.length;i++){value=aArgs[i];if(typeof(value)==&quot;object&quot;) value=this.objectToXML(value);uriGet+=&quot;&amp;xajaxargs[]=&quot;+encodeURIComponent(value);} } uriGet+=&quot;&amp;xajaxr=&quot;+new Date().getTime();uri+=uriGet;postData=null;}break;case xajaxDefinedPost:{postData=&quot;xajax=&quot;+encodeURIComponent(sFunction);postData+=&quot;&amp;xajaxr=&quot;+new Date().getTime();if(aArgs){for(i=0;i &lt;aArgs.length;i++){value=aArgs[i];if(typeof(value)==&quot;object&quot;) value=this.objectToXML(value);postData=postData+&quot;&amp;xajaxargs[]=&quot;+encodeURIComponent(value);} } }break;default: alert(&quot;Illegal request type: &quot;+xajaxRequestType);return false;break;} r=this.getRequestObject();if(!r)return false;r.open(xajaxRequestType==xajaxDefinedGet?&quot;GET&quot;:&quot;POST&quot;,uri,true);if(xajaxRequestType==xajaxDefinedPost){try{r.setRequestHeader(&quot;Method&quot;,&quot;POST &quot;+uri+&quot; HTTP/1.!
 1&quot;);r.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-!
 urlencod
ed&quot;);} catch(e){alert(&quot;Your browser does not appear to  support asynchronous requests using POST.&quot;);return false;} } r.onreadystatechange=function(){if(r.readyState!=4) return;if(r.status==200){if(xajaxDebug)xajax.DebugMessage(&quot;Received:\n&quot;+r.responseText);if(r.responseXML&amp;&amp;r.responseXML.documentElement) xajax.processResponse(r.responseXML);else{var errorString=&quot;Error: the XML response that was returned from the server is invalid.&quot;;errorString+=&quot;\nReceived:\n&quot;+r.responseText;trimmedResponseText=r.responseText.replace(/^\s+/g,&quot;&quot;);trimmedResponseText=trimmedResponseText.replace(/\s+$/g,&quot;&quot;);if(trimmedResponseText!=r.responseText) errorString+=&quot;\nYou have whitespace in your response.&quot;;alert(errorString);document.body.style.cursor='default';if(xajaxStatusMessages==true)window.status='Invalid XML response error';} } else{var errorString=&quot;Error: the server returned the following HTTP status: &quot;+r.status;errorString+=&quot;\nReceived:\n&quot;+r.responseText;alert(errorString);document.body.sty!
 le.cursor='default';if(xajaxStatusMessages==true)window.status='Invalid XML response error';} delete r;r=null;}; if(xajaxDebug)this.DebugMessage(&quot;Calling &quot;+sFunction+&quot; uri=&quot;+uri+&quot; (post:&quot;+postData+&quot;)&quot;);r.send(postData);if(xajaxStatusMessages==true)window.status='Waiting for data...';delete r;return true;}; this.getBrowserHTML=function(html){tmpXajax=this.$(this.workId);if(!tmpXajax){tmpXajax=document.createElement(&quot;div&quot;);tmpXajax.setAttribute('id',this.workId);tmpXajax.style.display=&quot;none&quot;;tmpXajax.style.visibility=&quot;hidden&quot;;document.body.appendChild(tmpXajax);} tmpXajax.innerHTML=html;var browserHTML=tmpXajax.innerHTML;tmpXajax.innerHTML='';return browserHTML;}; this.willChange=function(element,attribute,newData){if(!document.body){return true;}; if(attribute==&quot;innerHTML&quot;){newData=this.getBrowserHTML(newData);} elementObject=this.$(element);if(elementObject){var oldData;eval(&quot;oldData=this.$('&quot;+element+&quot;').&quot;+attribute);if(newData!==oldData) return true;} return false;}; this!
 .viewSource=function(){return &quot;&lt;html&gt;&quot;+document.getElementsByT!
 agName(&quot;
HTML&quot;)[0].innerHTML+&quot;&lt;/html&gt;&quot;;}; this.processResponse=function(xml){clearTimeout(loadingTimeout);this.doneLoadingFunction();if(xajaxStatusMessages==true)window.status='Processing...';var tmpXajax=null;xml=xml.documentElement;if(xml==null) return;for(var i=0;i&lt;xml.childNodes.length;i++){if(xml.childNodes[i].nodeName==&quot;cmd&quot;){var cmd;var id;var property;var data;var search;var type;var before;for(var j=0;j&lt;xml.childNodes[i].attributes.length;j++){if(xml.childNodes[i].attributes[j].name==&quot;n&quot;){cmd=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;t&quot;){id=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;p&quot;){property=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;c&quot;){type=xml.childNodes[i].attributes[j].value;} } if(xml.childNodes[i].childNodes.length &gt; 1&amp;&amp;xml.childNodes[i].firstChild.nodeName==&quot;#cdata-section&quot;){data=&quot;&quot;;for(var j=0;j&lt;xml.childNodes[i].childNodes.length;!
 j++){data+=xml.childNodes[i].childNodes[j].data;} } else if(xml.childNodes[i].childNodes.length &gt; 1){for(var j=0;j&lt;xml.childNodes[i].childNodes.length;j++){if(xml.childNodes[i].childNodes[j].childNodes.length &gt; 1&amp;&amp;xml.childNodes[i].childNodes[j].firstChild.nodeName==&quot;#cdata-section&quot;){var internalData=&quot;&quot;;for(var k=0;k&lt;xml.childNodes[i].childNodes[j].childNodes.length;k++){internalData+=xml.childNodes[i].childNodes[j].childNodes[k].nodeValue;} }else{var internalData=xml.childNodes[i].childNodes[j].firstChild.nodeValue;} if(xml.childNodes[i].childNodes[j].nodeName==&quot;s&quot;){search=internalData;} if(xml.childNodes[i].childNodes[j].nodeName==&quot;r&quot;){data=internalData;} } } else if(xml.childNodes[i].firstChild) data=xml.childNodes[i].firstChild.nodeValue;else data=&quot;&quot;;var objElement=this.$(id);var cmdFullname;try{if(cmd==&quot;al&quot;){cmdFullname=&quot;addAlert&quot;;alert(data);} else if(cmd==&quot;js&quot;){cmdFullname=&quot;addScript/addRedirect&quot;;eval(data);} else if(cmd==&quot;in&quot;){cmdFullname=&quot;addIncludeScript&quot;;this.inc!
 lude(data);} else if(cmd==&quot;as&quot;){cmdFullname=&quot;addAssign/addClea!
 r&quot;;if(th
is.willChange(id,property,data)){eval(&quot;objElement.&quot;+property+&quot;=data;&quot;);} } else if(cmd==&quot;ap&quot;){cmdFullname=&quot;addAppend&quot;;eval(&quot;objElement.&quot;+property+&quot;+=data;&quot;);} else if(cmd==&quot;pp&quot;){cmdFullname=&quot;addPrepend&quot;;eval(&quot;objElement.&quot;+property+&quot;=data+objElement.&quot;+property);} else if(cmd==&quot;rp&quot;){cmdFullname=&quot;addReplace&quot;;this.replace(id,property,search,data) } else if(cmd==&quot;rm&quot;){cmdFullname=&quot;addRemove&quot;;this.remove(id);} else if(cmd==&quot;ce&quot;){cmdFullname=&quot;addCreate&quot;;this.create(id,data,property);} else if(cmd==&quot;ie&quot;){cmdFullname=&quot;addInsert&quot;;this.insert(id,data,property);} else if(cmd==&quot;ia&quot;){cmdFullname=&quot;addInsertAfter&quot;;this.insertAfter(id,data,property);} else if(cmd==&quot;ci&quot;){cmdFullname=&quot;addCreateInput&quot;;this.createInput(id,type,data,property);} else if(cmd==&quot;ii&quot;){cmdFullname=&quot;addInsertInput&quot;;this.insertInput(id,type,data,property);} else if(cmd==&quot;ev&quot;){cmdFullname=&quot;addEvent&quot;;property=this.addOnPrefix(property);eval(&quot;this.$('&quot;+id+&quot;').&quot;+property+&quot;= function(){&quot;+data+&quot;;}&quot;);} else if(cmd==&quot;ah&quot;){cmdFul!
 lname=&quot;addHandler&quot;;this.addHandler(id,property,data);} else if(cmd==&quot;rh&quot;){cmdFullname=&quot;addRemoveHandler&quot;;this.removeHandler(id,property,data);} } catch(e){if(xajaxDebug) alert(&quot;While trying to '&quot;+cmdFullname+&quot;' (command number &quot;+i+&quot;), the following error occured:\n&quot; +e.name+&quot;: &quot;+e.message+&quot;\n&quot; +(id&amp;&amp;!objElement?&quot;Object with id='&quot;+id+&quot;' wasn't found.\n&quot;:&quot;&quot;));} delete objElement;delete cmd;delete cmdFullname;delete id;delete property;delete search;delete data;delete type;delete before;delete internalData;delete j;delete k;} } delete xml;delete i;document.body.style.cursor='default';if(xajaxStatusMessages==true)window.status='Done';} } var xajax=new Xajax();xajaxLoaded=true;
\ No newline at end of file
+function Xajax(){this.DebugMessage=function(text){try{if(this.debugWindow==undefined||this.debugWindow.closed==true){this.debugWindow=window.open('about:blank','xajax-debug','width=800,height=600,scrollbars=1,resizable,status');this.debugWindow.document.write('&lt;html&gt;&lt;head&gt;&lt;title&gt;Xajax debug output&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h2&gt;Xajax debug output&lt;/h2&gt;&lt;div id=&quot;debugTag&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;');}; text=text.replace(/&amp;/g,&quot;&amp;&quot;); text=text.replace(/&lt;/g,&quot;&lt;&quot;); text=text.replace(/&gt;/g,&quot;&gt;&quot;); debugTag=this.debugWindow.document.getElementById('debugTag');debugTag.innerHTML=('&lt;b&gt;'+(new Date()).toString()+'&lt;/b&gt;: '+text+'&lt;hr/&gt;')+debugTag.innerHTML;}catch(e){alert(&quot;Xajax Debug:\n &quot;+text);} };this.workId='xajaxWork'+new Date().getTime();this.depth=0;this.getRequestObject=function(){if(xajaxDebug)this.DebugMessage(&quot;Initializing Request Object..&quot;);var req=null;if(typeof XMLHttpRequest!=&quot;undefined&quot;) req=new XMLHttpRequest();if(!req&amp;&amp;typeof ActiveXObject!=&quot;undefined&quot;){try{req=new ActiveXObject!
 (&quot;Msxml2.XMLHTTP&quot;);} catch(e){try{req=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);} catch(e2){try{req=new ActiveXObject(&quot;Msxml2.XMLHTTP.4.0&quot;);} catch(e3){req=null;} } } } if(!req&amp;&amp;window.createRequest) req=window.createRequest();if(!req)this.DebugMessage(&quot;Request Object Instantiation failed.&quot;);return req;}; this.$=function(sId){if(!sId){return null;} var returnObj=document.getElementById(sId);if(!returnObj&amp;&amp;document.all){returnObj=document.all[sId];} if(xajaxDebug&amp;&amp;!returnObj&amp;&amp;sId!=this.workId){this.DebugMessage(&quot;Element with the id \&quot;&quot;+sId+&quot;\&quot; not found.&quot;);} return returnObj;}; this.include=function(sFileName){var objHead=document.getElementsByTagName('head');var objScript=document.createElement('script');objScript.type='text/javascript';objScript.src=sFileName;objHead[0].appendChild(objScript);}; this.stripOnPrefix=function(sEventName){sEventName=sEventName.toLowerCase();if(sEventName.indexOf('on')==0){sEventName=sEventName.replace(/on/,'');} return sEventName;}; this.addOnPre!
 fix=function(sEventName){sEventName=sEventName.toLowerCase();i!
 f(sEvent
Name.indexOf('on')!=0){sEventName='on'+sEventName;} return sEventName;}; this.addHandler=function(sElementId,sEvent,sFunctionName){if(window.addEventListener){sEvent=this.stripOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').addEventListener('&quot;+sEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} else{sAltEvent=this.addOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').attachEvent('&quot;+sAltEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} }; this.removeHandler=function(sElementId,sEvent,sFunctionName){if(window.addEventListener){sEvent=this.stripOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').removeEventListener('&quot;+sEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} else{sAltEvent=this.addOnPrefix(sEvent);eval(&quot;this.$('&quot;+sElementId+&quot;').detachEvent('&quot;+sAltEvent+&quot;',&quot;+sFunctionName+&quot;,false);&quot;);} }; this.create=function(sParentId,sTag,sId){var objParent=this.$(sParentId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);if(objParent) objParent.appendChild(objElement);}; this.insert=function(sBefo!
 reId,sTag,sId){var objSibling=this.$(sBeforeId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);objSibling.parentNode.insertBefore(objElement,objSibling);}; this.insertAfter=function(sAfterId,sTag,sId){var objSibling=this.$(sAfterId);objElement=document.createElement(sTag);objElement.setAttribute('id',sId);objSibling.parentNode.insertBefore(objElement,objSibling.nextSibling);}; this.getInput=function(sType,sName,sId){var Obj;if(sType==&quot;radio&quot;&amp;&amp;!window.addEventListener){Obj=document.createElement('&lt;input type=&quot;radio&quot; id=&quot;'+sId+'&quot; name=&quot;'+sName+'&quot;&gt;');} else{Obj=document.createElement('input');Obj.setAttribute('type',sType);Obj.setAttribute('name',sName);Obj.setAttribute('id',sId);} return Obj;}; this.createInput=function(sParentId,sType,sName,sId){var objParent=this.$(sParentId);var objElement=this.getInput(sType,sName,sId);if(objParent&amp;&amp;objElement) objParent.appendChild(objElement);}; this.insertInput=function(sBeforeId,sType,sName,sId){var objSibli!
 ng=this.$(sBeforeId);var objElement=this.getInput(sType,sName,!
 sId);if(
objElement&amp;&amp;objSibling&amp;&amp;objSibling.parentNode) objSibling.parentNode.insertBefore(objElement,objSibling);}; this.remove=function(sId){objElement=this.$(sId);if(objElement&amp;&amp;objElement.parentNode&amp;&amp;objElement.parentNode.removeChild){objElement.parentNode.removeChild(objElement);} }; this.replace=function(sId,sAttribute,sSearch,sReplace){var bFunction=false;if(sAttribute==&quot;innerHTML&quot;) sSearch=this.getBrowserHTML(sSearch);eval(&quot;var txt=this.$('&quot;+sId+&quot;').&quot;+sAttribute);if(typeof txt==&quot;function&quot;){txt=txt.toString();bFunction=true;} if(txt.indexOf(sSearch)&gt;-1){var newTxt='';while(txt.indexOf(sSearch)&gt;-1){x=txt.indexOf(sSearch)+sSearch.length+1;newTxt+=txt.substr(0,x).replace(sSearch,sReplace);txt=txt.substr(x,txt.length-x);} newTxt+=txt;if(bFunction){eval('this.$(&quot;'+sId+'&quot;).'+sAttribute+'=newTxt;');} else if(this.willChange(sId,sAttribute,newTxt)){eval('this.$(&quot;'+sId+'&quot;).'+sAttribute+'=newTxt;');} } }; this.getFormValues=function(frm){var objForm;var submitDisabledElements=false;if(a!
 rguments.length &gt; 1&amp;&amp;arguments[1]==true) submitDisabledElements=true;var prefix=&quot;&quot;;if(arguments.length &gt; 2) prefix=arguments[2];if(typeof(frm)==&quot;string&quot;) objForm=this.$(frm);else objForm=frm;var sXml=&quot;&lt;xjxquery&gt;&lt;q&gt;&quot;;if(objForm&amp;&amp;objForm.tagName=='FORM'){var formElements=objForm.elements;for(var i=0;i &lt; formElements.length;i++){if(!formElements[i].name) continue;if(formElements[i].name.substring(0,prefix.length)!=prefix) continue;if(formElements[i].type&amp;&amp;(formElements[i].type=='radio'||formElements[i].type=='checkbox')&amp;&amp;formElements[i].checked==false) continue;if(formElements[i].disabled&amp;&amp;formElements[i].disabled==true&amp;&amp;submitDisabledElements==false) continue;var name=formElements[i].name;if(name){if(sXml!='&lt;xjxquery&gt;&lt;q&gt;') sXml+='&amp;';if(formElements[i].type=='select-multiple'){for(var j=0;j &lt; formElements[i].length;j++){if(formElements[i].options[j].selected==true) sXml+=name+&quot;=&quot;+encodeURIComponent(formElements[i].options[j].value)+&quot;&amp;&quot;;} } else{sXml+=name+&quot;=&quot;+encodeURIComponen!
 t(formElements[i].value);} } } } sXml+=&quot;&lt;/q&gt;&lt;/xjxquery&gt;&quot;;retur!
 n sXml;}
; this.objectToXML=function(obj){var sXml=&quot;&lt;xjxobj&gt;&quot;;for(i in obj){try{if(i=='constructor') continue;if(obj[i]&amp;&amp;typeof(obj[i])=='function') continue;var key=i;var value=obj[i];if(value&amp;&amp;typeof(value)==&quot;object&quot;&amp;&amp;this.depth &lt;=50){this.depth++;value=this.objectToXML(value);this.depth--;} sXml+=&quot;&lt;e&gt;&lt;k&gt;&quot;+key+&quot;&lt;/k&gt;&lt;v&gt;&quot;+value+&quot;&lt;/v&gt;&lt;/e&gt;&quot;;}  catch(e){if(xajaxDebug)this.DebugMessage(e.name+&quot;: &quot;+e.message);} } sXml+=&quot;&lt;/xjxobj&gt;&quot;;return sXml;}; this.loadingFunction=function(){};this.doneLoadingFunction=function(){};var loadingTimeout;this.call=function(sFunction,aArgs,sRequestType){var i,r,postData;if(document.body&amp;&amp;xajaxWaitCursor) document.body.style.cursor='wait';if(xajaxStatusMessages==true)window.status='Sending Request...';clearTimeout(loadingTimeout);loadingTimeout=setTimeout(&quot;xajax.loadingFunction();&quot;,0);if(xajaxDebug)this.DebugMessage(&quot;Starting xajax...&quot;);if(sRequestType==null){var xajaxRequestType=xajaxDefinedPost;} else{var xajaxRequestType=sRequestType;} var uri=xajaxRequestU!
 ri;var value;switch(xajaxRequestType){case xajaxDefinedGet:{var uriGet=uri.indexOf(&quot;?&quot;)==-1?&quot;?xajax=&quot;+encodeURIComponent(sFunction):&quot;&amp;xajax=&quot;+encodeURIComponent(sFunction);if(aArgs){for(i=0;i&lt;aArgs.length;i++){value=aArgs[i];if(typeof(value)==&quot;object&quot;) value=this.objectToXML(value);uriGet+=&quot;&amp;xajaxargs[]=&quot;+encodeURIComponent(value);} } uriGet+=&quot;&amp;xajaxr=&quot;+new Date().getTime();uri+=uriGet;postData=null;}break;case xajaxDefinedPost:{postData=&quot;xajax=&quot;+encodeURIComponent(sFunction);postData+=&quot;&amp;xajaxr=&quot;+new Date().getTime();if(aArgs){for(i=0;i &lt;aArgs.length;i++){value=aArgs[i];if(typeof(value)==&quot;object&quot;) value=this.objectToXML(value);postData=postData+&quot;&amp;xajaxargs[]=&quot;+encodeURIComponent(value);} } }break;default: alert(&quot;Illegal request type: &quot;+xajaxRequestType);return false;break;} r=this.getRequestObject();if(!r)return false;r.open(xajaxRequestType==xajaxDefinedGet?&quot;GET&quot;:&quot;POST&quot;,uri,true);if(xajaxRequestType==xajaxDefinedPost){try{r.setRequestHeader(&quot;Method&quot;,&quot;POST &quot;+uri+&quot; HTTP/1.1&quot;!
 );r.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-ur!
 lencoded
&quot;);} catch(e){alert(&quot;Your browser does not appear to  support asynchronous requests using POST.&quot;);return false;} } r.onreadystatechange=function(){if(r.readyState!=4) return;if(r.status==200){if(xajaxDebug)xajax.DebugMessage(&quot;Received:\n&quot;+r.responseText);if(r.responseXML&amp;&amp;r.responseXML.documentElement) xajax.processResponse(r.responseXML);else{var errorString=&quot;Error: the XML response that was returned from the server is invalid.&quot;;errorString+=&quot;\nReceived:\n&quot;+r.responseText;trimmedResponseText=r.responseText.replace(/^\s+/g,&quot;&quot;);trimmedResponseText=trimmedResponseText.replace(/\s+$/g,&quot;&quot;);if(trimmedResponseText!=r.responseText) errorString+=&quot;\nYou have whitespace in your response.&quot;;alert(errorString);document.body.style.cursor='default';if(xajaxStatusMessages==true)window.status='Invalid XML response error';} } else{var errorString=&quot;Error: the server returned the following HTTP status: &quot;+r.status;errorString+=&quot;\nReceived:\n&quot;+r.responseText;alert(errorString);document.body.style!
 .cursor='default';if(xajaxStatusMessages==true)window.status='Invalid XML response error';} delete r;r=null;}; if(xajaxDebug)this.DebugMessage(&quot;Calling &quot;+sFunction+&quot; uri=&quot;+uri+&quot; (post:&quot;+postData+&quot;)&quot;);r.send(postData);if(xajaxStatusMessages==true)window.status='Waiting for data...';delete r;return true;}; this.getBrowserHTML=function(html){tmpXajax=this.$(this.workId);if(!tmpXajax){tmpXajax=document.createElement(&quot;div&quot;);tmpXajax.setAttribute('id',this.workId);tmpXajax.style.display=&quot;none&quot;;tmpXajax.style.visibility=&quot;hidden&quot;;document.body.appendChild(tmpXajax);} tmpXajax.innerHTML=html;var browserHTML=tmpXajax.innerHTML;tmpXajax.innerHTML='';return browserHTML;}; this.willChange=function(element,attribute,newData){if(!document.body){return true;}; if(attribute==&quot;innerHTML&quot;){newData=this.getBrowserHTML(newData);} elementObject=this.$(element);if(elementObject){var oldData;eval(&quot;oldData=this.$('&quot;+element+&quot;').&quot;+attribute);if(newData!==oldData) return true;} return false;}; this.v!
 iewSource=function(){return &quot;&lt;html&gt;&quot;+document.getElementsByTag!
 Name(&quot;HT
ML&quot;)[0].innerHTML+&quot;&lt;/html&gt;&quot;;}; this.processResponse=function(xml){clearTimeout(loadingTimeout);this.doneLoadingFunction();if(xajaxStatusMessages==true)window.status='Processing...';var tmpXajax=null;xml=xml.documentElement;if(xml==null) return;for(var i=0;i&lt;xml.childNodes.length;i++){if(xml.childNodes[i].nodeName==&quot;cmd&quot;){var cmd;var id;var property;var data;var search;var type;var before;for(var j=0;j&lt;xml.childNodes[i].attributes.length;j++){if(xml.childNodes[i].attributes[j].name==&quot;n&quot;){cmd=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;t&quot;){id=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;p&quot;){property=xml.childNodes[i].attributes[j].value;} else if(xml.childNodes[i].attributes[j].name==&quot;c&quot;){type=xml.childNodes[i].attributes[j].value;} } if(xml.childNodes[i].childNodes.length &gt; 1&amp;&amp;xml.childNodes[i].firstChild.nodeName==&quot;#cdata-section&quot;){data=&quot;&quot;;for(var j=0;j&lt;xml.childNodes[i].childNodes.length;j+!
 +){data+=xml.childNodes[i].childNodes[j].data;} } else if(xml.childNodes[i].childNodes.length &gt; 1){for(var j=0;j&lt;xml.childNodes[i].childNodes.length;j++){if(xml.childNodes[i].childNodes[j].childNodes.length &gt; 1&amp;&amp;xml.childNodes[i].childNodes[j].firstChild.nodeName==&quot;#cdata-section&quot;){var internalData=&quot;&quot;;for(var k=0;k&lt;xml.childNodes[i].childNodes[j].childNodes.length;k++){internalData+=xml.childNodes[i].childNodes[j].childNodes[k].nodeValue;} }else{var internalData=xml.childNodes[i].childNodes[j].firstChild.nodeValue;} if(xml.childNodes[i].childNodes[j].nodeName==&quot;s&quot;){search=internalData;} if(xml.childNodes[i].childNodes[j].nodeName==&quot;r&quot;){data=internalData;} } } else if(xml.childNodes[i].firstChild) data=xml.childNodes[i].firstChild.nodeValue;else data=&quot;&quot;;var objElement=this.$(id);var cmdFullname;try{if(cmd==&quot;al&quot;){cmdFullname=&quot;addAlert&quot;;alert(data);} else if(cmd==&quot;js&quot;){cmdFullname=&quot;addScript/addRedirect&quot;;eval(data);} else if(cmd==&quot;in&quot;){cmdFullname=&quot;addIncludeScript&quot;;this.inclu!
 de(data);} else if(cmd==&quot;as&quot;){cmdFullname=&quot;addAssign/addClear&quot;!
 ;if(this
.willChange(id,property,data)){eval(&quot;objElement.&quot;+property+&quot;=data;&quot;);} } else if(cmd==&quot;ap&quot;){cmdFullname=&quot;addAppend&quot;;eval(&quot;objElement.&quot;+property+&quot;+=data;&quot;);} else if(cmd==&quot;pp&quot;){cmdFullname=&quot;addPrepend&quot;;eval(&quot;objElement.&quot;+property+&quot;=data+objElement.&quot;+property);} else if(cmd==&quot;rp&quot;){cmdFullname=&quot;addReplace&quot;;this.replace(id,property,search,data) } else if(cmd==&quot;rm&quot;){cmdFullname=&quot;addRemove&quot;;this.remove(id);} else if(cmd==&quot;ce&quot;){cmdFullname=&quot;addCreate&quot;;this.create(id,data,property);} else if(cmd==&quot;ie&quot;){cmdFullname=&quot;addInsert&quot;;this.insert(id,data,property);} else if(cmd==&quot;ia&quot;){cmdFullname=&quot;addInsertAfter&quot;;this.insertAfter(id,data,property);} else if(cmd==&quot;ci&quot;){cmdFullname=&quot;addCreateInput&quot;;this.createInput(id,type,data,property);} else if(cmd==&quot;ii&quot;){cmdFullname=&quot;addInsertInput&quot;;this.insertInput(id,type,data,property);} else if(cmd==&quot;ev&quot;){cmdFullname=&quot;addEvent&quot;;property=this.addOnPrefix(property);eval(&quot;this.$('&quot;+id+&quot;').&quot;+property+&quot;= function(){&quot;+data+&quot;;}&quot;);} else if(cmd==&quot;ah&quot;){cmdFulln!
 ame=&quot;addHandler&quot;;this.addHandler(id,property,data);} else if(cmd==&quot;rh&quot;){cmdFullname=&quot;addRemoveHandler&quot;;this.removeHandler(id,property,data);} } catch(e){if(xajaxDebug) alert(&quot;While trying to '&quot;+cmdFullname+&quot;' (command number &quot;+i+&quot;), the following error occured:\n&quot; +e.name+&quot;: &quot;+e.message+&quot;\n&quot; +(id&amp;&amp;!objElement?&quot;Object with id='&quot;+id+&quot;' wasn't found.\n&quot;:&quot;&quot;));} delete objElement;delete cmd;delete cmdFullname;delete id;delete property;delete search;delete data;delete type;delete before;delete internalData;delete j;delete k;} } delete xml;delete i;document.body.style.cursor='default';if(xajaxStatusMessages==true)window.status='Done';} } var xajax=new Xajax();xajaxLoaded=true;
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000362.html">[ydf-devel] r1900 - YDFramework2.0/trunk/YDFramework2/addons/YDCMPage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#361">[ date ]</a>
              <a href="thread.html#361">[ thread ]</a>
              <a href="subject.html#361">[ subject ]</a>
              <a href="author.html#361">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/ydframework-devel">More information about the YDFramework-devel
mailing list</a><br>
</body></html>
