<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ydf-devel] r2413 - YDFramework2.0/trunk/YDFramework2/YDClasses
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/ydframework-devel/2007-March/index.html" >
   <LINK REL="made" HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2413%20-%20YDFramework2.0/trunk/YDFramework2/YDClasses&In-Reply-To=%3C200703191659.l2JGxe0V022646%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001006.html">
   <LINK REL="Next"  HREF="001008.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ydf-devel] r2413 - YDFramework2.0/trunk/YDFramework2/YDClasses</H1>
    <B>ximian at mail.berlios.de</B> 
    <A HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2413%20-%20YDFramework2.0/trunk/YDFramework2/YDClasses&In-Reply-To=%3C200703191659.l2JGxe0V022646%40sheep.berlios.de%3E"
       TITLE="[ydf-devel] r2413 - YDFramework2.0/trunk/YDFramework2/YDClasses">ximian at mail.berlios.de
       </A><BR>
    <I>Mon Mar 19 17:59:40 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001006.html">[ydf-devel] r2412 - YDFramework2.0/trunk/YDFramework2/YDClasses
</A></li>
        <LI>Next message: <A HREF="001008.html">[ydf-devel] r2414 -	YDFramework2.0/trunk/YDFramework2/addons/YDDatabaseObjectTree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1007">[ date ]</a>
              <a href="thread.html#1007">[ thread ]</a>
              <a href="subject.html#1007">[ subject ]</a>
              <a href="author.html#1007">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ximian
Date: 2007-03-19 17:59:03 +0100 (Mon, 19 Mar 2007)
New Revision: 2413

Modified:
   YDFramework2.0/trunk/YDFramework2/YDClasses/YDUtil.php
Log:
feature: on YDArrayUtil::convertToNested is now possible to define if we want to append or replace values. Default: append

Modified: YDFramework2.0/trunk/YDFramework2/YDClasses/YDUtil.php
===================================================================
--- YDFramework2.0/trunk/YDFramework2/YDClasses/YDUtil.php	2007-03-05 23:54:09 UTC (rev 2412)
+++ YDFramework2.0/trunk/YDFramework2/YDClasses/YDUtil.php	2007-03-19 16:59:03 UTC (rev 2413)
@@ -1,1339 +1,1346 @@
-&lt;?php
-
-    /*
-
-        Yellow Duck Framework version 2.1
-        (c) Copyright 2002-2007 Pieter Claerhout
-
-        This library is free software; you can redistribute it and/or
-        modify it under the terms of the GNU Lesser General Public
-        License as published by the Free Software Foundation; either
-        version 2.1 of the License, or (at your option) any later version.
-
-        This library is distributed in the hope that it will be useful,
-        but WITHOUT ANY WARRANTY; without even the implied warranty of
-        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
-        Lesser General Public License for more details.
-
-        You should have received a copy of the GNU Lesser General Public
-        License along with this library; if not, write to the Free Software
-        Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
-
-    */
-
-    /**
-     *  @addtogroup YDFramework Core
-     */
-
-    // Check if the framework is loaded
-    if ( ! defined( 'YD_FW_NAME' ) ) {
-        die( 'Yellow Duck Framework is not loaded.' );
-    }
-
-    /**
-     *	This is a general timer class that starts counting when it's instantiated, and which returns the elapsed time as
-     *	soon as the finish method is called.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDTimer extends YDBase {
-
-        /**
-         *	This is the class constructor of the YDTimer class.
-         */
-        function YDTimer() {
-
-            // Initialize YDBase
-            $this-&gt;YDBase();
-
-            // Get the start time
-            $this-&gt;startTime = $this-&gt;_getMicroTime();
-
-            // Keep a list of intermediate times
-            $this-&gt;markers = array();
-
-        }
-
-        /**
-         *	This function returns the current microtime as a double.
-         *
-         *	@returns	Double containing the current time.
-         *
-         *	@internal
-         */
-        function _getMicroTime() {
-            $time = explode ( ' ', microtime() );
-            return ( doubleval( $time[0] ) + $time[1] );
-        }
-
-        /**
-         *	This will add a named marker.
-         *
-         *	@param $name	The name to use for the marker
-         */
-        function addMarker( $name ) {
-            array_push( $this-&gt;markers, array( $name, $this-&gt;getElapsed() ) );
-        }
-
-        /**
-         *	Finish the timer.
-         */
-        function finish() {
-            $this-&gt;addMarker( '** Finish' );
-        }
-
-        /**
-         *	This function will return the number of seconds elapsed since the timer was instantiated.
-         *
-         *	@returns	The total elapsed time
-         */
-        function getElapsed() {
-            $endTime = $this-&gt;_getMicroTime();
-            return intval( ( $endTime - $this-&gt;startTime ) * 1000 );
-        }
-
-        /**
-         *	This function returns a report as an array, with each row containing the following info: elapsed time,
-         *	difference with previous marker and marker name.
-         *
-         *	@returns	Array with the elapsed times, differences and marker names.
-         */
-        function getReport() {
-            $report = array();
-            $report[] = array( 0, 0, '** Start' );
-            $previous = 0;
-            foreach ( $this-&gt;markers as $marker ) {
-                $report[] = array( $marker[1], $marker[1]-$previous, $marker[0] );
-                $previous = $marker[1];
-            }
-            return $report;
-        }
-
-    }
-
-    /**
-     *  This class houses all the array related utility functions. All the methods are implemented as static methods and
-     *	do not require you to create a class instance in order to use them.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDArrayUtil extends YDBase {
-
-        /**
-         *  This function will convert a single dimension array to a multi dimension array with the indicated number of
-         *	colums. If the number of columns is 1, it will return the original array.
-         *
-         *  If you enable the $fillLastRow option, it will fill the last row with null values to match the number of
-         *	columns.
-         *
-         *  @param $array		    The single dimension array you want to convert.
-         *  @param $columns		    The number of columns the table should have.
-         *  @param $fillLastRow	    (optional) If true, the last row will be filled with null values so that it matches
-         *						    the number of columns.
-         *  @param $horizontal  	(optional) If true, rows will be filled first, then it will create an new row
-         *
-         *  @returns	A multi-dimension array with the contents of the original array converted to a table with the
-         *				indicated number of colums.
-         *
-         *	@static
-         */
-        function convertToTable( $array, $columns, $fillLastRow=false, $horizontal=true ) {
-
-            // If the number of columns is 1, return the original array
-            if ( $columns == 1 ) {
-                return $array;
-            }
-
-            // Return original array if empty
-            if ( sizeof( $array ) == 0 ) {
-                return $array;
-            }
-
-            // Convert horizontally or vertically
-            if ( $horizontal ) {
-
-                // Use the array_chunk function to convert to a table
-                $newArray = @array_chunk( $array, $columns );
-                if ( $newArray == null ) {
-                    trigger_error( 'Failed to split the array in chunks.', YD_ERROR );
-                }
-
-                // Pad the last row
-                if ( $fillLastRow ) {
-                    $lastRow = $newArray[sizeof( $newArray )-1];
-                    $numMissing = $columns - sizeof( $lastRow );
-                    for ( $i = 0; $i &lt; $numMissing; $i++ ) {
-                        array_push( $newArray[sizeof( $newArray )-1], null );
-                    }
-
-                }
-
-            } else {
-
-                // Get only the values of the array
-                $array = array_values( $array );
-
-                // Check how many rows we will have
-                $rows = ceil( sizeof( $array ) / $columns );
-
-                // Keep track of the current row
-                $currentItem = 0;
-                $currentCol  = 0;
-
-                // Start with a new empty array
-                $newArray = array();
-
-                // Loop over the rows
-                while ( $currentCol &lt; $columns ) {
-                    foreach ( range( 0, $rows-1 ) as $row ) {
-                        $newArray[$row][$currentCol] = isset( $array[$currentItem] ) ? $array[$currentItem] : null;
-                        $currentItem++;
-                    }
-                    $currentCol++;
-                }
-
-            }
-
-            // Return the array
-            return $newArray;
-
-        }
-
-        /**
-         *	This function will create a new array which is a nested using the given column name.
-         *
-         *	@param $array	The array to convert.
-         *	@param $key		The column to use as the key name.
-         *
-         *	@returns	A new array which is a nested using the given column name.
-         *
-         *	@static
-         */
-        function convertToNested( $array, $key ) {
-
-            // Start with the a new array
-            $new = array();
-
-            // Loop over the original array
-            foreach ( $array as $item ) {
-                if ( ! array_key_exists( $key, $item ) ) {
-                    trigger_error( 'YDArrayUtil::convertToNested: key &quot;' . $key . '&quot; not found', YD_ERROR );
-                }
-                if ( ! isset( $new[ $item[ $key ] ] ) ) { $new[ $item[ $key ] ] = array(); }
-                array_push( $new[ $item[ $key ] ], $item );
-            }
-
-            // Return the new array
-            return $new;
-
-        }
-
-        /**
-         *	This function will create a new array which is grouped by a given key and mapped according to a given array.
-         *
-         *	@param $input	The array to convert.
-         *	@param $key		The column to use as the key name.
-         *	@param $map		The array or string which indicates how values of the children arrays should be mapped in
-         *                  the parent array.
-         *
-         *	@returns		The array resulting from the mapping.
-         *
-         *	@static
-         */
-        function map( $input, $key, $map ) {
-
-            // Starting with new array
-            $output = array();
-
-            // Loop over the original array
-            foreach ( $input as $inputFragment ) {
-                if ( isset( $inputFragment[ $key ] ) ) {
-                    if ( is_array($map)) {
-                        foreach ( $map as $mapKey =&gt; $mapValue ) {
-                            if ( ! array_key_exists( $key, $inputFragment ) ) {
-                                trigger_error( 'YDArrayUtil::map: key &quot;' . $key . '&quot; not found', YD_ERROR );
-                            }
-                            if ( isset( $inputFragment[ $mapKey ] ) &amp;&amp; isset( $inputFragment[ $mapValue ] ) ) {
-                                $output[ $inputFragment[ $key ] ][ $inputFragment[ $mapKey ] ] = $inputFragment[ $mapValue ];
-                            }
-                            else {
-                                $output[ $inputFragment[ $key ] ][ $inputFragment[ $mapKey ] ] = NULL;
-                            }
-                        }
-                    }
-                    else {
-                        $output[ $inputFragment[ $key ] ] = $inputFragment[ $map ];
-                    }
-                }
-            }
-
-            // Return the new array
-            return $output;
-        }
-
-        /**
-         *  This function will implode a 1-level array in a string.
-         *
-         *  @param $input      The array to implode.
-         *  @param $glue       (optional) The key/value glue. Default: =
-         *  @param $separator  (optional) The items separator. Default: ,
-         *
-         *  @returns       The imploded string.
-         *
-         *  @static
-         */
-        function implode( $input, $glue='=', $separator=',' ) {
-            $return = '';
-            foreach ( $input as $k =&gt; $v ) {
-                $return .= $separator . $k . $glue . $v;
-            }
-            return substr( $return, 1 );
-        }
-
-        /**
-         *  This function will initialize the indicated array if it doesn't exist yet.
-         *
-         *  @param  $where  Where to instantiate the array in.
-         *  @param  $name   The name of the array to create.
-         *
-         *  @static
-         */
-        function createIfNeeded( &amp; $where, $name ) {
-            if ( ! isset( $where[$name] ) ) {
-                $where[$name] = array();
-            }
-        }
-
-
-        /**
-         *  This function will return a array with gmts.
-         *
-         *  @param $format      Format to return
-         *
-         *  @returns	Array. If format is NULL returns complete array.
-         *                                  'simple' returns: array( -11 =&gt; '(GMT -11:00)', -10 =&gt; ...
-         *                                  'full'   returns: array( -11 =&gt; '(GMT -11:00) Nome, Midway Island, Samoa', -10 =&gt; ...
-         *  @static
-         */
-        function getGMT( $format = null ){
-            $gmts = array(
-                '-11'   =&gt; array( '(GMT -11:00)', 'Nome, Midway Island, Samoa' ),
-                '-10'   =&gt; array( '(GMT -10:00)', 'Hawaii' ),
-                 '-9'   =&gt; array( '(GMT  -9:00)', 'Alaska' ),
-                 '-8'   =&gt; array( '(GMT  -8:00)', 'Pacific Time' ),
-                 '-7'   =&gt; array( '(GMT  -7:00)', 'Mountain Time' ),
-                 '-6'   =&gt; array( '(GMT  -6:00)', 'Central Time, Mexico City' ),
-                 '-5'   =&gt; array( '(GMT  -5:00)', 'Eastern Time, Bogota, Lima, Quito' ),
-                 '-4'   =&gt; array( '(GMT  -4:00)', 'Atlantic Time, Caracas, La Paz' ),
-                 '-3.5' =&gt; array( '(GMT  -3:30)', 'Newfoundland' ),
-                 '-3'   =&gt; array( '(GMT  -3:00)', 'Brazil, Buenos Aires, Georgetown, Falkland Is.' ),
-                 '-2'   =&gt; array( '(GMT  -2:00)', 'Mid-Atlantic, Ascention Is., St Helena' ),
-                 '-1'   =&gt; array( '(GMT  -1:00)', 'Azores, Cape Verde Islands' ),
-                  '0'   =&gt; array( '(GMT   0:00)', 'Casablanca, Dublin, Edinburgh, London, Lisbon, Monrovia' ),
-                  '1'   =&gt; array( '(GMT  +1:00)', 'Berlin, Brussels, Copenhagen, Madrid, Paris, Rome' ),
-                  '2'   =&gt; array( '(GMT  +2:00)', 'Kaliningrad, South Africa, Warsaw' ),
-                  '3'   =&gt; array( '(GMT  +3:00)', 'Baghdad, Riyadh, Moscow, Nairobi' ),
-                  '2.5' =&gt; array( '(GMT  +3:30)', 'Tehran' ),
-                  '4'   =&gt; array( '(GMT  +4:00)', 'Abu Dhabi, Baku, Muscat, Tbilisi' ),
-                  '4.5' =&gt; array( '(GMT  +4:30)', 'Kabul' ),
-                  '5'   =&gt; array( '(GMT  +5:00)', 'Islamabad, Karachi, Tashkent' ),
-                  '5.5' =&gt; array( '(GMT  +5:30)', 'Bombay, Calcutta, Madras, New Delhi' ),
-                  '6'   =&gt; array( '(GMT  +6:00)', 'Almaty, Colombo, Dhaka' ),
-                  '7'   =&gt; array( '(GMT  +7:00)', 'Bangkok, Hanoi, Jakarta' ),
-                  '8'   =&gt; array( '(GMT  +8:00)', 'Beijing, Hong Kong, Perth, Singapore, Taipei' ),
-                  '9'   =&gt; array( '(GMT  +9:00)', 'Osaka, Sapporo, Seoul, Tokyo, Yakutsk' ),
-                  '9.5' =&gt; array( '(GMT  +9:30)', 'Adelaide, Darwin' ),
-                 '10'   =&gt; array( '(GMT +10:00)', 'Melbourne, Papua New Guinea, Sydney, Vladivostok' ),
-                 '11'   =&gt; array( '(GMT +11:00)', 'Magadan, New Caledonia, Solomon Islands' ),
-                 '12'   =&gt; array( '(GMT +12:00)', 'Auckland, Wellington, Fiji, Marshall Island' )
-            );
-            if ( is_null( $format ) ) {
-                return $gmts;
-            }
-            foreach( $gmts as $t =&gt; $arr ){
-                if ( $format == 'simple' ) $gmts[ $t ] = $arr[ 0 ];
-                else                       $gmts[ $t ] = $arr[ 0 ] . ' ' . $arr[ 1 ];
-            }
-            return $gmts;
-        }
-
-        /**
-         *  This function will convert a database result array to XML
-         *
-         *  @param $array      The input array.
-         *
-         *  @returns       The array as an XML string.
-         *
-         *  @static
-         */
-        function toXml( $array ) {
-            $out = '';
-            foreach ( $array as $record ) {
-                $out .= sprintf( '&lt;row&gt;' );
-                foreach ( $record as $key=&gt;$val ) {
-                    if ( is_numeric( $val ) ) {
-                        $out .= sprintf( '&lt;%s&gt;%s&lt;/%s&gt;', $key, $val, $key );
-                    } else {
-                        $out .= sprintf( '&lt;%s&gt;&lt;![CDATA[%s]]&gt;&lt;/%s&gt;', $key, $val, $key );
-                    }
-                }
-                $out .= sprintf( '&lt;/row&gt;' );
-            }
-            $out = sprintf( '&lt;root&gt;%s&lt;/root&gt;', $out );
-            return '&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;' . $out;
-        }
-
-    }
-
-    /**
-     *	This class houses all the debug related utility functions. All the methods are implemented as static methods and
-     *	do not require you to create a class instance in order to use them.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDDebugUtil extends YDBase {
-
-        /**
-         *  Trigger an error
-         *
-         *  @param  $msg    The error to raise.
-         *  @param  $sql    (optional) The SQL statement to log with the error.
-         *  @param  $level  (optional) The type of error to be raised. Default is YD_ERROR.
-         */
-        function error( $msg, $sql=null, $level=YD_ERROR ) {
-            echo( '&lt;p&gt;&lt;b&gt;&lt;font color=&quot;red&quot;&gt;An error occured&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;' );
-            echo( '&lt;b&gt;Stacktrace:&lt;/b&gt; &lt;pre&gt;' . YDDebugUtil::getStackTrace() . '&lt;/pre&gt;' );
-            if ( ! empty( $sql ) ) {
-                echo( '&lt;b&gt;SQL Statement:&lt;/b&gt; &lt;pre&gt;' . $this-&gt;formatSql( $sql ) . '&lt;/pre&gt;' );
-            }
-            trigger_error( $msg, $level );
-        }
-
-        /**
-         *	Function to output a debug message. These message are only shown if the constant YD_DEBUG is set to 1. You
-         *	can turn on debugging by specifying the YD_DEBUG parameter in the url and assigning it the value 1.
-         *
-         *	Example url with debugging turned on: <A HREF="http://localhost/index.php?YD_DEBUG=1">http://localhost/index.php?YD_DEBUG=1</A>
-         *
-         *	This function accepts a variable amount of arguments which are all concatenated using a space in between.
-         *	All debug messages will be shown as HTML comments with the prefix &quot;[ YD_DEBUG ]&quot;.
-         *
-         *	@static
-         */
-        function debug() {
-            $args = func_get_args();
-            if ( YDConfig::get( 'YD_DEBUG' ) == 1 ) {
-                echo( YD_CRLF . '&lt;!-- [ YD_DEBUG ] ' . implode( ' ', $args ) . '--&gt;' . YD_CRLF );
-            }
-            if ( YDConfig::get( 'YD_DEBUG' ) == 2 ) {
-                echo( '&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;4&quot;&gt;&lt;tr&gt;' );
-                echo( '&lt;td bgcolor=&quot;#FFCC00&quot;&gt;' );
-                echo( '&lt;b&gt;' . YD_FW_NAME . ' Debug Information&lt;/b&gt; ' );
-                echo( '&lt;pre&gt;' . htmlspecialchars( trim( implode( ' ', $args ) ) ) . '&lt;/pre&gt;' );
-                echo( '&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;' );
-            }
-        }
-
-        /**
-         *	Function to dump the contents of pretty much anything. This is the same as the var_dump function in PHP, but
-         *	has a nicer and more readable output.
-         *
-         *	@param $obj		Object you want to dump.
-         *	@param $label	The label for the dump.
-         *
-         *	@static
-         */
-        function dump( $obj, $label='' ) {
-            echo( YDDebugUtil::r_dump( $obj, true, $label ) );
-        }
-
-        /**
-         *	Function to return the contents of pretty much anything. This is the same as the var_export function in PHP.
-         *
-         *	@param $obj		Object you want to dump.
-         *	@param $html	(optional) If you want to have everything returned as HTML or text. The default is false,
-         *					returning text.
-         *	@param $label	The label for the dump.
-         *
-         *	@returns	Text representation of the object.
-         *
-         *	@static
-         */
-        function r_dump( $obj, $html=false, $label='' ) {
-            $data = var_export( $obj, true );
-            if ( $html == true ) {
-                $data = stripslashes( htmlentities( $data ) );
-                $style = ' style=&quot;text-align: left; font-size: 10pt;&quot;';
-                if ( ! empty( $label ) ) {
-                    $data = '&lt;pre' . $style . '&gt;&lt;b style=&quot;color: navy&quot;&gt;' . $label . '&lt;/b&gt;&lt;br&gt;' . $data . '&lt;/pre&gt;';
-                } else {
-                    $data = '&lt;pre' . $style . '&gt;' . $data . '&lt;/pre&gt;';
-                }
-            } else {
-                $data = $label . YD_CRLF . $data;
-            }
-            return $data;
-        }
-
-        /**
-         *	This function will print a stack trace.
-         *
-         *	@static
-         */
-        function stackTrace() {
-            if ( YDConfig::get( 'YD_DEBUG' ) == 1 || YDConfig::get( 'YD_DEBUG' ) == 2 ) {
-                $err = 'URI: ' . YD_SELF_URI . YD_CRLF . YDDebugUtil::getStackTrace();
-                if ( ini_get( 'display_errors' ) == 1 ) {
-                    echo( '&lt;pre&gt;' . YD_CRLF . htmlentities( $err ) . '&lt;/pre&gt;' );
-                }
-                error_log( $err, 0 );
-            }
-        }
-
-        /**
-         *	Function to get a formatted stack trace.
-         *
-         *	@static
-         */
-        function getStackTrace() {
-            $err = '';
-            $err .= 'Debug backtrace:' . YD_CRLF;
-            foreach( debug_backtrace() as $t ) {
-                $err .= '    @ ';
-                if ( isset( $t['file'] ) ) {
-                    $err .= basename( $t['file'] ) . ':' . $t['line'];
-                } else {
-                    $err .= basename( YD_SELF_FILE );
-                }
-                $err .= ' -- ';
-                if ( isset( $t['class'] ) ) {
-                    $err .= $t['class'] . $t['type'];
-                }
-                $err .= $t['function'];
-                if ( isset( $t['args'] ) &amp;&amp; sizeof( $t['args'] ) &gt; 0 ) {
-                    $err .= '(...)';
-                } else {
-                    $err .= '()';
-                }
-                $err .= YD_CRLF;
-            }
-            return $err;
-        }
-
-    }
-
-    /**
-     *	This class houses all the object and class related utility functions. All the methods are implemented as static
-     *	methods and do not require you to create a class instance in order to use them.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDObjectUtil extends YDBase {
-
-        /**
-         *	This function checks if an object instance is of a specific class or is based on a derived class of the
-         *	given class. The class name is case insensitive.
-         *
-         *	@param $obj		The object instance to check.
-         *	@param $class	The object type you want to check against.
-         *
-         *	@returns	Boolean indicating if the object is of the specified class.
-         *
-         *	@static
-         */
-        function isSubClass( $obj, $class ) {
-            $class = strtolower( $class );
-            if ( function_exists( 'is_a' ) ) {
-                return is_a( $obj, $class );
-            } else {
-                if ( is_object( $obj ) ) {
-                    if ( strtolower( get_class( $obj ) ) == strtolower( $class ) ) return true;
-                    if ( is_subclass_of( $obj, $class ) ) return true;
-                }
-            }
-            return false;
-        }
-
-        /**
-         *	Function to get all the ancestors of a class. The list will contain the parent class first, and then it's
-         *	parent class, etc. You can pass both the name of the class or an object instance to this function
-         *
-         *	@param $classname	Name of the class or object.
-         *
-         *	@returns	Array with all the ancestors.
-         *
-         *	@static
-         */
-        function getAncestors( $classname ) {
-            if ( is_object( $classname ) ) {
-                $classname = strtolower( get_class( $classname ) );
-            }
-            $ancestors = array();
-            $father = get_parent_class( $classname );
-            if ( $father != '' ) {
-                $ancestors = YDObjectUtil::getAncestors( $father );
-                $ancestors[] = $father;
-            }
-            return array_reverse( $ancestors );
-        }
-
-        /**
-         *	This function will serialize an object.
-         *
-         *	@param $obj	Object to serialize.
-         *
-         *	@static
-         */
-        function serialize( $obj ) {
-            $obj = serialize( $obj );
-            if ( ! $obj ) {
-                trigger_error( 'Failed serializing the object', YD_ERROR );
-            }
-            return $obj;
-        }
-
-        /**
-         *	This function will unserialize an object.
-         *
-         *	@param $obj	Object to unserialize.
-         *
-         *	@static
-         */
-        function unserialize( $obj ) {
-            $obj = unserialize( $obj );
-            if ( ! $obj ) {
-                trigger_error( 'Failed unserializing the object', YD_ERROR );
-            }
-            return $obj;
-        }
-
-    }
-
-    /**
-     *	This class houses all the string related utility functions. All the methods are implemented as static methods
-     *	and do not require you to create a class instance in order to use them.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDStringUtil extends YDBase {
-
-        /**
-         *	Function to format a file size to a meaningful value.
-         *
-         *	@param $bytes		The file size to format.
-         *	@param $decimals	(optional) The number of decimals that should be returned.
-         *
-         *	@returns String containing the formatted file size.
-         *
-         *	@static
-         */
-        function formatFilesize( $bytes, $decimals=1 ) {
-
-            // Convert the bytes to a string
-            $bytes = strval( $bytes );
-
-            // The different units
-            $units = array(
-                '1152921504606846976'	=&gt; 'EB',
-                '1125899906842624'		=&gt; 'PB',
-                '1099511627776'			=&gt; 'TB',
-                '1073741824'			=&gt; 'GB',
-                '1048576'				=&gt; 'MB',
-                '1024'					=&gt; 'KB'
-            );
-
-            // If smaller than 1024, return it as bytes
-            if ( $bytes &lt;= 1024 ) {
-                return $bytes . ' bytes';
-            }
-
-            // Check the right format
-            foreach ( $units as $base=&gt;$title ) {
-                if ( floor( $bytes / $base ) != 0 ) {
-                    return number_format( $bytes / $base, $decimals, '.', &quot;'&quot; ) . ' ' . $title;
-                }
-            }
-
-        }
-
-        /**
-         *  This function will format a timestamp using the strftime function.
-         *
-         *  @param  $timestamp  The timestamp to format. It can also be a date/time form object.
-         *  @param  $format     The strftime format to use. You can also use the predefined options date, time and
-         *                      datetime.
-         *  @param  $locale     (optional) The locale to use to format the date.
-         *
-         *  @returns    A formatted timestamp
-         *
-         *  @static
-         */
-        function formatDate( $timestamp, $format, $locale=null ) {
-
-            // Check if the timestamp is an object and has the getTimeStamp function
-            if ( is_object( $timestamp ) &amp;&amp; method_exists( $timestamp, 'getTimeStamp' ) ) {
-                $timestamp = $timestamp-&gt;getTimeStamp();
-            }
-
-            // Convert to an integer
-            if ( is_numeric( $timestamp ) ) {
-                $timestamp = intval( $timestamp );
-            }
-
-            // If text, convert to number
-            if ( is_string( $timestamp ) ) {
-                $timestamp = strtotime( $timestamp );
-            }
-
-            // If array, is a date YDForm element value
-            if ( is_array( $timestamp ) ) {
-
-                // check if timestamp exists. otherwise create it
-                $hours   = isset( $timestamp[ 'hours' ] ) ?   $timestamp[ 'hours' ] : 0;
-                $minutes = isset( $timestamp[ 'minutes' ] ) ? $timestamp[ 'minutes' ] : 0;
-                $seconds = isset( $timestamp[ 'seconds' ] ) ? $timestamp[ 'seconds' ] : 0;
-                $month   = isset( $timestamp[ 'month' ] ) ?   $timestamp[ 'month' ] : 1;
-                $day     = isset( $timestamp[ 'day' ] ) ?     $timestamp[ 'day' ] : 1;
-                $year    = isset( $timestamp[ 'year' ] ) ?    $timestamp[ 'year' ] : 1970;
-                $timestamp = mktime( $hours, $minutes, $seconds, $month, $day, $year );
-            }
-
-            // Check the standard formats
-            if ( strtolower( $format ) == 'date' ) {
-                $format = '%d %B %Y';
-            }
-            if ( strtolower( $format ) == 'datetime' ) {
-                $format = '%d %B %Y %H:%M';
-            }
-            if ( strtolower( $format ) == 'datetimesql' ) {
-                $format = '%Y-%m-%d %H:%M:%S';
-            }
-            if ( strtolower( $format ) == 'time' ) {
-                $format = '%H:%M';
-            }
-            if ( strtolower( $format ) == 'file' ) {
-                $format = '%d-%m-%Y %H:%M';
-            }
-
-            // Set the new locale
-            if ( ! is_null( $locale ) ) {
-                $currentLocale = YDLocale::get();
-                YDLocale::set( $locale );
-            }
-
-            // Return the formatted date
-            $timestamp = strftime( $format, $timestamp );
-
-            // Reset the old locale
-            if ( ! is_null( $locale ) ) {
-                YDLocale::set( $currentLocale );
-            }
-
-            // Return the timestamp
-            return $timestamp;
-
-        }
-
-        /**
-         *	This function will encode all characters which have an ordinal bigger than 128 to numeric HTML entities,
-         *	which can be safely included in e.g. XML output.
-         *
-         *	@param $string	The original string to encode.
-         *	@param $htmlent	Boolean indicating if the result should be HTML encoded or not.
-         *
-         *	@returns	String with all the characters with an ordinal bigger than 128 converted to numeric entities.
-         *
-         *	@static
-         */
-        function encodeString( $string, $htmlent=false ) {
-            $trans = array_flip( get_html_translation_table( HTML_ENTITIES ) );
-            $string = strtr( $string, $trans );
-            $trans = get_html_translation_table( HTML_ENTITIES, ENT_NOQUOTES );
-            foreach ( $trans as $key =&gt; $value ) {
-                if ( ord( $key ) == 60 || ord( $key ) == 62 || ord( $key ) == 38 ) {
-                    unset( $trans[$key] );
-                } else {
-                    $trans[$key] = '&amp;#' . ord( $key ) . ';';
-                }
-            }
-            $string = strtr( $string, $trans );
-            if ( $htmlent == true ) {
-                $string = htmlentities( $string );
-            }
-            return $string;
-        }
-
-        /**
-         *   This function will encode all characters in a string to it's ASCII value.
-         *
-         *   @param $string   The original string to encode.
-         *
-         *   @returns   The encoded string.
-         *
-         *   @static
-         */
-        function encodeToAscii( $string ) {
-            $result = '';
-            for ( $i=0; $i &lt; strlen( $string ); $i++ ) {
-                $result .= &quot;&amp;#&quot; . ord( substr( $string, $i, 1) ) . ';';
-            }
-            return $result;
-        }
-
-        /**
-         *	This function will truncate a string.
-         *
-         *	@param $string		String to truncate.
-         *	@param $length		(optional) The length to truncate to. Default length is 80 characters.
-         *	@param $etc			(optional) The string to append if the item gets trunctated. Default is '...'.
-         *	@param $break_words	(optional) Break in the middle of words or not. Default is false.
-         *
-         *	@static
-         */
-        function truncate( $string, $length=80, $etc='...', $break_words=false ) {
-            if ( $length == 0 ) { return ''; }
-            if ( strlen( $string ) &gt; $length ) {
-                $string = html_entity_decode( strip_tags( $string ) );
-                $length -= strlen( $etc );
-                if ( ! $break_words ) {
-                    $string = preg_replace( '/\s+?(\S+)?$/', '', substr( $string, 0, $length+1 ) );
-                }
-                return htmlentities( substr( $string, 0, $length ) . $etc );
-            } else {
-                return $string;
-            }
-        }
-
-        /**
-         *	This function normalizes all the newlines to the correct newline character for the current platform.
-         *
-         *	@param $string		String to normalize the newlines from.
-         *
-         *	@returns	The original string with normalized newlines.
-         *
-         *	@static
-         */
-        function normalizeNewlines( $string ) {
-
-            // First, change all to \n
-            $string = str_replace( &quot;\r\n&quot;, &quot;\n&quot;,    $string );
-            $string = str_replace( &quot;\r&quot;,   &quot;\n&quot;,    $string );
-
-            // Now, change everything to the correct one
-            $string = str_replace( &quot;\n&quot;,   YD_CRLF, $string );
-
-            // Return the changed string
-            return $string;
-
-        }
-
-        /**
-         *	This function will remove all newlines and all spaces at the beginning and end of each line.
-         *
-         *	@param $string		String to remove the whitespace from.
-         *
-         *	@returns	The original string without the newlines and spaces at the beginning and end of each line.
-         *
-         *	@static
-         */
-        function removeWhiteSpace( $string ) {
-
-            // First, normalize the newlines
-            $string = YDStringUtil::normalizeNewLines( $string );
-
-            // Now, remove the whitespace
-            $string = implode( ' ', array_map( 'trim', explode( YD_CRLF, $string ) ) );
-
-            // Return the changed string
-            return $string;
-
-        }
-
-        /**
-         *   This function will compare two network ip addresses
-         *
-         *   @param $ip1      First ip
-         *
-         *   @param $ip2      Second ip
-         *
-         *   @returns    Returns &lt; 0 if ip1 is less than ip2; &gt; 0 if str1 is greater than ip2, and 0 if they are equal.
-         *
-         *   @static
-         */
-        function ipcmp( $ip1, $ip2 ){
-
-            // get 4 elements from the network address
-            $ip1 = explode(&quot;.&quot;, $ip1);
-            $ip2 = explode(&quot;.&quot;, $ip2);
-
-            // get an integer that represents the numeric value of the address
-            $ip1 = $ip1[0]*256^3 + $ip1[1]*256^2 + $ip1[2]*256 + $ip1[3];
-            $ip2 = $ip2[0]*256^3 + $ip2[1]*256^2 + $ip2[2]*256 + $ip2[3];
-
-            // return diference
-            return $ip1 - $ip2;
-
-        }
-
-        /**
-         *  This function will replace all special characters to normal ASCII characters. This is very useful when you
-         *  want to rename uploaded files and strip out the special characters.
-         *
-         *  @param  $data   The data to strip the special characters from.
-         *
-         *  @returns    The data with the special characters replaced.
-         *
-         *  @static
-         */
-        function stripSpecialCharacters( $data ) {
-
-            // Trim the data
-            $data = trim( $data );
-
-            // Decode the HTML entities
-            $trans = array_flip( get_html_translation_table( HTML_ENTITIES, ENT_NOQUOTES ) );
-            $data = strtr( $data, $trans );
-
-            // The characters to replace
-            $chars = array(
-                '&#192;' =&gt; 'A', '&#194;' =&gt; 'A', '&#196;' =&gt; 'A', '&#198;' =&gt; 'AE', '&#200;' =&gt; 'E', '&#202;' =&gt; 'E', '&#204;' =&gt; 'I', '&#206;' =&gt; 'I',
-                '&#208;' =&gt; 'D', '&#210;' =&gt; 'O', '&#212;' =&gt; 'O', '&#214;' =&gt; 'O', '&#216;' =&gt; 'O', '&#218;' =&gt; 'U', '&#220;' =&gt; 'U', '&#224;' =&gt; 'a',
-                '&#226;' =&gt; 'a', '&#228;' =&gt; 'a', '&#230;' =&gt; 'ae', '&#232;' =&gt; 'e', '&#234;' =&gt; 'e', '&#236;' =&gt; 'i', '&#238;' =&gt; 'i', '&#240;' =&gt; 'o',
-                '&#242;' =&gt; 'o', '&#244;' =&gt; 'o', '&#246;' =&gt; 'o', '&#248;' =&gt; 'o', '&#250;' =&gt; 'u', '&#252;' =&gt; 'u', '&#193;' =&gt; 'A', '&#195;' =&gt; 'A',
-                '&#197;' =&gt; 'A', '&#199;' =&gt; 'C', '&#201;' =&gt; 'E', '&#203;' =&gt; 'E', '&#205;' =&gt; 'I', '&#207;' =&gt; 'I', '&#209;' =&gt; 'N', '&#211;' =&gt; 'O',
-                '&#213;' =&gt; 'O', '&#217;' =&gt; 'U', '&#219;' =&gt; 'U',  '&#221;' =&gt; 'Y', '&#223;' =&gt; 'B', '&#225;' =&gt; 'a', '&#227;' =&gt; 'a', '&#229;' =&gt; 'a',
-                '&#231;' =&gt; 'c', '&#233;' =&gt; 'e', '&#235;' =&gt; 'e', '&#237;' =&gt; 'i', '&#239;' =&gt; 'i', '&#241;' =&gt; 'n', '&#243;' =&gt; 'o', '&#245;' =&gt; 'o',
-                '&#249;' =&gt; 'u', '&#251;' =&gt; 'u', '&#253;' =&gt; 'y', '&#255;' =&gt; 'y', '@' =&gt; '_', ' ' =&gt; '_', '[' =&gt; '_', ']' =&gt; '_',
-                '(' =&gt; '_', ')' =&gt; '_', '&amp;' =&gt; '_', '+' =&gt; '_', '=' =&gt; '_'
-            );
-
-            // Strip the special characters
-            $data = str_replace( array_keys( $chars ), $chars, $data );
-
-            // Return the data
-            return $data;
-
-        }
-
-        /**
-         *  This function will check if the specified string starts with the indicated text or not. You can specify if
-         *  this needs to happen case-sensitively or not.
-         *
-         *  @param  $string         The string to check.
-         *  @param  $substring      The string with which it needs to start.
-         *  @param  $case_sensitive (optional) Whether the comparison needs to be case-sensitive or not. Default is true.
-         *
-         *  @returns    Boolean indicating if the string starts with the specified text or not.
-         */
-        function startsWith( $string, $substring, $case_sensitive=true ) {
-            if ( ! $case_sensitive ) {
-                $string = strtolower( $string );
-                $substring = strtolower( $substring );
-            }
-            return ( substr( $string, 0, strlen( $substring ) ) == $substring );
-        }
-
-        /**
-         *  This function will check if the specified string ends with the indicated text or not. You can specify if
-         *  this needs to happen case-sensitively or not.
-         *
-         *  @param  $string         The string to check.
-         *  @param  $substring      The string with which it needs to ends.
-         *  @param  $case_sensitive (optional) Whether the comparison needs to be case-sensitive or not. Default is true.
-         *
-         *  @returns    Boolean indicating if the string ends with the specified text or not.
-         */
-        function endsWith( $string, $substring, $case_sensitive=true ) {
-            if ( ! $case_sensitive ) {
-                $string = strtolower( $string );
-                $substring = strtolower( $substring );
-            }
-            return ( substr( $string, -strlen( $substring ) ) == $substring );
-        }
-
-        /**
-         *  This function is an fnmatch replacement.
-         *
-         *  $param $string      The string to test
-         *  $param $pattern     The pattern to match
-         *
-         *  @returns    Boolean indicating if the string matches the pattern or not.
-         */
-        function match( $string, $pattern ) {
-            for ( $op = 0, $npattern = '', $n = 0, $l = strlen( $pattern ); $n &lt; $l; $n++ ) {
-            switch ($c = $pattern[$n]) {
-                case '\\':
-                    $npattern .= '\\' . @$pattern[++$n];
-                    break;
-                case '.':
-                case '+':
-                case '^':
-                case '$':
-                case '(':
-                case ')':
-                case '{':
-                case '}':
-                case '=':
-                case '!':
-                case '&lt;':
-                case '&gt;':
-                case '|':
-                    $npattern .= '\\' . $c;
-                    break;
-                case '?': case '*':
-                    $npattern .= '.' . $c;
-                    break;
-                case '[':
-                case ']':
-                default:
-                    $npattern .= $c;
-                    if ($c == '[') {
-                        $op++;
-                    } else if ($c == ']') {
-                        if ($op == 0) return false;
-                            $op--;
-                        }
-                        break;
-                    }
-            }
-            if ( $op != 0 ) {
-                return false;
-            } else {
-                return preg_match( '/' . $npattern . '/i', $string );
-            }
-        }
-
-        /**
-         *  Show the time that has elapsed since a given time.
-         *
-         *  @param  $time   The time in seconds
-         *
-         *  @returns    The elapsed time
-         */
-        function timesince( $time ) {
-
-            // Convert to integer
-            if ( is_string( $time ) &amp;&amp; is_numeric( $time ) ) {
-                $time = intval( $time );
-            }
-
-            // Array of time period chunks
-            $chunks = array(
-                array( 60 * 60 * 24 * 365 , t('years') ),
-                array( 60 * 60 * 24 * 30 , t('months') ),
-                array( 60 * 60 * 24 * 7, t('weeks') ),
-                array( 60 * 60 * 24 , t('days') ),
-                array( 60 * 60 , t('hours') ),
-                array( 60 , t('minutes') ),
-            );
-
-            // Difference in seconds
-            $since = time() - $time;
-
-            // The first chunk
-            for ( $i = 0, $j = sizeof( $chunks ); $i &lt; $j; $i++ ) {
-                $seconds = $chunks[$i][0];
-                $name = $chunks[$i][1];
-                if ( ( $count = floor( $since / $seconds ) ) != 0 ) {
-                    break;
-                }
-            }
-
-            // Set output var
-            $output = ( $count == 1 ) ? '1 '.$name : $count . ' ' . $name;
-
-            // step two: the second chunk
-            if ( $i + 1 &lt; $j ) {
-                $seconds2 = $chunks[$i + 1][0];
-                $name2 = $chunks[$i + 1][1];
-                if ( ( $count2 = floor( ( $since - ( $seconds * $count ) ) / $seconds2 ) ) != 0 ) {
-                    $output .= ($count2 == 1) ? ', 1 '.$name2 : &quot;, $count2 {$name2}s&quot;;
-                }
-            }
-
-            // Return the output
-            return $output . ' ' . t('ago');
-
-        }
-
-    }
-
-    /**
-     *	This class uses the HTTP_USER_AGENT varaible to get information about the browser the visitor used to perform
-     *	the request. We determine the browser name, the version and the platform it's running on.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDBrowserInfo extends YDBase {
-
-        /**
-         *	The class constructor analyzes for the YDBrowserInfo class. The constructor takes no arguments and uses the
-         *	$_SERVER['HTTP_USER_AGENT'] variable to parse the browser info.
-         */
-        function YDBrowserInfo() {
-
-            // Initialize YDBase
-            $this-&gt;YDBase();
-
-            // The matching list for browsers
-            $browsers = array(
-                'bot'       =&gt; array( 'bot', 'Yahoo! Slurp', 'crawler', 'scooter', 'mercator', 'altavista', 'Gulliver', 'spider', 'Ask Jeeves' ),
-                'opera'     =&gt; array( 'opera' ),
-                'ie'        =&gt; array( 'msie' ),
-                'safari'    =&gt; array( 'safari' ),
-                'konqueror' =&gt; array( 'Konqueror' ),
-                'feed'      =&gt; array( 'feed', 'rss', 'synd', 'bloglines', 'newsgator' ),
-                'mozilla'   =&gt; array( 'mozilla', 'firefox' ),
-            );
-
-            // The matching list for platforms
-            $platforms = array(
-                'win'       =&gt; array( 'win' ),
-                'mac'       =&gt; array( 'mac', 'apple' ),
-                'linux'     =&gt; array( 'linux', 'bsd' ),
-                'unix'      =&gt; array( 'unix', 'sun', 'risc', 'aix' ),
-                'bot'       =&gt; array( 'bot', 'Yahoo! Slurp', 'crawler' ),
-                'feed'      =&gt; array( 'feed', 'rss', 'synd', 'bloglines', 'newsgator' ),
-            );
-
-            // Mark everything as unknown
-            $this-&gt;agent = 'unknown';
-            $this-&gt;browser = 'unknown';
-            $this-&gt;platform = 'unknown';
-            $this-&gt;dotnet = 'unknown';
-
-            // Check if the user agent was specified
-            if ( isset( $_SERVER['HTTP_USER_AGENT'] ) ) {
-
-                // Get the user agent
-                $this-&gt;agent = $_SERVER['HTTP_USER_AGENT'];
-
-                // Get the browser name
-                foreach ( $browsers as $browser =&gt; $browserpatterns ) {
-                    foreach ( $browserpatterns as $browserpattern ) {
-                        if ( stristr( $this-&gt;agent, $browserpattern ) ) {
-                            $this-&gt;browser = $browser;
-                            continue;
-                        }
-                    }
-                    if ( $this-&gt;browser != 'unknown' ) {
-                        break;
-                    }
-                }
-
-                // Get the browser name
-                foreach ( $platforms as $platform =&gt; $platformpatterns ) {
-                    foreach ( $platformpatterns as $platformpattern ) {
-                        if ( stristr( $this-&gt;agent, $platformpattern ) ) {
-                            $this-&gt;platform = $platform;
-                            continue;
-                        }
-                    }
-                    if ( $this-&gt;platform != 'unknown' ) {
-                        break;
-                    }
-                }
-
-                // Get the .NET runtime version
-                preg_match_all( '/.NET CLR ([0-9][.][0-9])/i', $this-&gt;agent, $ver );
-                $this-&gt;dotnet = $ver[1];
-
-            }
-
-        }
-
-        /**
-         *  Get the hostname of the client computer.
-         *
-         *  @returns The hostname of the client computer in lowercase.
-         *
-         *  @static
-         */
-        function getComputerName() {
-            return strtolower( gethostbyaddr( $_SERVER['REMOTE_ADDR'] ) );
-        }
-
-        /**
-         *	This function returns an array with the languages that are supported by the browser. This is done by using
-         *	the HTTP_ACCEPT_LANGUAGE server variable that gets send with the HTTP headers.
-         *
-         *	@return Array containing the list of supported languages
-         */
-        function getBrowserLanguages() {
-
-            // We parse the language headers sent by the browser
-            if ( ! isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
-                return array();
-            }
-            $browserLanguages = explode( ',', $_SERVER['HTTP_ACCEPT_LANGUAGE'] );
-
-            // Normalize the browser language headers
-            for ( $i = 0; $i &lt; sizeof( $browserLanguages ); $i++ ) {
-                $browserLanguage = explode( ';', $browserLanguages[$i] );
-                $browserLanguages[$i] = substr( $browserLanguage[0], 0, 2 );
-            }
-
-            // Remove the duplicates
-            $browserLanguages = array_unique( $browserLanguages );
-
-            // Return the browser languages
-            return array_map( 'strtolower', array_values( $browserLanguages ) );
-
-        }
-
-        /**
-         *  This function returns an array with the languages that are supported by the browser and also interprets the
-         *  country information that the browser sends over.. This is done by using the HTTP_ACCEPT_LANGUAGE server
-         *  variable that gets send with the HTTP headers.
-         *
-         *  @return Array containing the list of supported languages
-         */
-        function getBrowserLanguagesAndCountries() {
-
-            // We parse the language headers sent by the browser
-            if ( !isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
-                return array();
-            }
-            $browserCountries = explode( ',', $_SERVER['HTTP_ACCEPT_LANGUAGE'] );
-            $languagesAndCountries = array();
-
-            // Loop over the languages and normalize them
-            foreach( $browserCountries as $value ) {
-                $lang = explode( ';', $value );
-                $lang = explode( '-', $lang[0] );
-                $lang[1] = ( isset( $lang[1] ) &amp;&amp; $lang[1] != '' ? $lang[1] : $lang[0] );
-                $languagesAndCountries[][ $lang[1] ] = $lang[0];
-            }
-
-            // Return the normalized list
-            return $languagesAndCountries;
-
-        }
-
-        /**
-         *	This function will get the most appropriate language for the browser, considering the list of supported
-         *	languages by both the browser and the web application.
-         *
-         *	@param $supported	(optional) An array with the list of supported languages. By default, only english is
-         *						supported.
-         */
-        function getLanguage( $supported=array( 'en' ) ) {
-
-            // Start with the default language
-            $language = $supported[0];
-
-            // Get the list of languages supported by the browser
-            $browserLanguages = $this-&gt;getBrowserLanguages();
-
-            // Now, we look if the browser specified one
-            if ( isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
-                foreach ( $browserLanguages as $browserLanguage ) {
-                    if ( in_array( $browserLanguage, $supported ) ) {
-                        $language = $browserLanguage;
-                        break;
-                    }
-                }
-            }
-
-            // Return the language
-            return $language;
-
-        }
-
-    }
-
-    /**
-     *  This class allows you to generate GUIDs (global unique identifier).
-     *
-     *  More info: <A HREF="http://www.ietf.org/rfc/rfc4122.txt">http://www.ietf.org/rfc/rfc4122.txt</A>
-     *
-     *  @ingroup YDFramework
-     */
-    class YDGuidUtil extends YDBase {
-
-        /**
-         *  Generate a new GUID.
-         *
-         *  @returns    A new GUID as a string.
-         */
-        function create() {
-            return md5( uniqid( rand(), true ) . $_SERVER['SERVER_NAME'] . $_SERVER['SERVER_ADDR'] );
-        }
-
-        /**
-         *  Generate a new formatted GUID.
-         *
-         *  @returns    A formatted GUID as a string.
-         */
-        function createFormatted() {
-            return YDGuidUtil::format( YDGuidUtil::create() );
-        }
-
-        /**
-         *  Formats a GUID.
-         *
-         *  @param $g    GUID to format.
-         *
-         *  @returns    A formatted GUID as a string.
-         */
-         function format( $g ) {
-            $g = str_replace( '-', '', $g );
-            return sprintf(
-                '%s-%s-%s-%s-%s',
-                substr( $g, 0, 8 ), substr( $g, 8, 4 ), substr( $g, 12, 4 ), substr( $g, 16, 4 ), substr( $g, 20 )
-            );
-         }
-
-    }
-
-    /**
-     *  This class allows you to perform LDAP releated tasks.
-     *
-     *  @ingroup YDFramework
-     */
-    class YDLdapUtil extends YDBase {
-
-        /**
-         *  Authenticate against a domain.
-         *
-         *  @param  $server     The name of the domain controller.
-         *  @param  $domain     The name of the domain.
-         *  @param  $user       The username.
-         *  @param  $password   The password.
-         *
-         *  @returns    A boolean indicating if the user was authenticated or not.
-         */
-        function authenticate( $server, $domain, $user, $password ) {
-
-            // Connect to the LDAP server
-            $conn = ldap_connect( $server );
-
-            // Setup the options
-            ldap_set_option( $conn, LDAP_OPT_PROTOCOL_VERSION, 3 );
-            ldap_set_option( $conn, LDAP_OPT_REFERRALS, 0 );
-
-            // Require a username
-            if ( empty( $user ) || empty( $pass ) ) {
-                return false;
-            }
-
-            // Fix the username
-            $user = strtolower( trim( $user ) );
-            if ( strpos( $user, '\\' ) ) {
-                $user = substr( $user, strpos( $user, '\\' ) + 1 );
-            }
-
-            // Authenticate
-            $result = @ldap_bind( $conn, $user . '@' . $server, $password );
-
-            // Close the connection
-            ldap_close( $conn );
-
-            // Return the result
-            return ( $result ) ? true : false;
-
-        }
-
-    }
-
-?&gt;
+&lt;?php
+
+    /*
+
+        Yellow Duck Framework version 2.1
+        (c) Copyright 2002-2007 Pieter Claerhout
+
+        This library is free software; you can redistribute it and/or
+        modify it under the terms of the GNU Lesser General Public
+        License as published by the Free Software Foundation; either
+        version 2.1 of the License, or (at your option) any later version.
+
+        This library is distributed in the hope that it will be useful,
+        but WITHOUT ANY WARRANTY; without even the implied warranty of
+        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
+        Lesser General Public License for more details.
+
+        You should have received a copy of the GNU Lesser General Public
+        License along with this library; if not, write to the Free Software
+        Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+
+    */
+
+    /**
+     *  @addtogroup YDFramework Core
+     */
+
+    // Check if the framework is loaded
+    if ( ! defined( 'YD_FW_NAME' ) ) {
+        die( 'Yellow Duck Framework is not loaded.' );
+    }
+
+    /**
+     *	This is a general timer class that starts counting when it's instantiated, and which returns the elapsed time as
+     *	soon as the finish method is called.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDTimer extends YDBase {
+
+        /**
+         *	This is the class constructor of the YDTimer class.
+         */
+        function YDTimer() {
+
+            // Initialize YDBase
+            $this-&gt;YDBase();
+
+            // Get the start time
+            $this-&gt;startTime = $this-&gt;_getMicroTime();
+
+            // Keep a list of intermediate times
+            $this-&gt;markers = array();
+
+        }
+
+        /**
+         *	This function returns the current microtime as a double.
+         *
+         *	@returns	Double containing the current time.
+         *
+         *	@internal
+         */
+        function _getMicroTime() {
+            $time = explode ( ' ', microtime() );
+            return ( doubleval( $time[0] ) + $time[1] );
+        }
+
+        /**
+         *	This will add a named marker.
+         *
+         *	@param $name	The name to use for the marker
+         */
+        function addMarker( $name ) {
+            array_push( $this-&gt;markers, array( $name, $this-&gt;getElapsed() ) );
+        }
+
+        /**
+         *	Finish the timer.
+         */
+        function finish() {
+            $this-&gt;addMarker( '** Finish' );
+        }
+
+        /**
+         *	This function will return the number of seconds elapsed since the timer was instantiated.
+         *
+         *	@returns	The total elapsed time
+         */
+        function getElapsed() {
+            $endTime = $this-&gt;_getMicroTime();
+            return intval( ( $endTime - $this-&gt;startTime ) * 1000 );
+        }
+
+        /**
+         *	This function returns a report as an array, with each row containing the following info: elapsed time,
+         *	difference with previous marker and marker name.
+         *
+         *	@returns	Array with the elapsed times, differences and marker names.
+         */
+        function getReport() {
+            $report = array();
+            $report[] = array( 0, 0, '** Start' );
+            $previous = 0;
+            foreach ( $this-&gt;markers as $marker ) {
+                $report[] = array( $marker[1], $marker[1]-$previous, $marker[0] );
+                $previous = $marker[1];
+            }
+            return $report;
+        }
+
+    }
+
+    /**
+     *  This class houses all the array related utility functions. All the methods are implemented as static methods and
+     *	do not require you to create a class instance in order to use them.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDArrayUtil extends YDBase {
+
+        /**
+         *  This function will convert a single dimension array to a multi dimension array with the indicated number of
+         *	colums. If the number of columns is 1, it will return the original array.
+         *
+         *  If you enable the $fillLastRow option, it will fill the last row with null values to match the number of
+         *	columns.
+         *
+         *  @param $array		    The single dimension array you want to convert.
+         *  @param $columns		    The number of columns the table should have.
+         *  @param $fillLastRow	    (optional) If true, the last row will be filled with null values so that it matches
+         *						    the number of columns.
+         *  @param $horizontal  	(optional) If true, rows will be filled first, then it will create an new row
+         *
+         *  @returns	A multi-dimension array with the contents of the original array converted to a table with the
+         *				indicated number of colums.
+         *
+         *	@static
+         */
+        function convertToTable( $array, $columns, $fillLastRow=false, $horizontal=true ) {
+
+            // If the number of columns is 1, return the original array
+            if ( $columns == 1 ) {
+                return $array;
+            }
+
+            // Return original array if empty
+            if ( sizeof( $array ) == 0 ) {
+                return $array;
+            }
+
+            // Convert horizontally or vertically
+            if ( $horizontal ) {
+
+                // Use the array_chunk function to convert to a table
+                $newArray = @array_chunk( $array, $columns );
+                if ( $newArray == null ) {
+                    trigger_error( 'Failed to split the array in chunks.', YD_ERROR );
+                }
+
+                // Pad the last row
+                if ( $fillLastRow ) {
+                    $lastRow = $newArray[sizeof( $newArray )-1];
+                    $numMissing = $columns - sizeof( $lastRow );
+                    for ( $i = 0; $i &lt; $numMissing; $i++ ) {
+                        array_push( $newArray[sizeof( $newArray )-1], null );
+                    }
+
+                }
+
+            } else {
+
+                // Get only the values of the array
+                $array = array_values( $array );
+
+                // Check how many rows we will have
+                $rows = ceil( sizeof( $array ) / $columns );
+
+                // Keep track of the current row
+                $currentItem = 0;
+                $currentCol  = 0;
+
+                // Start with a new empty array
+                $newArray = array();
+
+                // Loop over the rows
+                while ( $currentCol &lt; $columns ) {
+                    foreach ( range( 0, $rows-1 ) as $row ) {
+                        $newArray[$row][$currentCol] = isset( $array[$currentItem] ) ? $array[$currentItem] : null;
+                        $currentItem++;
+                    }
+                    $currentCol++;
+                }
+
+            }
+
+            // Return the array
+            return $newArray;
+
+        }
+
+        /**
+         *	This function will create a new array which is a nested using the given column name.
+         *
+         *	@param $array	The array to convert.
+         *	@param $key		The column to use as the key name.
+         *	@param $append	(Optional) Boolean that defines if values are append to array (TRUE) or if are assigned (FALSE).
+         *
+         *	@returns	A new array which is a nested using the given column name.
+         *
+         *	@static
+         */
+        function convertToNested( $array, $key, $append = true ) {
+
+            // Start with the a new array
+            $new = array();
+
+            // Loop over the original array
+            foreach ( $array as $item ) {
+                if ( ! array_key_exists( $key, $item ) ) {
+                    trigger_error( 'YDArrayUtil::convertToNested: key &quot;' . $key . '&quot; not found', YD_ERROR );
+                }
+
+                // append values or assign them
+                if ( $append == true ){
+                    if ( ! isset( $new[ $item[ $key ] ] ) ) { $new[ $item[ $key ] ] = array(); }
+                    array_push( $new[ $item[ $key ] ], $item );
+                }else{
+                    $new[ $item[ $key ] ] = $item;
+                }
+            }
+
+            // Return the new array
+            return $new;
+
+        }
+
+        /**
+         *	This function will create a new array which is grouped by a given key and mapped according to a given array.
+         *
+         *	@param $input	The array to convert.
+         *	@param $key		The column to use as the key name.
+         *	@param $map		The array or string which indicates how values of the children arrays should be mapped in
+         *                  the parent array.
+         *
+         *	@returns		The array resulting from the mapping.
+         *
+         *	@static
+         */
+        function map( $input, $key, $map ) {
+
+            // Starting with new array
+            $output = array();
+
+            // Loop over the original array
+            foreach ( $input as $inputFragment ) {
+                if ( isset( $inputFragment[ $key ] ) ) {
+                    if ( is_array($map)) {
+                        foreach ( $map as $mapKey =&gt; $mapValue ) {
+                            if ( ! array_key_exists( $key, $inputFragment ) ) {
+                                trigger_error( 'YDArrayUtil::map: key &quot;' . $key . '&quot; not found', YD_ERROR );
+                            }
+                            if ( isset( $inputFragment[ $mapKey ] ) &amp;&amp; isset( $inputFragment[ $mapValue ] ) ) {
+                                $output[ $inputFragment[ $key ] ][ $inputFragment[ $mapKey ] ] = $inputFragment[ $mapValue ];
+                            }
+                            else {
+                                $output[ $inputFragment[ $key ] ][ $inputFragment[ $mapKey ] ] = NULL;
+                            }
+                        }
+                    }
+                    else {
+                        $output[ $inputFragment[ $key ] ] = $inputFragment[ $map ];
+                    }
+                }
+            }
+
+            // Return the new array
+            return $output;
+        }
+
+        /**
+         *  This function will implode a 1-level array in a string.
+         *
+         *  @param $input      The array to implode.
+         *  @param $glue       (optional) The key/value glue. Default: =
+         *  @param $separator  (optional) The items separator. Default: ,
+         *
+         *  @returns       The imploded string.
+         *
+         *  @static
+         */
+        function implode( $input, $glue='=', $separator=',' ) {
+            $return = '';
+            foreach ( $input as $k =&gt; $v ) {
+                $return .= $separator . $k . $glue . $v;
+            }
+            return substr( $return, 1 );
+        }
+
+        /**
+         *  This function will initialize the indicated array if it doesn't exist yet.
+         *
+         *  @param  $where  Where to instantiate the array in.
+         *  @param  $name   The name of the array to create.
+         *
+         *  @static
+         */
+        function createIfNeeded( &amp; $where, $name ) {
+            if ( ! isset( $where[$name] ) ) {
+                $where[$name] = array();
+            }
+        }
+
+
+        /**
+         *  This function will return a array with gmts.
+         *
+         *  @param $format      Format to return
+         *
+         *  @returns	Array. If format is NULL returns complete array.
+         *                                  'simple' returns: array( -11 =&gt; '(GMT -11:00)', -10 =&gt; ...
+         *                                  'full'   returns: array( -11 =&gt; '(GMT -11:00) Nome, Midway Island, Samoa', -10 =&gt; ...
+         *  @static
+         */
+        function getGMT( $format = null ){
+            $gmts = array(
+                '-11'   =&gt; array( '(GMT -11:00)', 'Nome, Midway Island, Samoa' ),
+                '-10'   =&gt; array( '(GMT -10:00)', 'Hawaii' ),
+                 '-9'   =&gt; array( '(GMT  -9:00)', 'Alaska' ),
+                 '-8'   =&gt; array( '(GMT  -8:00)', 'Pacific Time' ),
+                 '-7'   =&gt; array( '(GMT  -7:00)', 'Mountain Time' ),
+                 '-6'   =&gt; array( '(GMT  -6:00)', 'Central Time, Mexico City' ),
+                 '-5'   =&gt; array( '(GMT  -5:00)', 'Eastern Time, Bogota, Lima, Quito' ),
+                 '-4'   =&gt; array( '(GMT  -4:00)', 'Atlantic Time, Caracas, La Paz' ),
+                 '-3.5' =&gt; array( '(GMT  -3:30)', 'Newfoundland' ),
+                 '-3'   =&gt; array( '(GMT  -3:00)', 'Brazil, Buenos Aires, Georgetown, Falkland Is.' ),
+                 '-2'   =&gt; array( '(GMT  -2:00)', 'Mid-Atlantic, Ascention Is., St Helena' ),
+                 '-1'   =&gt; array( '(GMT  -1:00)', 'Azores, Cape Verde Islands' ),
+                  '0'   =&gt; array( '(GMT   0:00)', 'Casablanca, Dublin, Edinburgh, London, Lisbon, Monrovia' ),
+                  '1'   =&gt; array( '(GMT  +1:00)', 'Berlin, Brussels, Copenhagen, Madrid, Paris, Rome' ),
+                  '2'   =&gt; array( '(GMT  +2:00)', 'Kaliningrad, South Africa, Warsaw' ),
+                  '3'   =&gt; array( '(GMT  +3:00)', 'Baghdad, Riyadh, Moscow, Nairobi' ),
+                  '2.5' =&gt; array( '(GMT  +3:30)', 'Tehran' ),
+                  '4'   =&gt; array( '(GMT  +4:00)', 'Abu Dhabi, Baku, Muscat, Tbilisi' ),
+                  '4.5' =&gt; array( '(GMT  +4:30)', 'Kabul' ),
+                  '5'   =&gt; array( '(GMT  +5:00)', 'Islamabad, Karachi, Tashkent' ),
+                  '5.5' =&gt; array( '(GMT  +5:30)', 'Bombay, Calcutta, Madras, New Delhi' ),
+                  '6'   =&gt; array( '(GMT  +6:00)', 'Almaty, Colombo, Dhaka' ),
+                  '7'   =&gt; array( '(GMT  +7:00)', 'Bangkok, Hanoi, Jakarta' ),
+                  '8'   =&gt; array( '(GMT  +8:00)', 'Beijing, Hong Kong, Perth, Singapore, Taipei' ),
+                  '9'   =&gt; array( '(GMT  +9:00)', 'Osaka, Sapporo, Seoul, Tokyo, Yakutsk' ),
+                  '9.5' =&gt; array( '(GMT  +9:30)', 'Adelaide, Darwin' ),
+                 '10'   =&gt; array( '(GMT +10:00)', 'Melbourne, Papua New Guinea, Sydney, Vladivostok' ),
+                 '11'   =&gt; array( '(GMT +11:00)', 'Magadan, New Caledonia, Solomon Islands' ),
+                 '12'   =&gt; array( '(GMT +12:00)', 'Auckland, Wellington, Fiji, Marshall Island' )
+            );
+            if ( is_null( $format ) ) {
+                return $gmts;
+            }
+            foreach( $gmts as $t =&gt; $arr ){
+                if ( $format == 'simple' ) $gmts[ $t ] = $arr[ 0 ];
+                else                       $gmts[ $t ] = $arr[ 0 ] . ' ' . $arr[ 1 ];
+            }
+            return $gmts;
+        }
+
+        /**
+         *  This function will convert a database result array to XML
+         *
+         *  @param $array      The input array.
+         *
+         *  @returns       The array as an XML string.
+         *
+         *  @static
+         */
+        function toXml( $array ) {
+            $out = '';
+            foreach ( $array as $record ) {
+                $out .= sprintf( '&lt;row&gt;' );
+                foreach ( $record as $key=&gt;$val ) {
+                    if ( is_numeric( $val ) ) {
+                        $out .= sprintf( '&lt;%s&gt;%s&lt;/%s&gt;', $key, $val, $key );
+                    } else {
+                        $out .= sprintf( '&lt;%s&gt;&lt;![CDATA[%s]]&gt;&lt;/%s&gt;', $key, $val, $key );
+                    }
+                }
+                $out .= sprintf( '&lt;/row&gt;' );
+            }
+            $out = sprintf( '&lt;root&gt;%s&lt;/root&gt;', $out );
+            return '&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;' . $out;
+        }
+
+    }
+
+    /**
+     *	This class houses all the debug related utility functions. All the methods are implemented as static methods and
+     *	do not require you to create a class instance in order to use them.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDDebugUtil extends YDBase {
+
+        /**
+         *  Trigger an error
+         *
+         *  @param  $msg    The error to raise.
+         *  @param  $sql    (optional) The SQL statement to log with the error.
+         *  @param  $level  (optional) The type of error to be raised. Default is YD_ERROR.
+         */
+        function error( $msg, $sql=null, $level=YD_ERROR ) {
+            echo( '&lt;p&gt;&lt;b&gt;&lt;font color=&quot;red&quot;&gt;An error occured&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;' );
+            echo( '&lt;b&gt;Stacktrace:&lt;/b&gt; &lt;pre&gt;' . YDDebugUtil::getStackTrace() . '&lt;/pre&gt;' );
+            if ( ! empty( $sql ) ) {
+                echo( '&lt;b&gt;SQL Statement:&lt;/b&gt; &lt;pre&gt;' . $this-&gt;formatSql( $sql ) . '&lt;/pre&gt;' );
+            }
+            trigger_error( $msg, $level );
+        }
+
+        /**
+         *	Function to output a debug message. These message are only shown if the constant YD_DEBUG is set to 1. You
+         *	can turn on debugging by specifying the YD_DEBUG parameter in the url and assigning it the value 1.
+         *
+         *	Example url with debugging turned on: <A HREF="http://localhost/index.php?YD_DEBUG=1">http://localhost/index.php?YD_DEBUG=1</A>
+         *
+         *	This function accepts a variable amount of arguments which are all concatenated using a space in between.
+         *	All debug messages will be shown as HTML comments with the prefix &quot;[ YD_DEBUG ]&quot;.
+         *
+         *	@static
+         */
+        function debug() {
+            $args = func_get_args();
+            if ( YDConfig::get( 'YD_DEBUG' ) == 1 ) {
+                echo( YD_CRLF . '&lt;!-- [ YD_DEBUG ] ' . implode( ' ', $args ) . '--&gt;' . YD_CRLF );
+            }
+            if ( YDConfig::get( 'YD_DEBUG' ) == 2 ) {
+                echo( '&lt;table border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;4&quot;&gt;&lt;tr&gt;' );
+                echo( '&lt;td bgcolor=&quot;#FFCC00&quot;&gt;' );
+                echo( '&lt;b&gt;' . YD_FW_NAME . ' Debug Information&lt;/b&gt; ' );
+                echo( '&lt;pre&gt;' . htmlspecialchars( trim( implode( ' ', $args ) ) ) . '&lt;/pre&gt;' );
+                echo( '&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;' );
+            }
+        }
+
+        /**
+         *	Function to dump the contents of pretty much anything. This is the same as the var_dump function in PHP, but
+         *	has a nicer and more readable output.
+         *
+         *	@param $obj		Object you want to dump.
+         *	@param $label	The label for the dump.
+         *
+         *	@static
+         */
+        function dump( $obj, $label='' ) {
+            echo( YDDebugUtil::r_dump( $obj, true, $label ) );
+        }
+
+        /**
+         *	Function to return the contents of pretty much anything. This is the same as the var_export function in PHP.
+         *
+         *	@param $obj		Object you want to dump.
+         *	@param $html	(optional) If you want to have everything returned as HTML or text. The default is false,
+         *					returning text.
+         *	@param $label	The label for the dump.
+         *
+         *	@returns	Text representation of the object.
+         *
+         *	@static
+         */
+        function r_dump( $obj, $html=false, $label='' ) {
+            $data = var_export( $obj, true );
+            if ( $html == true ) {
+                $data = stripslashes( htmlentities( $data ) );
+                $style = ' style=&quot;text-align: left; font-size: 10pt;&quot;';
+                if ( ! empty( $label ) ) {
+                    $data = '&lt;pre' . $style . '&gt;&lt;b style=&quot;color: navy&quot;&gt;' . $label . '&lt;/b&gt;&lt;br&gt;' . $data . '&lt;/pre&gt;';
+                } else {
+                    $data = '&lt;pre' . $style . '&gt;' . $data . '&lt;/pre&gt;';
+                }
+            } else {
+                $data = $label . YD_CRLF . $data;
+            }
+            return $data;
+        }
+
+        /**
+         *	This function will print a stack trace.
+         *
+         *	@static
+         */
+        function stackTrace() {
+            if ( YDConfig::get( 'YD_DEBUG' ) == 1 || YDConfig::get( 'YD_DEBUG' ) == 2 ) {
+                $err = 'URI: ' . YD_SELF_URI . YD_CRLF . YDDebugUtil::getStackTrace();
+                if ( ini_get( 'display_errors' ) == 1 ) {
+                    echo( '&lt;pre&gt;' . YD_CRLF . htmlentities( $err ) . '&lt;/pre&gt;' );
+                }
+                error_log( $err, 0 );
+            }
+        }
+
+        /**
+         *	Function to get a formatted stack trace.
+         *
+         *	@static
+         */
+        function getStackTrace() {
+            $err = '';
+            $err .= 'Debug backtrace:' . YD_CRLF;
+            foreach( debug_backtrace() as $t ) {
+                $err .= '    @ ';
+                if ( isset( $t['file'] ) ) {
+                    $err .= basename( $t['file'] ) . ':' . $t['line'];
+                } else {
+                    $err .= basename( YD_SELF_FILE );
+                }
+                $err .= ' -- ';
+                if ( isset( $t['class'] ) ) {
+                    $err .= $t['class'] . $t['type'];
+                }
+                $err .= $t['function'];
+                if ( isset( $t['args'] ) &amp;&amp; sizeof( $t['args'] ) &gt; 0 ) {
+                    $err .= '(...)';
+                } else {
+                    $err .= '()';
+                }
+                $err .= YD_CRLF;
+            }
+            return $err;
+        }
+
+    }
+
+    /**
+     *	This class houses all the object and class related utility functions. All the methods are implemented as static
+     *	methods and do not require you to create a class instance in order to use them.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDObjectUtil extends YDBase {
+
+        /**
+         *	This function checks if an object instance is of a specific class or is based on a derived class of the
+         *	given class. The class name is case insensitive.
+         *
+         *	@param $obj		The object instance to check.
+         *	@param $class	The object type you want to check against.
+         *
+         *	@returns	Boolean indicating if the object is of the specified class.
+         *
+         *	@static
+         */
+        function isSubClass( $obj, $class ) {
+            $class = strtolower( $class );
+            if ( function_exists( 'is_a' ) ) {
+                return is_a( $obj, $class );
+            } else {
+                if ( is_object( $obj ) ) {
+                    if ( strtolower( get_class( $obj ) ) == strtolower( $class ) ) return true;
+                    if ( is_subclass_of( $obj, $class ) ) return true;
+                }
+            }
+            return false;
+        }
+
+        /**
+         *	Function to get all the ancestors of a class. The list will contain the parent class first, and then it's
+         *	parent class, etc. You can pass both the name of the class or an object instance to this function
+         *
+         *	@param $classname	Name of the class or object.
+         *
+         *	@returns	Array with all the ancestors.
+         *
+         *	@static
+         */
+        function getAncestors( $classname ) {
+            if ( is_object( $classname ) ) {
+                $classname = strtolower( get_class( $classname ) );
+            }
+            $ancestors = array();
+            $father = get_parent_class( $classname );
+            if ( $father != '' ) {
+                $ancestors = YDObjectUtil::getAncestors( $father );
+                $ancestors[] = $father;
+            }
+            return array_reverse( $ancestors );
+        }
+
+        /**
+         *	This function will serialize an object.
+         *
+         *	@param $obj	Object to serialize.
+         *
+         *	@static
+         */
+        function serialize( $obj ) {
+            $obj = serialize( $obj );
+            if ( ! $obj ) {
+                trigger_error( 'Failed serializing the object', YD_ERROR );
+            }
+            return $obj;
+        }
+
+        /**
+         *	This function will unserialize an object.
+         *
+         *	@param $obj	Object to unserialize.
+         *
+         *	@static
+         */
+        function unserialize( $obj ) {
+            $obj = unserialize( $obj );
+            if ( ! $obj ) {
+                trigger_error( 'Failed unserializing the object', YD_ERROR );
+            }
+            return $obj;
+        }
+
+    }
+
+    /**
+     *	This class houses all the string related utility functions. All the methods are implemented as static methods
+     *	and do not require you to create a class instance in order to use them.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDStringUtil extends YDBase {
+
+        /**
+         *	Function to format a file size to a meaningful value.
+         *
+         *	@param $bytes		The file size to format.
+         *	@param $decimals	(optional) The number of decimals that should be returned.
+         *
+         *	@returns String containing the formatted file size.
+         *
+         *	@static
+         */
+        function formatFilesize( $bytes, $decimals=1 ) {
+
+            // Convert the bytes to a string
+            $bytes = strval( $bytes );
+
+            // The different units
+            $units = array(
+                '1152921504606846976'	=&gt; 'EB',
+                '1125899906842624'		=&gt; 'PB',
+                '1099511627776'			=&gt; 'TB',
+                '1073741824'			=&gt; 'GB',
+                '1048576'				=&gt; 'MB',
+                '1024'					=&gt; 'KB'
+            );
+
+            // If smaller than 1024, return it as bytes
+            if ( $bytes &lt;= 1024 ) {
+                return $bytes . ' bytes';
+            }
+
+            // Check the right format
+            foreach ( $units as $base=&gt;$title ) {
+                if ( floor( $bytes / $base ) != 0 ) {
+                    return number_format( $bytes / $base, $decimals, '.', &quot;'&quot; ) . ' ' . $title;
+                }
+            }
+
+        }
+
+        /**
+         *  This function will format a timestamp using the strftime function.
+         *
+         *  @param  $timestamp  The timestamp to format. It can also be a date/time form object.
+         *  @param  $format     The strftime format to use. You can also use the predefined options date, time and
+         *                      datetime.
+         *  @param  $locale     (optional) The locale to use to format the date.
+         *
+         *  @returns    A formatted timestamp
+         *
+         *  @static
+         */
+        function formatDate( $timestamp, $format, $locale=null ) {
+
+            // Check if the timestamp is an object and has the getTimeStamp function
+            if ( is_object( $timestamp ) &amp;&amp; method_exists( $timestamp, 'getTimeStamp' ) ) {
+                $timestamp = $timestamp-&gt;getTimeStamp();
+            }
+
+            // Convert to an integer
+            if ( is_numeric( $timestamp ) ) {
+                $timestamp = intval( $timestamp );
+            }
+
+            // If text, convert to number
+            if ( is_string( $timestamp ) ) {
+                $timestamp = strtotime( $timestamp );
+            }
+
+            // If array, is a date YDForm element value
+            if ( is_array( $timestamp ) ) {
+
+                // check if timestamp exists. otherwise create it
+                $hours   = isset( $timestamp[ 'hours' ] ) ?   $timestamp[ 'hours' ] : 0;
+                $minutes = isset( $timestamp[ 'minutes' ] ) ? $timestamp[ 'minutes' ] : 0;
+                $seconds = isset( $timestamp[ 'seconds' ] ) ? $timestamp[ 'seconds' ] : 0;
+                $month   = isset( $timestamp[ 'month' ] ) ?   $timestamp[ 'month' ] : 1;
+                $day     = isset( $timestamp[ 'day' ] ) ?     $timestamp[ 'day' ] : 1;
+                $year    = isset( $timestamp[ 'year' ] ) ?    $timestamp[ 'year' ] : 1970;
+                $timestamp = mktime( $hours, $minutes, $seconds, $month, $day, $year );
+            }
+
+            // Check the standard formats
+            if ( strtolower( $format ) == 'date' ) {
+                $format = '%d %B %Y';
+            }
+            if ( strtolower( $format ) == 'datetime' ) {
+                $format = '%d %B %Y %H:%M';
+            }
+            if ( strtolower( $format ) == 'datetimesql' ) {
+                $format = '%Y-%m-%d %H:%M:%S';
+            }
+            if ( strtolower( $format ) == 'time' ) {
+                $format = '%H:%M';
+            }
+            if ( strtolower( $format ) == 'file' ) {
+                $format = '%d-%m-%Y %H:%M';
+            }
+
+            // Set the new locale
+            if ( ! is_null( $locale ) ) {
+                $currentLocale = YDLocale::get();
+                YDLocale::set( $locale );
+            }
+
+            // Return the formatted date
+            $timestamp = strftime( $format, $timestamp );
+
+            // Reset the old locale
+            if ( ! is_null( $locale ) ) {
+                YDLocale::set( $currentLocale );
+            }
+
+            // Return the timestamp
+            return $timestamp;
+
+        }
+
+        /**
+         *	This function will encode all characters which have an ordinal bigger than 128 to numeric HTML entities,
+         *	which can be safely included in e.g. XML output.
+         *
+         *	@param $string	The original string to encode.
+         *	@param $htmlent	Boolean indicating if the result should be HTML encoded or not.
+         *
+         *	@returns	String with all the characters with an ordinal bigger than 128 converted to numeric entities.
+         *
+         *	@static
+         */
+        function encodeString( $string, $htmlent=false ) {
+            $trans = array_flip( get_html_translation_table( HTML_ENTITIES ) );
+            $string = strtr( $string, $trans );
+            $trans = get_html_translation_table( HTML_ENTITIES, ENT_NOQUOTES );
+            foreach ( $trans as $key =&gt; $value ) {
+                if ( ord( $key ) == 60 || ord( $key ) == 62 || ord( $key ) == 38 ) {
+                    unset( $trans[$key] );
+                } else {
+                    $trans[$key] = '&amp;#' . ord( $key ) . ';';
+                }
+            }
+            $string = strtr( $string, $trans );
+            if ( $htmlent == true ) {
+                $string = htmlentities( $string );
+            }
+            return $string;
+        }
+
+        /**
+         *   This function will encode all characters in a string to it's ASCII value.
+         *
+         *   @param $string   The original string to encode.
+         *
+         *   @returns   The encoded string.
+         *
+         *   @static
+         */
+        function encodeToAscii( $string ) {
+            $result = '';
+            for ( $i=0; $i &lt; strlen( $string ); $i++ ) {
+                $result .= &quot;&amp;#&quot; . ord( substr( $string, $i, 1) ) . ';';
+            }
+            return $result;
+        }
+
+        /**
+         *	This function will truncate a string.
+         *
+         *	@param $string		String to truncate.
+         *	@param $length		(optional) The length to truncate to. Default length is 80 characters.
+         *	@param $etc			(optional) The string to append if the item gets trunctated. Default is '...'.
+         *	@param $break_words	(optional) Break in the middle of words or not. Default is false.
+         *
+         *	@static
+         */
+        function truncate( $string, $length=80, $etc='...', $break_words=false ) {
+            if ( $length == 0 ) { return ''; }
+            if ( strlen( $string ) &gt; $length ) {
+                $string = html_entity_decode( strip_tags( $string ) );
+                $length -= strlen( $etc );
+                if ( ! $break_words ) {
+                    $string = preg_replace( '/\s+?(\S+)?$/', '', substr( $string, 0, $length+1 ) );
+                }
+                return htmlentities( substr( $string, 0, $length ) . $etc );
+            } else {
+                return $string;
+            }
+        }
+
+        /**
+         *	This function normalizes all the newlines to the correct newline character for the current platform.
+         *
+         *	@param $string		String to normalize the newlines from.
+         *
+         *	@returns	The original string with normalized newlines.
+         *
+         *	@static
+         */
+        function normalizeNewlines( $string ) {
+
+            // First, change all to \n
+            $string = str_replace( &quot;\r\n&quot;, &quot;\n&quot;,    $string );
+            $string = str_replace( &quot;\r&quot;,   &quot;\n&quot;,    $string );
+
+            // Now, change everything to the correct one
+            $string = str_replace( &quot;\n&quot;,   YD_CRLF, $string );
+
+            // Return the changed string
+            return $string;
+
+        }
+
+        /**
+         *	This function will remove all newlines and all spaces at the beginning and end of each line.
+         *
+         *	@param $string		String to remove the whitespace from.
+         *
+         *	@returns	The original string without the newlines and spaces at the beginning and end of each line.
+         *
+         *	@static
+         */
+        function removeWhiteSpace( $string ) {
+
+            // First, normalize the newlines
+            $string = YDStringUtil::normalizeNewLines( $string );
+
+            // Now, remove the whitespace
+            $string = implode( ' ', array_map( 'trim', explode( YD_CRLF, $string ) ) );
+
+            // Return the changed string
+            return $string;
+
+        }
+
+        /**
+         *   This function will compare two network ip addresses
+         *
+         *   @param $ip1      First ip
+         *
+         *   @param $ip2      Second ip
+         *
+         *   @returns    Returns &lt; 0 if ip1 is less than ip2; &gt; 0 if str1 is greater than ip2, and 0 if they are equal.
+         *
+         *   @static
+         */
+        function ipcmp( $ip1, $ip2 ){
+
+            // get 4 elements from the network address
+            $ip1 = explode(&quot;.&quot;, $ip1);
+            $ip2 = explode(&quot;.&quot;, $ip2);
+
+            // get an integer that represents the numeric value of the address
+            $ip1 = $ip1[0]*256^3 + $ip1[1]*256^2 + $ip1[2]*256 + $ip1[3];
+            $ip2 = $ip2[0]*256^3 + $ip2[1]*256^2 + $ip2[2]*256 + $ip2[3];
+
+            // return diference
+            return $ip1 - $ip2;
+
+        }
+
+        /**
+         *  This function will replace all special characters to normal ASCII characters. This is very useful when you
+         *  want to rename uploaded files and strip out the special characters.
+         *
+         *  @param  $data   The data to strip the special characters from.
+         *
+         *  @returns    The data with the special characters replaced.
+         *
+         *  @static
+         */
+        function stripSpecialCharacters( $data ) {
+
+            // Trim the data
+            $data = trim( $data );
+
+            // Decode the HTML entities
+            $trans = array_flip( get_html_translation_table( HTML_ENTITIES, ENT_NOQUOTES ) );
+            $data = strtr( $data, $trans );
+
+            // The characters to replace
+            $chars = array(
+                '&#192;' =&gt; 'A', '&#194;' =&gt; 'A', '&#196;' =&gt; 'A', '&#198;' =&gt; 'AE', '&#200;' =&gt; 'E', '&#202;' =&gt; 'E', '&#204;' =&gt; 'I', '&#206;' =&gt; 'I',
+                '&#208;' =&gt; 'D', '&#210;' =&gt; 'O', '&#212;' =&gt; 'O', '&#214;' =&gt; 'O', '&#216;' =&gt; 'O', '&#218;' =&gt; 'U', '&#220;' =&gt; 'U', '&#224;' =&gt; 'a',
+                '&#226;' =&gt; 'a', '&#228;' =&gt; 'a', '&#230;' =&gt; 'ae', '&#232;' =&gt; 'e', '&#234;' =&gt; 'e', '&#236;' =&gt; 'i', '&#238;' =&gt; 'i', '&#240;' =&gt; 'o',
+                '&#242;' =&gt; 'o', '&#244;' =&gt; 'o', '&#246;' =&gt; 'o', '&#248;' =&gt; 'o', '&#250;' =&gt; 'u', '&#252;' =&gt; 'u', '&#193;' =&gt; 'A', '&#195;' =&gt; 'A',
+                '&#197;' =&gt; 'A', '&#199;' =&gt; 'C', '&#201;' =&gt; 'E', '&#203;' =&gt; 'E', '&#205;' =&gt; 'I', '&#207;' =&gt; 'I', '&#209;' =&gt; 'N', '&#211;' =&gt; 'O',
+                '&#213;' =&gt; 'O', '&#217;' =&gt; 'U', '&#219;' =&gt; 'U',  '&#221;' =&gt; 'Y', '&#223;' =&gt; 'B', '&#225;' =&gt; 'a', '&#227;' =&gt; 'a', '&#229;' =&gt; 'a',
+                '&#231;' =&gt; 'c', '&#233;' =&gt; 'e', '&#235;' =&gt; 'e', '&#237;' =&gt; 'i', '&#239;' =&gt; 'i', '&#241;' =&gt; 'n', '&#243;' =&gt; 'o', '&#245;' =&gt; 'o',
+                '&#249;' =&gt; 'u', '&#251;' =&gt; 'u', '&#253;' =&gt; 'y', '&#255;' =&gt; 'y', '@' =&gt; '_', ' ' =&gt; '_', '[' =&gt; '_', ']' =&gt; '_',
+                '(' =&gt; '_', ')' =&gt; '_', '&amp;' =&gt; '_', '+' =&gt; '_', '=' =&gt; '_'
+            );
+
+            // Strip the special characters
+            $data = str_replace( array_keys( $chars ), $chars, $data );
+
+            // Return the data
+            return $data;
+
+        }
+
+        /**
+         *  This function will check if the specified string starts with the indicated text or not. You can specify if
+         *  this needs to happen case-sensitively or not.
+         *
+         *  @param  $string         The string to check.
+         *  @param  $substring      The string with which it needs to start.
+         *  @param  $case_sensitive (optional) Whether the comparison needs to be case-sensitive or not. Default is true.
+         *
+         *  @returns    Boolean indicating if the string starts with the specified text or not.
+         */
+        function startsWith( $string, $substring, $case_sensitive=true ) {
+            if ( ! $case_sensitive ) {
+                $string = strtolower( $string );
+                $substring = strtolower( $substring );
+            }
+            return ( substr( $string, 0, strlen( $substring ) ) == $substring );
+        }
+
+        /**
+         *  This function will check if the specified string ends with the indicated text or not. You can specify if
+         *  this needs to happen case-sensitively or not.
+         *
+         *  @param  $string         The string to check.
+         *  @param  $substring      The string with which it needs to ends.
+         *  @param  $case_sensitive (optional) Whether the comparison needs to be case-sensitive or not. Default is true.
+         *
+         *  @returns    Boolean indicating if the string ends with the specified text or not.
+         */
+        function endsWith( $string, $substring, $case_sensitive=true ) {
+            if ( ! $case_sensitive ) {
+                $string = strtolower( $string );
+                $substring = strtolower( $substring );
+            }
+            return ( substr( $string, -strlen( $substring ) ) == $substring );
+        }
+
+        /**
+         *  This function is an fnmatch replacement.
+         *
+         *  $param $string      The string to test
+         *  $param $pattern     The pattern to match
+         *
+         *  @returns    Boolean indicating if the string matches the pattern or not.
+         */
+        function match( $string, $pattern ) {
+            for ( $op = 0, $npattern = '', $n = 0, $l = strlen( $pattern ); $n &lt; $l; $n++ ) {
+            switch ($c = $pattern[$n]) {
+                case '\\':
+                    $npattern .= '\\' . @$pattern[++$n];
+                    break;
+                case '.':
+                case '+':
+                case '^':
+                case '$':
+                case '(':
+                case ')':
+                case '{':
+                case '}':
+                case '=':
+                case '!':
+                case '&lt;':
+                case '&gt;':
+                case '|':
+                    $npattern .= '\\' . $c;
+                    break;
+                case '?': case '*':
+                    $npattern .= '.' . $c;
+                    break;
+                case '[':
+                case ']':
+                default:
+                    $npattern .= $c;
+                    if ($c == '[') {
+                        $op++;
+                    } else if ($c == ']') {
+                        if ($op == 0) return false;
+                            $op--;
+                        }
+                        break;
+                    }
+            }
+            if ( $op != 0 ) {
+                return false;
+            } else {
+                return preg_match( '/' . $npattern . '/i', $string );
+            }
+        }
+
+        /**
+         *  Show the time that has elapsed since a given time.
+         *
+         *  @param  $time   The time in seconds
+         *
+         *  @returns    The elapsed time
+         */
+        function timesince( $time ) {
+
+            // Convert to integer
+            if ( is_string( $time ) &amp;&amp; is_numeric( $time ) ) {
+                $time = intval( $time );
+            }
+
+            // Array of time period chunks
+            $chunks = array(
+                array( 60 * 60 * 24 * 365 , t('years') ),
+                array( 60 * 60 * 24 * 30 , t('months') ),
+                array( 60 * 60 * 24 * 7, t('weeks') ),
+                array( 60 * 60 * 24 , t('days') ),
+                array( 60 * 60 , t('hours') ),
+                array( 60 , t('minutes') ),
+            );
+
+            // Difference in seconds
+            $since = time() - $time;
+
+            // The first chunk
+            for ( $i = 0, $j = sizeof( $chunks ); $i &lt; $j; $i++ ) {
+                $seconds = $chunks[$i][0];
+                $name = $chunks[$i][1];
+                if ( ( $count = floor( $since / $seconds ) ) != 0 ) {
+                    break;
+                }
+            }
+
+            // Set output var
+            $output = ( $count == 1 ) ? '1 '.$name : $count . ' ' . $name;
+
+            // step two: the second chunk
+            if ( $i + 1 &lt; $j ) {
+                $seconds2 = $chunks[$i + 1][0];
+                $name2 = $chunks[$i + 1][1];
+                if ( ( $count2 = floor( ( $since - ( $seconds * $count ) ) / $seconds2 ) ) != 0 ) {
+                    $output .= ($count2 == 1) ? ', 1 '.$name2 : &quot;, $count2 {$name2}s&quot;;
+                }
+            }
+
+            // Return the output
+            return $output . ' ' . t('ago');
+
+        }
+
+    }
+
+    /**
+     *	This class uses the HTTP_USER_AGENT varaible to get information about the browser the visitor used to perform
+     *	the request. We determine the browser name, the version and the platform it's running on.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDBrowserInfo extends YDBase {
+
+        /**
+         *	The class constructor analyzes for the YDBrowserInfo class. The constructor takes no arguments and uses the
+         *	$_SERVER['HTTP_USER_AGENT'] variable to parse the browser info.
+         */
+        function YDBrowserInfo() {
+
+            // Initialize YDBase
+            $this-&gt;YDBase();
+
+            // The matching list for browsers
+            $browsers = array(
+                'bot'       =&gt; array( 'bot', 'Yahoo! Slurp', 'crawler', 'scooter', 'mercator', 'altavista', 'Gulliver', 'spider', 'Ask Jeeves' ),
+                'opera'     =&gt; array( 'opera' ),
+                'ie'        =&gt; array( 'msie' ),
+                'safari'    =&gt; array( 'safari' ),
+                'konqueror' =&gt; array( 'Konqueror' ),
+                'feed'      =&gt; array( 'feed', 'rss', 'synd', 'bloglines', 'newsgator' ),
+                'mozilla'   =&gt; array( 'mozilla', 'firefox' ),
+            );
+
+            // The matching list for platforms
+            $platforms = array(
+                'win'       =&gt; array( 'win' ),
+                'mac'       =&gt; array( 'mac', 'apple' ),
+                'linux'     =&gt; array( 'linux', 'bsd' ),
+                'unix'      =&gt; array( 'unix', 'sun', 'risc', 'aix' ),
+                'bot'       =&gt; array( 'bot', 'Yahoo! Slurp', 'crawler' ),
+                'feed'      =&gt; array( 'feed', 'rss', 'synd', 'bloglines', 'newsgator' ),
+            );
+
+            // Mark everything as unknown
+            $this-&gt;agent = 'unknown';
+            $this-&gt;browser = 'unknown';
+            $this-&gt;platform = 'unknown';
+            $this-&gt;dotnet = 'unknown';
+
+            // Check if the user agent was specified
+            if ( isset( $_SERVER['HTTP_USER_AGENT'] ) ) {
+
+                // Get the user agent
+                $this-&gt;agent = $_SERVER['HTTP_USER_AGENT'];
+
+                // Get the browser name
+                foreach ( $browsers as $browser =&gt; $browserpatterns ) {
+                    foreach ( $browserpatterns as $browserpattern ) {
+                        if ( stristr( $this-&gt;agent, $browserpattern ) ) {
+                            $this-&gt;browser = $browser;
+                            continue;
+                        }
+                    }
+                    if ( $this-&gt;browser != 'unknown' ) {
+                        break;
+                    }
+                }
+
+                // Get the browser name
+                foreach ( $platforms as $platform =&gt; $platformpatterns ) {
+                    foreach ( $platformpatterns as $platformpattern ) {
+                        if ( stristr( $this-&gt;agent, $platformpattern ) ) {
+                            $this-&gt;platform = $platform;
+                            continue;
+                        }
+                    }
+                    if ( $this-&gt;platform != 'unknown' ) {
+                        break;
+                    }
+                }
+
+                // Get the .NET runtime version
+                preg_match_all( '/.NET CLR ([0-9][.][0-9])/i', $this-&gt;agent, $ver );
+                $this-&gt;dotnet = $ver[1];
+
+            }
+
+        }
+
+        /**
+         *  Get the hostname of the client computer.
+         *
+         *  @returns The hostname of the client computer in lowercase.
+         *
+         *  @static
+         */
+        function getComputerName() {
+            return strtolower( gethostbyaddr( $_SERVER['REMOTE_ADDR'] ) );
+        }
+
+        /**
+         *	This function returns an array with the languages that are supported by the browser. This is done by using
+         *	the HTTP_ACCEPT_LANGUAGE server variable that gets send with the HTTP headers.
+         *
+         *	@return Array containing the list of supported languages
+         */
+        function getBrowserLanguages() {
+
+            // We parse the language headers sent by the browser
+            if ( ! isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
+                return array();
+            }
+            $browserLanguages = explode( ',', $_SERVER['HTTP_ACCEPT_LANGUAGE'] );
+
+            // Normalize the browser language headers
+            for ( $i = 0; $i &lt; sizeof( $browserLanguages ); $i++ ) {
+                $browserLanguage = explode( ';', $browserLanguages[$i] );
+                $browserLanguages[$i] = substr( $browserLanguage[0], 0, 2 );
+            }
+
+            // Remove the duplicates
+            $browserLanguages = array_unique( $browserLanguages );
+
+            // Return the browser languages
+            return array_map( 'strtolower', array_values( $browserLanguages ) );
+
+        }
+
+        /**
+         *  This function returns an array with the languages that are supported by the browser and also interprets the
+         *  country information that the browser sends over.. This is done by using the HTTP_ACCEPT_LANGUAGE server
+         *  variable that gets send with the HTTP headers.
+         *
+         *  @return Array containing the list of supported languages
+         */
+        function getBrowserLanguagesAndCountries() {
+
+            // We parse the language headers sent by the browser
+            if ( !isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
+                return array();
+            }
+            $browserCountries = explode( ',', $_SERVER['HTTP_ACCEPT_LANGUAGE'] );
+            $languagesAndCountries = array();
+
+            // Loop over the languages and normalize them
+            foreach( $browserCountries as $value ) {
+                $lang = explode( ';', $value );
+                $lang = explode( '-', $lang[0] );
+                $lang[1] = ( isset( $lang[1] ) &amp;&amp; $lang[1] != '' ? $lang[1] : $lang[0] );
+                $languagesAndCountries[][ $lang[1] ] = $lang[0];
+            }
+
+            // Return the normalized list
+            return $languagesAndCountries;
+
+        }
+
+        /**
+         *	This function will get the most appropriate language for the browser, considering the list of supported
+         *	languages by both the browser and the web application.
+         *
+         *	@param $supported	(optional) An array with the list of supported languages. By default, only english is
+         *						supported.
+         */
+        function getLanguage( $supported=array( 'en' ) ) {
+
+            // Start with the default language
+            $language = $supported[0];
+
+            // Get the list of languages supported by the browser
+            $browserLanguages = $this-&gt;getBrowserLanguages();
+
+            // Now, we look if the browser specified one
+            if ( isset( $_SERVER['HTTP_ACCEPT_LANGUAGE'] ) ) {
+                foreach ( $browserLanguages as $browserLanguage ) {
+                    if ( in_array( $browserLanguage, $supported ) ) {
+                        $language = $browserLanguage;
+                        break;
+                    }
+                }
+            }
+
+            // Return the language
+            return $language;
+
+        }
+
+    }
+
+    /**
+     *  This class allows you to generate GUIDs (global unique identifier).
+     *
+     *  More info: <A HREF="http://www.ietf.org/rfc/rfc4122.txt">http://www.ietf.org/rfc/rfc4122.txt</A>
+     *
+     *  @ingroup YDFramework
+     */
+    class YDGuidUtil extends YDBase {
+
+        /**
+         *  Generate a new GUID.
+         *
+         *  @returns    A new GUID as a string.
+         */
+        function create() {
+            return md5( uniqid( rand(), true ) . $_SERVER['SERVER_NAME'] . $_SERVER['SERVER_ADDR'] );
+        }
+
+        /**
+         *  Generate a new formatted GUID.
+         *
+         *  @returns    A formatted GUID as a string.
+         */
+        function createFormatted() {
+            return YDGuidUtil::format( YDGuidUtil::create() );
+        }
+
+        /**
+         *  Formats a GUID.
+         *
+         *  @param $g    GUID to format.
+         *
+         *  @returns    A formatted GUID as a string.
+         */
+         function format( $g ) {
+            $g = str_replace( '-', '', $g );
+            return sprintf(
+                '%s-%s-%s-%s-%s',
+                substr( $g, 0, 8 ), substr( $g, 8, 4 ), substr( $g, 12, 4 ), substr( $g, 16, 4 ), substr( $g, 20 )
+            );
+         }
+
+    }
+
+    /**
+     *  This class allows you to perform LDAP releated tasks.
+     *
+     *  @ingroup YDFramework
+     */
+    class YDLdapUtil extends YDBase {
+
+        /**
+         *  Authenticate against a domain.
+         *
+         *  @param  $server     The name of the domain controller.
+         *  @param  $domain     The name of the domain.
+         *  @param  $user       The username.
+         *  @param  $password   The password.
+         *
+         *  @returns    A boolean indicating if the user was authenticated or not.
+         */
+        function authenticate( $server, $domain, $user, $password ) {
+
+            // Connect to the LDAP server
+            $conn = ldap_connect( $server );
+
+            // Setup the options
+            ldap_set_option( $conn, LDAP_OPT_PROTOCOL_VERSION, 3 );
+            ldap_set_option( $conn, LDAP_OPT_REFERRALS, 0 );
+
+            // Require a username
+            if ( empty( $user ) || empty( $pass ) ) {
+                return false;
+            }
+
+            // Fix the username
+            $user = strtolower( trim( $user ) );
+            if ( strpos( $user, '\\' ) ) {
+                $user = substr( $user, strpos( $user, '\\' ) + 1 );
+            }
+
+            // Authenticate
+            $result = @ldap_bind( $conn, $user . '@' . $server, $password );
+
+            // Close the connection
+            ldap_close( $conn );
+
+            // Return the result
+            return ( $result ) ? true : false;
+
+        }
+
+    }
+
+?&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001006.html">[ydf-devel] r2412 - YDFramework2.0/trunk/YDFramework2/YDClasses
</A></li>
	<LI>Next message: <A HREF="001008.html">[ydf-devel] r2414 -	YDFramework2.0/trunk/YDFramework2/addons/YDDatabaseObjectTree
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1007">[ date ]</a>
              <a href="thread.html#1007">[ thread ]</a>
              <a href="subject.html#1007">[ subject ]</a>
              <a href="author.html#1007">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/ydframework-devel">More information about the YDFramework-devel
mailing list</a><br>
</body></html>
