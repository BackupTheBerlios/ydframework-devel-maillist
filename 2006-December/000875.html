<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ydf-devel] r2283 - in YDFramework2.0/trunk/examples/weblog:	include include/Bad-Behavior	include/Bad-Behavior/bad-behavior include/languages manage	skins/default skins/default_with_lightbox
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/ydframework-devel/2006-December/index.html" >
   <LINK REL="made" HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2283%20-%20in%20YDFramework2.0/trunk/examples/weblog%3A%0A%09include%20include/Bad-Behavior%0A%09include/Bad-Behavior/bad-behavior%20include/languages%20manage%0A%09skins/default%20skins/default_with_lightbox&In-Reply-To=%3C200612302122.kBULMGYt018822%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000874.html">
   <LINK REL="Next"  HREF="000876.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ydf-devel] r2283 - in YDFramework2.0/trunk/examples/weblog:	include include/Bad-Behavior	include/Bad-Behavior/bad-behavior include/languages manage	skins/default skins/default_with_lightbox</H1>
    <B>pclaerhout at BerliOS</B> 
    <A HREF="mailto:ydframework-devel%40lists.berlios.de?Subject=Re%3A%20%5Bydf-devel%5D%20r2283%20-%20in%20YDFramework2.0/trunk/examples/weblog%3A%0A%09include%20include/Bad-Behavior%0A%09include/Bad-Behavior/bad-behavior%20include/languages%20manage%0A%09skins/default%20skins/default_with_lightbox&In-Reply-To=%3C200612302122.kBULMGYt018822%40sheep.berlios.de%3E"
       TITLE="[ydf-devel] r2283 - in YDFramework2.0/trunk/examples/weblog:	include include/Bad-Behavior	include/Bad-Behavior/bad-behavior include/languages manage	skins/default skins/default_with_lightbox">pclaerhout at mail.berlios.de
       </A><BR>
    <I>Sat Dec 30 22:22:16 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000874.html">[ydf-devel] r2282 - YDFramework2.0/trunk/examples/weblog/include
</A></li>
        <LI>Next message: <A HREF="000876.html">[ydf-devel] r2284 - YDFramework2.0/trunk/examples/weblog/include
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#875">[ date ]</a>
              <a href="thread.html#875">[ thread ]</a>
              <a href="subject.html#875">[ subject ]</a>
              <a href="author.html#875">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pclaerhout
Date: 2006-12-30 22:22:13 +0100 (Sat, 30 Dec 2006)
New Revision: 2283

Added:
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/README.txt
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-generic.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-lifetype.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-mediawiki.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-wordpress.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-ydweblog.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/admin.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/banned.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blackhole.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blacklist.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/common_tests.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/core.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/functions.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/google.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/housekeeping.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/index.html
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/konqueror.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/lynx.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/movabletype.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/mozilla.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msie.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msnbot.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/opera.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/post.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/responses.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/safari.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/screener.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/trackback.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/version.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/whitelist.inc.php
   YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/index.html
   YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.php
   YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.tpl
Modified:
   YDFramework2.0/trunk/examples/weblog/include/YDWeblogAPI.php
   YDFramework2.0/trunk/examples/weblog/include/YDWeblogRequest.php
   YDFramework2.0/trunk/examples/weblog/include/YDWeblog_init.php
   YDFramework2.0/trunk/examples/weblog/include/languages/language_en.php
   YDFramework2.0/trunk/examples/weblog/include/languages/language_nl.php
   YDFramework2.0/trunk/examples/weblog/manage/__mng_header.tpl
   YDFramework2.0/trunk/examples/weblog/skins/default/__std_header.tpl
   YDFramework2.0/trunk/examples/weblog/skins/default_with_lightbox/__std_header.tpl
Log:
Added support for bad behaviour
(see also: <A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>)

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/README.txt
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/README.txt	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/README.txt	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,28 @@
+=== Bad Behavior ===
+Tags: comment,trackback,referrer,spam,robot,antispam
+Contributors: MichaelHampton,MarkJaquith,FirasDurri,AndySkelton
+
+Bad Behavior is a set of PHP scripts which prevents spambots and other
+malicious accesses to your PHP-based Web site. It prevents comment spam,
+trackback spam, guestbook spam, wiki spam, referrer spam, and some types
+of malicious Web site hacking.
+
+== Installation ==
+
+Bad Behavior has been designed to install on each host software in the
+manner most appropriate to each platform. It's usually sufficient to
+follow the generic instructions for installing any plugin or extension
+for your host software.
+
+For complete documentation and installation instructions, please visit
+<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>
+
+== Release Notes ==
+
+= Bad Behavior 2.0 Known Issues =
+
+On WordPress when WP-Cache 2 is enabled, Bad Behavior requires a patch to
+WP-Cache 2 in order to protect cached pages. The patch is available in
+the installation instructions.
+
+Bad Behavior may be unable to protect cached pages on MediaWiki.

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/admin.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/admin.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/admin.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,75 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+function bb2_admin_pages() {
+	if (function_exists('current_user_can')) {
+		// The new 2.x way
+		if (current_user_can('manage_options')) {
+			$bb2_is_admin = true;
+		}
+	} else {
+		// The old 1.x way
+		global $user_ID;
+		if (user_can_edit_user($user_ID, 0)) {
+			$bb2_is_admin = true;
+		}
+	}
+
+	if ($bb2_is_admin) {
+		add_options_page(__(&quot;Bad Behavior&quot;), __(&quot;Bad Behavior&quot;), 8, 'bb2_options', 'bb2_options');
+	}
+}
+
+function bb2_options()
+{
+	$settings = bb2_read_settings();
+
+	if ($_POST) {
+		if ($_POST['display_stats']) {
+			$settings['display_stats'] = true;
+		} else {
+			$settings['display_stats'] = false;
+		}
+		if ($_POST['strict']) {
+			$settings['strict'] = true;
+		} else {
+			$settings['strict'] = false;
+		}
+		if ($_POST['verbose']) {
+			$settings['verbose'] = true;
+		} else {
+			$settings['verbose'] = false;
+		}
+		bb2_write_settings($settings);
+?&gt;
+	&lt;div id=&quot;message&quot; class=&quot;updated fade&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;?php _e('Options saved.') ?&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;?php
+	}
+?&gt;
+	&lt;div class=&quot;wrap&quot;&gt;
+	&lt;h2&gt;&lt;?php _e(&quot;Bad Behavior&quot;); ?&gt;&lt;/h2&gt;
+	&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER['REQUEST_URI']; ?&gt;&quot;&gt;
+	&lt;p&gt;For more information please visit the &lt;a href=&quot;<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>&quot;&gt;Bad Behavior&lt;/a&gt; homepage.&lt;/p&gt;
+	&lt;p&gt;If you find Bad Behavior valuable, please consider making a &lt;a href=&quot;<A HREF="https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=error%40ioerror%2eus&amp;item_name=Bad%20Behavior%20&lt;?php">https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&amp;business=error%40ioerror%2eus&amp;item_name=Bad%20Behavior%20&lt;?php</A> echo BB2_VERSION; ?&gt;%20%28From%20Admin%29&amp;no_shipping=1&amp;cn=Comments%20about%20Bad%20Behavior&amp;tax=0&amp;currency_code=USD&amp;bn=PP%2dDonationsBF&amp;charset=UTF%2d8&quot;&gt;financial contribution&lt;/a&gt; to further development of Bad Behavior.&lt;/p&gt;
+
+	&lt;fieldset class=&quot;options&quot;&gt;
+	&lt;legend&gt;&lt;?php _e('Statistics'); ?&gt;&lt;/legend&gt;
+	&lt;?php bb2_insert_stats(true); ?&gt;
+	&lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;display_stats&quot; value=&quot;true&quot; &lt;?php if ($settings['display_stats']) { ?&gt;checked=&quot;checked&quot; &lt;?php } ?&gt;/&gt; &lt;?php _e('Display statistics in blog footer'); ?&gt;&lt;/label&gt;&lt;/p&gt;
+	&lt;/fieldset&gt;
+
+	&lt;fieldset class=&quot;options&quot;&gt;
+	&lt;legend&gt;&lt;?php _e('Logging'); ?&gt;&lt;/legend&gt;
+	&lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;verbose&quot; value=&quot;true&quot; &lt;?php if ($settings['verbose']) { ?&gt;checked=&quot;checked&quot; &lt;?php } ?&gt;/&gt; &lt;?php _e('Verbose HTTP request logging'); ?&gt;&lt;/label&gt;&lt;/p&gt;
+	&lt;legend&gt;&lt;?php _e('Strict Mode'); ?&gt;&lt;/legend&gt;
+	&lt;p&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;strict&quot; value=&quot;true&quot; &lt;?php if ($settings['strict']) { ?&gt;checked=&quot;checked&quot; &lt;?php } ?&gt;/&gt; &lt;?php _e('Strict checking (blocks more spam but may block some people)'); ?&gt;&lt;/label&gt;&lt;/p&gt;
+	&lt;/fieldset&gt;
+
+	&lt;p class=&quot;submit&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;&lt;?php _e('Update &raquo;'); ?&gt;&quot; /&gt;&lt;/p&gt;
+	&lt;/form&gt;
+	&lt;/div&gt;
+&lt;?php
+}
+
+add_action('admin_menu', 'bb2_admin_pages');
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/banned.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/banned.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/banned.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,48 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Functions called when a request has been denied
+// This part can be gawd-awful slow, doesn't matter :)
+
+require_once(BB2_CORE . &quot;/responses.inc.php&quot;);
+
+function bb2_display_denial($settings, $key, $previous_key = false)
+{
+	if (!$previous_key) $previous_key = $key;
+	if ($key == &quot;e87553e1&quot;) {
+		// FIXME: lookup the real key
+	}
+	// Create support key
+	$ip = explode(&quot;.&quot;, $_SERVER['REMOTE_ADDR']);
+	$ip_hex = &quot;&quot;;
+	foreach ($ip as $octet) {
+		$ip_hex .= str_pad(dechex($octet), 2, 0, STR_PAD_LEFT);
+	}
+	$support_key = implode(&quot;-&quot;, str_split(&quot;$ip_hex$key&quot;, 4));
+
+	// Get response data
+	$response = bb2_get_response($previous_key);
+	header(&quot;HTTP/1.1 &quot; . $response['response'] . &quot; Bad Behavior&quot;);
+	header(&quot;Status: &quot; . $response['response'] . &quot; Bad Behavior&quot;);
+?&gt;
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;
+&lt;head&gt;
+&lt;title&gt;HTTP Error &lt;?php echo $response['response']; ?&gt;&lt;/title&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;h1&gt;Error &lt;?php echo $response['response']; ?&gt;&lt;/h1&gt;
+&lt;p&gt;We're sorry, but we could not fulfill your request for
+&lt;?php echo htmlspecialchars($_SERVER['REQUEST_URI']) ?&gt; on this server.&lt;/p&gt;
+&lt;p&gt;&lt;?php echo $response['explanation']; ?&gt;&lt;/p&gt;
+&lt;p&gt;Your technical support key is: &lt;strong&gt;&lt;?php echo $support_key; ?&gt;&lt;/strong&gt;&lt;/p&gt;
+&lt;p&gt;You can use this key to &lt;a href=&quot;<A HREF="http://www.ioerror.us/bb2-support-key?key=&lt;?php">http://www.ioerror.us/bb2-support-key?key=&lt;?php</A> echo $support_key; ?&gt;&quot;&gt;fix this problem yourself&lt;/a&gt;.&lt;/p&gt;
+&lt;p&gt;If you are unable to fix the problem yourself, please contact &lt;a href=&quot;mailto:&lt;?php echo htmlspecialchars(str_replace(&quot;@&quot;, &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">+nospam at nospam.</A>&quot;, bb2_email())); ?&gt;&quot;&gt;&lt;?php echo htmlspecialchars(str_replace(&quot;@&quot;, &quot; at &quot;, bb2_email())); ?&gt;&lt;/a&gt; and be sure to provide the technical support key shown above.&lt;/p&gt;
+&lt;?php
+}
+
+function bb2_log_denial($settings, $package, $key, $previous_key=false)
+{
+	bb2_db_query(bb2_insert($settings, $package, $key));
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blackhole.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blackhole.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blackhole.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,37 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Look up address on various blackhole lists.
+// These cannot be used for GET requests under any circumstances!
+function bb2_blackhole($package) {
+	// Only conservative lists
+	$bb2_blackhole_lists = array(
+		&quot;sbl-xbl.spamhaus.org&quot;,	// All around nasties
+//		&quot;dnsbl.sorbs.net&quot;,	// Old useless data.
+//		&quot;list.dsbl.org&quot;,	// Old useless data.
+		&quot;dnsbl.ioerror.us&quot;,	// Bad Behavior Blackhole
+	);
+	
+	// Things that shouldn't be blocked, from aggregate lists
+	$bb2_blackhole_exceptions = array(
+		&quot;sbl-xbl.spamhaus.org&quot; =&gt; array(&quot;127.0.0.4&quot;),	// CBL is problematic
+		&quot;dnsbl.sorbs.net&quot; =&gt; array(&quot;127.0.0.10&quot;,),	// Dynamic IPs only
+		&quot;list.dsbl.org&quot; =&gt; array(),
+		&quot;dnsbl.ioerror.us&quot; =&gt; array(),
+	);
+
+	// Check the blackhole lists
+	$ip = $package['ip'];
+	$find = implode('.', array_reverse(explode('.', $ip)));
+	foreach ($bb2_blackhole_lists as $dnsbl) {
+		$result = gethostbynamel($find . &quot;.&quot; . $dnsbl . &quot;.&quot;);
+		if (!empty($result)) {
+			// Got a match and it isn't on the exception list
+			$result = @array_diff($result, $bb2_blackhole_exceptions[$dnsbl]);
+			if (!empty($result)) {
+				return '136673cd';
+			}
+		}
+	}
+	return false;
+}
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blacklist.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blacklist.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/blacklist.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,106 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+function bb2_blacklist($package) {
+
+	// Blacklisted user agents
+	// These user agent strings occur at the beginning of the line.
+	$bb2_spambots_0 = array(
+		&quot;&lt;sc&quot;,			// XSS exploit attempts
+		&quot;8484 Boston Project&quot;,	// video poker/porn spam
+		&quot;adwords&quot;,		// referrer spam
+		&quot;autoemailspider&quot;,	// spam harvester
+		&quot;blogsearchbot-martin&quot;,	// from honeypot
+		&quot;Digger&quot;,		// spam harvester
+		&quot;ecollector&quot;,		// spam harvester
+		&quot;EmailCollector&quot;,	// spam harvester
+		&quot;Email Extractor&quot;,	// spam harvester
+		&quot;Email Siphon&quot;,		// spam harvester
+		&quot;EmailSiphon&quot;,		// spam harvester
+		&quot;grub crawler&quot;,		// misc comment/email spam
+		&quot;HttpProxy&quot;,		// misc comment/email spam
+		&quot;Internet Explorer&quot;,	// XMLRPC exploits seen
+		&quot;Jakarta Commons&quot;,	// custommised spambots
+		&quot;Java 1.&quot;,		// definitely a spammer
+		&quot;Java/1.&quot;,		// definitely a spammer
+		&quot;libwww-perl&quot;,		// spambot scripts
+		&quot;LWP&quot;,			// spambot scripts
+		&quot;Microsoft URL&quot;,	// spam harvester
+		&quot;Missigua&quot;,		// spam harvester
+		&quot;Movable Type&quot;,		// customised spambots
+		&quot;Mozilla &quot;,		// malicious software
+		&quot;Mozilla/4.0(&quot;,		// from honeypot
+		&quot;Mozilla/4.0+(&quot;,	// suspicious harvester
+		&quot;MSIE&quot;,			// malicious software
+		&quot;OmniExplorer&quot;,		// spam harvester
+		&quot;PussyCat &quot;,		// misc comment spam
+		&quot;psycheclone&quot;,		// spam harvester
+		&quot;Shockwave Flash&quot;,	// spam harvester
+		&quot;User Agent: &quot;,		// spam harvester
+		&quot;User-Agent: &quot;,		// spam harvester
+		&quot;Wordpress Hash Grabber&quot;,// malicious software
+		&quot;\&quot;&quot;,			// malicious software
+	);
+
+	// These user agent strings occur anywhere within the line.
+	$bb2_spambots = array(
+		&quot;\r&quot;,			// A really dumb bot
+		&quot;; Widows &quot;,		// misc comment/email spam
+		&quot;a href=&quot;,		// referrer spam
+		&quot;Bad Behavior Test&quot;,	// Add this to your user-agent to test BB
+		&quot;compatible ; MSIE&quot;,	// misc comment/email spam
+		&quot;compatible-&quot;,		// misc comment/email spam
+		&quot;DTS Agent&quot;,		// misc comment/email spam
+		&quot;Gecko/25&quot;,		// revisit this in 500 years
+		&quot;grub-client&quot;,		// search engine ignores robots.txt
+		&quot;hanzoweb&quot;,		// very badly behaved crawler
+		&quot;Indy Library&quot;,		// misc comment/email spam
+		&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">larbin at unspecified</A>&quot;,	// stealth harvesters
+		&quot;Murzillo compatible&quot;,	// comment spam bot
+		&quot;.NET CLR 1)&quot;,		// free poker, etc.
+		&quot;POE-Component-Client&quot;,	// free poker, etc.
+		&quot;Turing Machine&quot;,	// www.anonymizer.com abuse
+		&quot;WISEbot&quot;,		// spam harvester
+		&quot;WISEnutbot&quot;,		// spam harvester
+		&quot;Windows NT 4.0;)&quot;,	// wikispam bot
+		&quot;Windows NT 5.0;)&quot;,	// wikispam bot
+		&quot;Windows NT 5.1;)&quot;,	// wikispam bot
+		&quot;Windows XP 5&quot;,		// spam harvester
+		&quot;\\\\)&quot;,		// spam harvester
+	);
+
+	// These are regular expression matches.
+	$bb2_spambots_regex = array(
+		&quot;/^[A-Z]{10}$/&quot;,	// misc email spam
+		&quot;/^Mozilla...[05]$/i&quot;,	// fake user agent/email spam
+		&quot;/[bcdfghjklmnpqrstvwxz ]{8,}/&quot;,
+//		&quot;/(;\){1,2}$/&quot;,		// misc spammers/harvesters
+//		&quot;/MSIE.*Windows XP/&quot;,	// misc comment spam
+	);
+
+	// Do not edit below this line.
+
+	$ua = $package['headers_mixed']['User-Agent'];
+
+	foreach ($bb2_spambots_0 as $spambot) {
+		$pos = stripos($ua, $spambot);
+		if ($pos !== FALSE &amp;&amp; $pos == 0) {
+			return &quot;17f4e8c8&quot;;
+		}
+	}
+
+	foreach ($bb2_spambots as $spambot) {
+		if (stripos($ua, $spambot) !== FALSE) {
+			return &quot;17f4e8c8&quot;;
+		}
+	}
+
+	foreach ($bb2_spambots_regex as $spambot) {
+		if (preg_match($spambot, $ua)) {
+			return &quot;17f4e8c8&quot;;
+		}
+	}
+
+	return FALSE;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/common_tests.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/common_tests.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/common_tests.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,113 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Enforce adherence to protocol version claimed by user-agent.
+
+function bb2_protocol($settings, $package)
+{
+	// Is it claiming to be HTTP/1.0?  Then it shouldn't do HTTP/1.1 things
+	// Always run this test; we should never see Expect:
+	if (array_key_exists('Expect', $package['headers_mixed']) &amp;&amp; stripos($package['headers_mixed']['Expect'], &quot;100-continue&quot;) !== FALSE) {
+		return &quot;a0105122&quot;;
+	}
+
+	// Is it claiming to be HTTP/1.1?  Then it shouldn't do HTTP/1.0 things
+	// Blocks some common corporate proxy servers in strict mode
+	if ($settings['strict'] &amp;&amp; !strcmp($package['server_protocol'], &quot;HTTP/1.1&quot;)) {
+		if (array_key_exists('Pragma', $package['headers_mixed']) &amp;&amp; strpos($package['headers_mixed']['Pragma'], &quot;no-cache&quot;) !== FALSE &amp;&amp; !array_key_exists('Cache-Control', $package['headers_mixed'])) {
+			return &quot;41feed15&quot;;
+		}
+	}
+	return false;
+}
+
+function bb2_misc_headers($settings, $package)
+{
+	$ua = $package['headers_mixed']['User-Agent'];
+
+	if (!strcmp($package['request_method'], &quot;POST&quot;) &amp;&amp; empty($ua)) {
+		return &quot;f9f2b8b9&quot;;
+	}
+
+	// Broken spambots send URLs with various invalid characters
+	if (strpos($package['request_uri'], &quot;#&quot;) !== FALSE || strpos($package['headers_mixed']['Referer'], &quot;#&quot;) !== FALSE) {
+		return &quot;dfd9b1ad&quot;;
+	}
+
+	// Range: field exists and begins with 0
+	// Real user-agents do not start ranges at 0
+	// NOTE: this blocks the whois.sc bot. No big loss.
+	if (array_key_exists('Range', $package['headers_mixed']) &amp;&amp; strpos($package['headers_mixed']['Range'], &quot;=0-&quot;) !== FALSE) {
+		if (strncmp($ua, &quot;MovableType&quot;, 11)) {
+			return &quot;7ad04a8a&quot;;
+		}
+	}
+
+	// Content-Range is a response header, not a request header
+	if (array_key_exists('Content-Range', $package['headers_mixed'])) {
+		return '7d12528e';
+	}
+
+	// Lowercase via is used by open proxies/referrer spammers
+	if (array_key_exists('via', $package['headers'])) {
+		return &quot;9c9e4979&quot;;
+	}
+
+	// pinappleproxy is used by referrer spammers
+	if (array_key_exists('Via', $package['headers_mixed'])) {
+		if (stripos($package['headers_mixed']['Via'], &quot;pinappleproxy&quot;) !== FALSE || stripos($package['headers_mixed']['Via'], &quot;PCNETSERVER&quot;) !== FALSE || stripos($package['headers_mixed']['Via'], &quot;Invisiware&quot;) !== FALSE) {
+			return &quot;939a6fbb&quot;;
+		}
+	}
+
+	// TE: if present must have Connection: TE
+	// RFC 2616 14.39
+	// Blocks Microsoft ISA Server 2004 in strict mode. Contact Microsoft
+	// to obtain a hotfix.
+	if ($settings['strict'] &amp;&amp; array_key_exists('Te', $package['headers_mixed'])) {
+		if (!preg_match('/\bTE\b/', $package['headers_mixed']['Connection'])) {
+			return &quot;582ec5e4&quot;;
+		}
+	}
+
+	if (array_key_exists('Connection', $package['headers_mixed'])) {
+		// Connection: keep-alive and close are mutually exclusive
+		if (preg_match('/\bKeep-Alive\b/i', $package['headers_mixed']['Connection']) &amp;&amp; preg_match('/\bClose\b/i', $package['headers_mixed']['Connection'])) {
+			return &quot;a52f0448&quot;;
+		}
+		// Close shouldn't appear twice
+		if (preg_match('/\bclose,\s?close\b/i', $package['headers_mixed']['Connection'])) {
+			return &quot;a52f0448&quot;;
+		}
+		// Keey-Alive shouldn't appear twice either
+		if (preg_match('/\bkeep-alive,\s?keep-alive\b/i', $package['headers_mixed']['Connection'])) {
+			return &quot;a52f0448&quot;;
+		}
+	}
+	
+
+	// Headers which are not seen from normal user agents; only malicious bots
+	if (array_key_exists('X-Aaaaaaaaaaaa', $package['headers_mixed']) || array_key_exists('X-Aaaaaaaaaa', $package['headers_mixed'])) {
+		return &quot;b9cc1d86&quot;;
+	}
+	if (array_key_exists('Proxy-Connection', $package['headers_mixed'])) {
+		return &quot;b7830251&quot;;
+	}
+
+	if (array_key_exists('Referer', $package['headers_mixed'])) {
+		// Referer, if it exists, must not be blank
+		if (empty($package['headers_mixed'])) {
+			return &quot;69920ee5&quot;;
+		}
+
+		// Referer, if it exists, must contain a :
+		// While a relative URL is technically valid in Referer, all known
+		// legit user-agents send an absolute URL
+		if (strpos($package['headers_mixed']['Referer'], &quot;:&quot;) === FALSE) {
+			return &quot;45b35e30&quot;;
+		}
+	}
+	
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/core.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/core.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/core.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,203 @@
+&lt;?php if (!defined('BB2_CWD')) die(&quot;I said no cheating!&quot;);
+
+// Bad Behavior entry point is start_bad_behavior().
+// If you're reading this, you are probably lost.
+// Go read the bad-behavior-generic.php file.
+
+define('BB2_CORE', dirname(__FILE__));
+define('BB2_COOKIE', 'bb2_screener_');
+
+require_once(BB2_CORE . &quot;/functions.inc.php&quot;);
+
+// Our log table structure
+function bb2_table_structure($name)
+{
+	// It's not paranoia if they really are out to get you.
+	$name_escaped = bb2_db_escape($name);
+	return &quot;CREATE TABLE IF NOT EXISTS `$name_escaped` (
+		`id` INT(11) NOT NULL auto_increment,
+		`ip` TEXT NOT NULL,
+		`date` DATETIME NOT NULL default '0000-00-00 00:00:00',
+		`request_method` TEXT NOT NULL,
+		`request_uri` TEXT NOT NULL,
+		`server_protocol` TEXT NOT NULL,
+		`http_headers` TEXT NOT NULL,
+		`user_agent` TEXT NOT NULL,
+		`request_entity` TEXT NOT NULL,
+		`key` TEXT NOT NULL,
+		INDEX (`ip`(15)),
+		INDEX (`user_agent`(10)),
+		PRIMARY KEY (`id`) );&quot;;	// TODO: INDEX might need tuning
+}
+
+// Insert a new record
+function bb2_insert($settings, $package, $key)
+{
+	$ip = bb2_db_escape($package['ip']);
+	$date = bb2_db_date();
+	$request_method = bb2_db_escape($package['request_method']);
+	$request_uri = bb2_db_escape($package['request_uri']);
+	$server_protocol = bb2_db_escape($package['server_protocol']);
+	$user_agent = bb2_db_escape($package['user_agent']);
+	$headers = &quot;$request_method $request_uri $server_protocol\n&quot;;
+	foreach ($package['headers'] as $h =&gt; $v) {
+		$headers .= bb2_db_escape(&quot;$h: $v\n&quot;);
+	}
+	$request_entity = &quot;&quot;;
+	if (!strcasecmp($request_method, &quot;POST&quot;)) {
+		foreach ($package['request_entity'] as $h =&gt; $v) {
+			$request_entity .= bb2_db_escape(&quot;$h: $v\n&quot;);
+		}
+	}
+	return &quot;INSERT INTO `&quot; . bb2_db_escape($settings['log_table']) . &quot;`
+		(`ip`, `date`, `request_method`, `request_uri`, `server_protocol`, `http_headers`, `user_agent`, `request_entity`, `key`) VALUES
+		('$ip', '$date', '$request_method', '$request_uri', '$server_protocol', '$headers', '$user_agent', '$request_entity', '$key')&quot;;
+}
+
+// Kill 'em all!
+function bb2_banned($settings, $package, $key, $previous_key=false)
+{
+	// Some spambots hit too hard. Slow them down a bit.
+	sleep(2);
+
+	require_once(BB2_CORE . &quot;/banned.inc.php&quot;);
+	bb2_display_denial($settings, $key, $previous_key);
+	bb2_log_denial($settings, $package, $key, $previous_key);
+	if (is_callable('bb2_banned_callback')) {
+		bb2_banned_callback($settings, $package, $key);
+	}
+	// Penalize the spammers some more
+	require_once(BB2_CORE . &quot;/housekeeping.inc.php&quot;);
+	bb2_housekeeping($settings, $package);
+	die();
+}
+
+function bb2_approved($settings, $package)
+{
+	// Dirk wanted this
+	if (is_callable('bb2_approved_callback')) {
+		bb2_approved_callback($settings, $package);
+	}
+
+	// Decide what to log on approved requests.
+	if ($settings['verbose'] || empty($package['user_agent'])) {
+		bb2_db_query(bb2_insert($settings, $package, &quot;00000000&quot;));
+	}
+}
+
+// Check the results of a particular test; see below for usage
+// Returns FALSE if test passed (yes this is backwards)
+function bb2_test($settings, $package, $result)
+{
+	if ($result !== FALSE)
+	{
+		bb2_banned($settings, $package, $result);
+		return TRUE;
+	}
+	return FALSE;
+}
+
+
+// Let God sort 'em out!
+function bb2_start($settings)
+{
+	// Gather up all the information we need, first of all.
+	$headers = bb2_load_headers();
+	// Postprocess the headers to mixed-case
+	// FIXME: get the world to stop using PHP as CGI
+	$headers_mixed = array();
+	foreach ($headers as $h =&gt; $v) {
+		$headers_mixed[uc_all($h)] = $v;
+	}
+
+	// We use these frequently. Keep a copy close at hand.
+	$ip = $_SERVER['REMOTE_ADDR'];
+	$request_method = $_SERVER['REQUEST_METHOD'];
+	$request_uri = $_SERVER['REQUEST_URI'];
+	$server_protocol = $_SERVER['SERVER_PROTOCOL'];
+	$user_agent = $_SERVER['HTTP_USER_AGENT'];
+
+	// Reconstruct the HTTP entity, if present.
+	$request_entity = array();
+	if (!strcasecmp($request_method, &quot;POST&quot;) || !strcasecmp($request_method, &quot;PUT&quot;)) {
+		foreach ($_POST as $h =&gt; $v) {
+			$request_entity[$h] = $v;
+		}
+	}
+
+	$package = array('ip' =&gt; $ip, 'headers' =&gt; $headers, 'headers_mixed' =&gt; $headers_mixed, 'request_method' =&gt; $request_method, 'request_uri' =&gt; $request_uri, 'server_protocol' =&gt; $server_protocol, 'request_entity' =&gt; $request_entity, 'user_agent' =&gt; $user_agent, 'is_browser' =&gt; false);
+
+	// Please proceed to the security checkpoint and have your
+	// identification and boarding pass ready.
+
+	// First check the whitelist
+	require_once(BB2_CORE . &quot;/whitelist.inc.php&quot;);
+	if (!bb2_whitelist($package)) {
+		// Now check the blacklist
+		require_once(BB2_CORE . &quot;/blacklist.inc.php&quot;);
+		bb2_test($settings, $package, bb2_blacklist($package));
+
+		// Check for common stuff
+		require_once(BB2_CORE . &quot;/common_tests.inc.php&quot;);
+		bb2_test($settings, $package, bb2_protocol($settings, $package));
+		bb2_test($settings, $package, bb2_misc_headers($settings, $package));
+
+		// Specific checks
+		$ua = $headers_mixed['User-Agent'];
+		// MSIE checks
+		if (stripos($ua, &quot;MSIE&quot;) !== FALSE) {
+			$package['is_browser'] = true;
+			if (stripos($ua, &quot;Opera&quot;) !== FALSE) {
+				require_once(BB2_CORE . &quot;/opera.inc.php&quot;);
+				bb2_test($settings, $package, bb2_opera($package));
+			} else {
+				require_once(BB2_CORE . &quot;/msie.inc.php&quot;);
+				bb2_test($settings, $package, bb2_msie($package));
+			}
+		} elseif (stripos($ua, &quot;Konqueror&quot;) !== FALSE) {
+			$package['is_browser'] = true;
+			require_once(BB2_CORE . &quot;/konqueror.inc.php&quot;);
+			bb2_test($settings, $package, bb2_konqueror($package));
+		} elseif (stripos($ua, &quot;Opera&quot;) !== FALSE) {
+			$package['is_browser'] = true;
+			require_once(BB2_CORE . &quot;/opera.inc.php&quot;);
+			bb2_test($settings, $package, bb2_opera($package));
+		} elseif (stripos($ua, &quot;Safari&quot;) !== FALSE) {
+			$package['is_browser'] = true;
+			require_once(BB2_CORE . &quot;/safari.inc.php&quot;);
+			bb2_test($settings, $package, bb2_safari($package));
+		} elseif (stripos($ua, &quot;Lynx&quot;) !== FALSE) {
+			$package['is_browser'] = true;
+			require_once(BB2_CORE . &quot;/lynx.inc.php&quot;);
+			bb2_test($settings, $package, bb2_lynx($package));
+		} elseif (stripos($ua, &quot;MovableType&quot;) !== FALSE) {
+			require_once(BB2_CORE . &quot;/movabletype.inc.php&quot;);
+			bb2_test($settings, $package, bb2_movabletype($package));
+		} elseif (stripos($ua, &quot;msnbot&quot;) !== FALSE || stripos($ua, &quot;MS Search&quot;) !== FALSE) {
+			require_once(BB2_CORE . &quot;/msnbot.inc.php&quot;);
+			bb2_test($settings, $package, bb2_msnbot($package));
+		} elseif (stripos($ua, &quot;Googlebot&quot;) !== FALSE || stripos($ua, &quot;Mediapartners-Google&quot;) !== FALSE) {
+			require_once(BB2_CORE . &quot;/google.inc.php&quot;);
+			bb2_test($settings, $package, bb2_google($package));
+		} elseif (stripos($ua, &quot;Mozilla&quot;) !== FALSE &amp;&amp; stripos($ua, &quot;Mozilla&quot; == 0)) {
+			$package['is_browser'] = true;
+			require_once(BB2_CORE . &quot;/mozilla.inc.php&quot;);
+			bb2_test($settings, $package, bb2_mozilla($package));
+		}
+
+		// More intensive screening applies to POST requests
+		if (!strcasecmp('POST', $package['request_method'])) {
+			require_once(BB2_CORE . &quot;/post.inc.php&quot;);
+			bb2_test($settings, $package, bb2_post($settings, $package));
+		}
+	}
+
+	// Last chance screening.
+	require_once(BB2_CORE . &quot;/screener.inc.php&quot;);
+	bb2_screener($settings, $package);
+
+	// And that's about it.
+	bb2_approved($settings, $package);
+	return true;
+}
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/functions.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/functions.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/functions.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,69 @@
+&lt;?php if (!defined('BB2_CORE')) die(&quot;I said no cheating!&quot;);
+
+// Miscellaneous helper functions.
+
+// stripos() needed because stripos is only present on PHP 5
+if (!function_exists('stripos')) {
+	function stripos($haystack,$needle,$offset = 0) {
+		return(strpos(strtolower($haystack),strtolower($needle),$offset));
+	}
+}
+
+// str_split() needed because str_split is only present on PHP 5
+if (!function_exists('str_split')) {
+	function str_split($string, $split_length=1)
+	{
+		if ($split_length &lt; 1) {
+			return false;
+		}
+
+		for ($pos=0, $chunks = array(); $pos &lt; strlen($string); $pos+=$split_length) {
+			$chunks[] = substr($string, $pos, $split_length);
+		}
+		return $chunks;
+	}
+}
+
+// Convert a string to mixed-case on word boundaries.
+function uc_all($string) {
+	$temp = preg_split('/(\W)/', str_replace(&quot;_&quot;, &quot;-&quot;, $string), -1, PREG_SPLIT_DELIM_CAPTURE);
+	foreach ($temp as $key=&gt;$word) {
+		$temp[$key] = ucfirst(strtolower($word));
+	}
+	return join ('', $temp);
+}
+
+// Determine if an IP address resides in a CIDR netblock or netblocks.
+function match_cidr($addr, $cidr) {
+	$output = false;
+
+	if (is_array($cidr)) {
+		foreach ($cidr as $cidrlet) {
+			if (match_cidr($addr, $cidrlet)) {
+				$output = true;
+			}
+		}
+	} else {
+		list($ip, $mask) = explode('/', $cidr);
+		$mask = 0xffffffff &lt;&lt; (32 - $mask);
+		$output = ((ip2long($addr) &amp; $mask) == (ip2long($ip) &amp; $mask));
+	}
+	return $output;
+}
+
+// Obtain all the HTTP headers.
+// NB: on PHP-CGI we have to fake it out a bit, since we can't get the REAL
+// headers. Run PHP as Apache 2.0 module if possible for best results.
+function bb2_load_headers() {
+	if (!is_callable('getallheaders')) {
+		$headers = array();
+		foreach ($_SERVER as $h =&gt; $v)
+			if (ereg('HTTP_(.+)', $h, $hp))
+				$headers[str_replace(&quot;_&quot;, &quot;-&quot;, uc_all($hp[1]))] = $v;
+	} else {
+		$headers = getallheaders();
+	}
+	return $headers;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/google.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/google.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/google.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,13 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Googlebot
+
+function bb2_google($package)
+{
+	if (match_cidr($package['ip'], &quot;66.249.64.0/19&quot;) === FALSE &amp;&amp; match_cidr($package['ip'], &quot;64.233.160.0/19&quot;) === FALSE) {
+		return &quot;f1182195&quot;;
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/housekeeping.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/housekeeping.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/housekeeping.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,16 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+function bb2_housekeeping($settings, $package)
+{
+	// FIXME Yes, the interval's hard coded (again) for now.
+	$query = &quot;DELETE FROM `&quot; . $settings['log_table'] . &quot;` WHERE `date` &lt; DATE_SUB('&quot; . bb2_db_date() . &quot;', INTERVAL 7 DAY)&quot;;
+	bb2_db_query($query);
+
+	// Waste a bunch more of the spammer's time, sometimes.
+	if (rand(1,1000) == 1) {
+		$query = &quot;OPTIMIZE TABLE `&quot; . $settings['log_table'] . &quot;`&quot;;
+		bb2_db_query($query);
+	}
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/index.html
===================================================================

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/konqueror.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/konqueror.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/konqueror.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,17 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Konqueror
+
+function bb2_konqueror($package)
+{
+	// CafeKelsa is a dev project at Yahoo which indexes job listings for
+	// Yahoo! HotJobs. It identifies as Konqueror so we skip these checks.
+	if (stripos($package['headers_mixed']['User-Agent'], &quot;YahooSeeker/CafeKelsa&quot;) === FALSE || match_cidr($package['ip'], &quot;209.73.160.0/19&quot;) === FALSE) {
+		if (!array_key_exists('Accept', $package['headers_mixed'])) {
+			return &quot;17566707&quot;;
+		}
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/lynx.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/lynx.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/lynx.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,13 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Lynx
+
+function bb2_lynx($package)
+{
+	if (!array_key_exists('Accept', $package['headers_mixed'])) {
+		return &quot;17566707&quot;;
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/movabletype.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/movabletype.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/movabletype.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,14 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+function bb2_movabletype($package)
+{
+	// Is it a trackback?
+	if (strcasecmp($package['request_method'], &quot;POST&quot;)) {
+		if (strcmp($package['headers_mixed']['Range'], &quot;bytes=0-99999&quot;)) {
+			return &quot;7d12528e&quot;;
+		}
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/mozilla.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/mozilla.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/mozilla.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,19 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Mozilla
+
+function bb2_mozilla($package)
+{
+	// First off, workaround for Google Desktop, until they fix it FIXME
+	// Google Desktop fixed it, but apparently some old versions are
+	// still out there. :(
+	// Always check accept header for Mozilla user agents
+	if (strpos($package['headers_mixed']['User-Agent'], &quot;Google Desktop&quot;) === FALSE) {
+		if (!array_key_exists('Accept', $package['headers_mixed'])) {
+			return &quot;17566707&quot;;
+		}
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msie.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msie.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msie.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,24 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be MSIE
+
+function bb2_msie($package)
+{
+	if (!array_key_exists('Accept', $package['headers_mixed'])) {
+		return &quot;17566707&quot;;
+	}
+
+	// MSIE does NOT send &quot;Windows ME&quot; or &quot;Windows XP&quot; in the user agent
+	if (strpos($package['headers_mixed']['User-Agent'], &quot;Windows ME&quot;) !== FALSE || strpos($package['headers_mixed']['User-Agent'], &quot;Windows XP&quot;) !== FALSE || strpos($package['headers_mixed']['User-Agent'], &quot;Windows 2000&quot;) !== FALSE || strpos($package['headers_mixed']['User-Agent'], &quot;Win32&quot;) !== FALSE) {
+		return &quot;a1084bad&quot;;
+	}
+
+	// MSIE does NOT send Connection: TE
+	if (preg_match('/\bTE\b/i', $package['headers_mixed']['Connection'])) {
+		return &quot;2b90f772&quot;;
+	}
+
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msnbot.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msnbot.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/msnbot.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,13 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be msnbot
+
+function bb2_msnbot($package)
+{
+	if (match_cidr($package['ip'], &quot;207.46.0.0/16&quot;) === FALSE &amp;&amp; match_cidr($package['ip'], &quot;65.52.0.0/14&quot;) === FALSE &amp;&amp; match_cidr($package['ip'], &quot;207.68.128.0/18&quot;) === FALSE &amp;&amp; match_cidr($package['ip'], &quot;207.68.192.0/20&quot;) === FALSE &amp;&amp; match_cidr($package['ip'], &quot;64.4.0.0/18&quot;) === FALSE) {
+		return &quot;e4de0453&quot;;
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/opera.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/opera.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/opera.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,13 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Opera
+
+function bb2_opera($package)
+{
+	if (!array_key_exists('Accept', $package['headers_mixed'])) {
+		return &quot;17566707&quot;;
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/post.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/post.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/post.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,68 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// All tests which apply specifically to POST requests
+function bb2_post($settings, $package)
+{
+	// Check blackhole lists for known spam/malicious activity
+	require_once(BB2_CORE . &quot;/blackhole.inc.php&quot;);
+	bb2_test($settings, $package, bb2_blackhole($package));
+
+	// MovableType needs specialized screening
+	if (stripos($package['headers_mixed']['User-Agent'], &quot;MovableType&quot;) !== FALSE) {
+		if (strcmp($package['headers_mixed']['Range'], &quot;bytes=0-99999&quot;)) {
+			return &quot;7d12528e&quot;;
+		}
+	}
+
+	// Trackbacks need special screening
+	$request_entity = $package['request_entity'];
+	if (isset($request_entity['title']) &amp;&amp; isset($request_entity['url']) &amp;&amp; isset($request_entity['blog_name'])) {
+		require_once(BB2_CORE . &quot;/trackback.inc.php&quot;);
+		return bb2_trackback($package);
+	}
+
+	// Catch a few completely broken spambots
+	foreach ($request_entity as $key =&gt; $value) {
+		$pos = strpos($key, &quot;	document.write&quot;);
+		if ($pos !== FAlSE) {
+			return &quot;dfd9b1ad&quot;;
+		}
+	}
+
+	// Screen by cookie/JavaScript form add
+	if (isset($_COOKIE[BB2_COOKIE])) {
+		$screener1 = explode(&quot; &quot;, $_COOKIE[BB2_COOKIE]);
+	}
+	if (isset($_POST[BB2_COOKIE])) {
+		$screener2 = explode(&quot; &quot;, $_POST[BB2_COOKIE]);
+	}
+	$screener = max($screener1[0], $screener2[0]);
+
+	if ($screener &gt; 0) {
+		// Posting too fast? 5 sec
+		// FIXME: even 5 sec is too intrusive
+		// if ($screener + 5 &gt; time())
+		//	return &quot;408d7e72&quot;;
+		// Posting too slow? 48 hr
+		if ($screener + 172800 &lt; time())
+			return &quot;b40c8ddc&quot;;
+
+		// Screen by IP address
+		$ip = ip2long($package['ip']);
+		$ip_screener = ip2long($screener[1]);
+//		FIXME: This is b0rked, but why?
+//		if ($ip &amp;&amp; $ip_screener &amp;&amp; abs($ip_screener - $ip) &gt; 256)
+//			return &quot;c1fa729b&quot;;
+
+		// Screen for user agent changes
+		// User connected previously with blank user agent
+		$q = bb2_db_query(&quot;SELECT `ip` FROM &quot; . $settings['log_table'] . &quot; WHERE (`ip` = '&quot; . $package['ip'] . &quot;' OR `ip` = '&quot; . $screener[1] . &quot;') AND `user_agent` != '&quot; . $package['user_agent'] . &quot;' AND `date` &gt; DATE_SUB('&quot; . bb2_db_date() . &quot;', INTERVAL 5 MINUTE)&quot;);
+		// Damnit, too many ways for this to fail :(
+		if ($q !== FALSE &amp;&amp; $q != NULL &amp;&amp; bb2_db_num_rows($q) &gt; 0)
+			return &quot;799165c2&quot;;
+	}
+
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/responses.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/responses.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/responses.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,44 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Defines the responses which Bad Behavior might return.
+
+function bb2_get_response($key) {
+	$bb2_responses = array(
+		'00000000' =&gt; array('response' =&gt; 200, 'explanation' =&gt; '', 'log' =&gt; ''),
+		'136673cd' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'Your Internet Protocol address is listed on a blacklist of addresses involved in malicious or illegal activity. See the listing below for more details on specific blacklists and removal procedures.', 'log' =&gt; 'IP address found on external blacklist'),
+		'17566707' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received from your browser. This may be caused by a malfunctioning proxy server or browser privacy software.', 'log' =&gt; 'Required header \'Accept\' missing'),
+		'17f4e8c8' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'User-Agent was found on blacklist'),
+		'21f11d3f' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received. You claimed to be a mobile Web device, but you do not actually appear to be a mobile Web device.', 'log' =&gt; 'User-Agent claimed to be AvantGo, claim appears false'),
+		'2b90f772' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. If you are using the Opera browser, then Opera must appear in your user agent.', 'log' =&gt; 'Connection: TE present, not supported by MSIE'),
+		'408d7e72' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, run anti-virus and anti-spyware software and remove any viruses and spyware from your computer.', 'log' =&gt; 'POST comes too quickly after GET'),
+		'41feed15' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'An invalid request was received. This may be caused by a malfunctioning proxy server. Bypass the proxy server and connect directly, or contact your proxy server administrator.', 'log' =&gt; 'Header \'Pragma\' without \'Cache-Control\' prohibited for HTTP/1.1 requests'),
+		'45b35e30' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received from your browser. This may be caused by a malfunctioning proxy server or browser privacy software.', 'log' =&gt; 'Header \'Referer\' is corrupt'),
+		'57796684' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, run anti-virus and anti-spyware software and remove any viruses and spyware from your computer.', 'log' =&gt; 'Prohibited header \'X-Aaaaaaaaaa\' or \'X-Aaaaaaaaaaaa\' present'),
+		'582ec5e4' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'An invalid request was received. If you are using a proxy server, bypass the proxy server or contact your proxy server administrator. This may also be caused by a bug in the Opera web browser.', 'log' =&gt; '&quot;Header \'TE\' present but TE not specified in \'Connection\' header'),
+		'69920ee5' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received from your browser. This may be caused by a malfunctioning proxy server or browser privacy software.', 'log' =&gt; 'Header \'Referer\' present but blank'),
+		'799165c2' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'Rotating user-agents detected'),
+		'7a06532b' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'An invalid request was received from your browser. This may be caused by a malfunctioning proxy server or browser privacy software.', 'log' =&gt; 'Required header \'Accept-Encoding\' missing'),
+		'7ad04a8a' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'The automated program you are using is not permitted to access this server. Please use a different program or a standard Web browser.', 'log' =&gt; 'Prohibited header \'Range\' present'),
+		'7d12528e' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'Prohibited header \'Range\' or \'Content-Range\' in POST request'),
+		'939a6fbb' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'The proxy server you are using is not permitted to access this server. Please bypass the proxy server, or contact your proxy server administrator.', 'log' =&gt; 'Banned proxy server in use'),
+		'9c9e4979' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'The proxy server you are using is not permitted to access this server. Please bypass the proxy server, or contact your proxy server administrator.', 'log' =&gt; 'Prohibited header \'via\' present'),
+		'a0105122' =&gt; array('response' =&gt; 417, 'explanation' =&gt; 'Expectation failed. Please retry your request.', 'log' =&gt; 'Header \'Expect\' prohibited; resend without Expect'),
+		'a1084bad' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'User-Agent claimed to be MSIE, with invalid Windows version'),
+		'a52f0448' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'An invalid request was received.  This may be caused by a malfunctioning proxy server or browser privacy software. If you are using a proxy server, bypass the proxy server or contact your proxy server administrator.', 'log' =&gt; 'Header \'Connection\' contains invalid values'),
+		'b40c8ddc' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, close your browser, run anti-virus and anti-spyware software and remove any viruses and spyware from your computer.', 'log' =&gt; 'POST more than two days after GET'),
+		'b7830251' =&gt; array('response' =&gt; 400, 'explanation' =&gt; 'Your proxy server sent an invalid request. Please contact the proxy server administrator to have this problem fixed.', 'log' =&gt; 'Prohibited header \'Proxy-Connection\' present'),
+		'b9cc1d86' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'The proxy server you are using is not permitted to access this server. Please bypass the proxy server, or contact your proxy server administrator.', 'log' =&gt; 'Prohibited header \'X-Aaaaaaaaaa\' or \'X-Aaaaaaaaaaaa\' present'),
+		'c1fa729b' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, run anti-virus and anti-spyware software and remove any viruses and spyware from your computer.', 'log' =&gt; 'Use of rotating proxy servers detected'),
+		'd60b87c7' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, please remove any viruses or spyware from your computer.', 'log' =&gt; 'Trackback received via proxy server'),
+		'dfd9b1ad' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'Request contained a malicious JavaScript or SQL injection attack'),
+		'e4de0453' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received. You claimed to be a major search engine, but you do not appear to actually be a major search engine.', 'log' =&gt; 'User-Agent claimed to be msnbot, claim appears to be false'),
+		'e87553e1' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server.', 'log' =&gt; 'I know you and I don\'t like you, dirty spammer.'),
+		'f0dcb3fd' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. Before trying again, run anti-virus and anti-spyware software and remove any viruses and spyware from your computer.', 'log' =&gt; 'Web browser attempted to send a trackback'),
+		'f1182195' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'An invalid request was received. You claimed to be a major search engine, but you do not appear to actually be a major search engine.', 'log' =&gt; 'User-Agent claimed to be Googlebot, claim appears to be false.'),
+		'f9f2b8b9' =&gt; array('response' =&gt; 403, 'explanation' =&gt; 'You do not have permission to access this server. This may be caused by a malfunctioning proxy server or browser privacy software.', 'log' =&gt; 'A User-Agent is required but none was provided.'),
+	);
+
+	if (array_key_exists($key, $bb2_responses)) return $bb2_responses[$key];
+	return array('00000000');
+}
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/safari.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/safari.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/safari.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,13 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Analyze user agents claiming to be Safari
+
+function bb2_safari($package)
+{
+	if (!array_key_exists('Accept', $package['headers_mixed'])) {
+		return &quot;17566707&quot;;
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/screener.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/screener.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/screener.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,63 @@
+&lt;?php if (!defined('BB2_CWD')) die(&quot;I said no cheating!&quot;);
+
+// Bad Behavior browser screener
+
+function bb2_screener_cookie($settings, $package, $cookie_name, $cookie_value)
+{
+	// FIXME: Set the real cookie
+	setcookie($cookie_name, $cookie_value, 0, bb2_relative_path());
+}
+
+function bb2_screener_javascript($settings, $package, $cookie_name, $cookie_value)
+{
+	global $bb2_javascript;
+
+	// FIXME: do something
+	$bb2_javascript = &quot;&lt;script type=\&quot;text/javascript\&quot;&gt;
+&lt;!--
+function bb2_addLoadEvent(func) {
+	var oldonload = window.onload;
+	if (typeof window.onload != 'function') {
+		window.onload = func;
+	} else {
+		window.onload = function() {
+			oldonload();
+			func();
+		}
+	}
+}
+
+bb2_addLoadEvent(function() {
+	for ( i=0; i &lt; document.forms.length; i++ ) {
+		if (document.forms[i].method == 'post') {
+			var myElement = document.createElement('input');
+			myElement.setAttribute('type', 'hidden');
+			myElement.name = '$cookie_name';
+			myElement.value = '$cookie_value';
+			document.forms[i].appendChild(myElement);
+		}
+	}
+});
+// --&gt;&lt;/script&gt;
+		&quot;;
+}
+
+function bb2_screener($settings, $package)
+{
+	$cookie_name = BB2_COOKIE;
+
+	// Set up a simple cookie
+	$screener = array(time(), $package['ip']);
+	if (isset($package['headers_mixed']['X-Forwarded-For'])) {
+		array_push($screener, $package['headers_mixed']['X-Forwarded-For']);
+	}
+	if (isset($package['headers_mixed']['Client-Ip'])) {
+		array_push($screener, $package['headers_mixed']['Client-Ip']);
+	}
+
+	$cookie_value = implode(&quot; &quot;, $screener);
+
+	bb2_screener_cookie($settings, $package, BB2_COOKIE, $cookie_value);
+	bb2_screener_javascript($settings, $package, BB2_COOKIE, $cookie_value);
+}
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/trackback.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/trackback.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/trackback.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,18 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+// Specialized screening for trackbacks
+function bb2_trackback($package)
+{
+	// Web browsers don't send trackbacks
+	if ($package['is_browser']) {
+		return 'f0dcb3fd';
+	}
+
+	// Proxy servers don't send trackbacks either
+	if (array_key_exists('Via', $package['headers_mixed']) || array_key_exists('Max-Forwards', $package['headers_mixed']) || array_key_exists('X-Forwarded-For', $package['headers_mixed']) || array_key_exists('Client-Ip', $package['headers_mixed'])) {
+		return 'd60b87c7';
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/version.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/version.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/version.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,3 @@
+&lt;?php if (!defined('BB2_CWD')) die(&quot;I said no cheating!&quot;);
+define('BB2_VERSION', &quot;2.0.8&quot;);
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/whitelist.inc.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/whitelist.inc.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior/whitelist.inc.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,57 @@
+&lt;?php if (!defined('BB2_CORE')) die('I said no cheating!');
+
+function bb2_whitelist($package)
+{
+	// DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER!
+
+	// Inappropriate whitelisting WILL expose you to spam, or cause Bad
+	// Behavior to stop functioning entirely!  DO NOT WHITELIST unless you
+	// are 100% CERTAIN that you should.
+
+	// IP address ranges use the CIDR format.
+
+	// Includes four examples of whitelisting by IP address and netblock.
+	$bb2_whitelist_ip_ranges = array(
+		&quot;10.0.0.0/8&quot;,
+		&quot;172.16.0.0/12&quot;,
+		&quot;192.168.0.0/16&quot;,
+//		&quot;127.0.0.1&quot;,
+		&quot;208.54.95.129&quot;,
+	);
+
+	// DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER!
+
+	// Inappropriate whitelisting WILL expose you to spam, or cause Bad
+	// Behavior to stop functioning entirely!  DO NOT WHITELIST unless you
+	// are 100% CERTAIN that you should.
+
+	// You should not whitelist search engines by user agent. Use the IP
+	// netblock for the search engine instead. See <A HREF="http://whois.arin.net/">http://whois.arin.net/</A>
+	// to locate the netblocks for an IP.
+
+	// User agents are matched by exact match only.
+
+	// Includes one example of whitelisting by user agent.
+	// All are commented out.
+	$bb2_whitelist_user_agents = array(
+	//	&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) It's me, let me in&quot;,
+	);
+
+	// DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER! DANGER!
+
+	// Do not edit below this line
+
+	if (!empty($bb2_whitelist_ip_ranges)) {
+		foreach ($bb2_whitelist_ip_ranges as $range) {
+			if (match_cidr($package['ip'], $range)) return true;
+		}
+	}
+	if (!empty($bb2_whitelist_user_agents)) {
+		foreach ($bb2_whitelist_user_agents as $user_agent) {
+			if (!strcmp($package['headers_mixed']['User-Agent'], $user_agent)) return true;
+		}
+	}
+	return false;
+}
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-generic.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-generic.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-generic.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,140 @@
+&lt;?php
+/*
+Bad Behavior - detects and blocks unwanted Web accesses
+Copyright (C) 2005-2006 Michael Hampton
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+As a special exemption, you may link this program with any of the
+programs listed below, regardless of the license terms of those
+programs, and distribute the resulting program, without including the
+source code for such programs: ExpressionEngine
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+
+Please report any problems to badbots AT ioerror DOT us
+*/
+
+###############################################################################
+###############################################################################
+
+define('BB2_CWD', dirname(__FILE__));
+
+// Settings you can adjust for Bad Behavior.
+// Most of these are unused in non-database mode.
+$bb2_settings_defaults = array(
+	'log_table' =&gt; 'bad_behavior',
+	'display_stats' =&gt; true,
+	'strict' =&gt; false,
+	'verbose' =&gt; false
+);
+
+// Bad Behavior callback functions.
+
+// Return current time in the format preferred by your database.
+function bb2_db_date() {
+	return gmdate('Y-m-d H:i:s');	// Example is MySQL format
+}
+
+// Return affected rows from most recent query.
+function bb2_db_affected_rows() {
+	return false;
+}
+
+// Escape a string for database usage
+function bb2_db_escape($string) {
+	// return mysql_real_escape_string($string);
+	return $string;	// No-op when database not in use.
+}
+
+// Return the number of rows in a particular query.
+function bb2_db_num_rows($result) {
+	if ($result !== FALSE)
+		return count($result);
+	return 0;
+}
+
+// Run a query and return the results, if any.
+// Should return FALSE if an error occurred.
+// Bad Behavior will use the return value here in other callbacks.
+function bb2_db_query($query) {
+	return FALSE;
+}
+
+// Return all rows in a particular query.
+// Should contain an array of all rows generated by calling mysql_fetch_assoc()
+// or equivalent and appending the result of each call to an array.
+function bb2_db_rows($result) {
+	return $result;
+}
+
+// Return emergency contact email address.
+function bb2_email() {
+	// return &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">example at example.com</A>&quot;;	// You need to change this.
+	return &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">badbots at ioerror.us</A>&quot;;	// You need to change this.
+}
+
+// retrieve settings from database
+// Settings are hard-coded for non-database use
+function bb2_read_settings() {
+	global $bb2_settings_defaults;
+	return $bb2_settings_defaults;
+}
+
+// write settings to database
+function bb2_write_settings($settings) {
+	return false;
+}
+
+// installation
+function bb2_install() {
+	return false;
+}
+
+// Screener
+// Insert this into the &lt;head&gt; section of your HTML through a template call
+// or whatever is appropriate. This is optional we'll fall back to cookies
+// if you don't use it.
+function bb2_insert_head() {
+	global $bb2_javascript;
+	echo $bb2_javascript;
+}
+
+// Display stats? This is optional.
+function bb2_insert_stats($force = false) {
+	$settings = bb2_read_settings();
+
+	if ($force || $settings['display_stats']) {
+		$blocked = bb2_db_query(&quot;SELECT COUNT(*) FROM &quot; . $settings['log_table'] . &quot; WHERE `key` NOT LIKE '00000000'&quot;);
+		if ($blocked !== FALSE) {
+			echo sprintf('&lt;p&gt;&lt;a href=&quot;<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>&quot;&gt;%1$s&lt;/a&gt; %2$s &lt;strong&gt;%3$s&lt;/strong&gt; %4$s&lt;/p&gt;', __('Bad Behavior'), __('has blocked'), $blocked[0][&quot;COUNT(*)&quot;], __('access attempts in the last 7 days.'));
+		}
+	}
+}
+
+// Return the top-level relative path of wherever we are (for cookies)
+// You should provide in $url the top-level URL for your site.
+function bb2_relative_path() {
+	//$url = parse_url(get_bloginfo('url'));
+	//return $url['path'] . '/';
+	return '/';
+}
+
+// Calls inward to Bad Behavor itself.
+require_once(BB2_CWD . &quot;/bad-behavior/version.inc.php&quot;);
+require_once(BB2_CWD . &quot;/bad-behavior/core.inc.php&quot;);
+bb2_install();	// FIXME: see above
+
+bb2_start(bb2_read_settings());
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-lifetype.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-lifetype.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-lifetype.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,148 @@
+&lt;?php
+/*
+<A HREF="http://blog.markplace.net">http://blog.markplace.net</A>
+
+Bad Behavior - LifeType Plugin
+Copyright (C) 2006 Mark Wu <A HREF="http://blog.markplace.net">http://blog.markplace.net</A>
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+*/
+
+// This file is the entry point for Bad Behavior in LifeType.
+
+if (!defined('PLOG_CLASS_PATH')) die('No cheating!');
+
+define('BB2_CWD', PLOG_CLASS_PATH );
+define('BB2_EMERGENCY_EMAIL', &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/ydframework-devel">admin at yourblog.com</A>&quot; );
+
+// Bad Behavior callback functions.
+
+// Return current time in the format preferred by your database.
+function bb2_db_date() {
+	return gmdate('Y-m-d H:i:s');
+}
+
+// Return affected rows from most recent query.
+function bb2_db_affected_rows() {
+	include_once( PLOG_CLASS_PATH.&quot;class/database/db.class.php&quot; );
+	$db =&amp; Db::getDb();
+	
+	return $db-&gt;Affected_Rows();
+}
+
+// Escape a string for database usage
+function bb2_db_escape($string) {
+    include_once( PLOG_CLASS_PATH.&quot;class/database/db.class.php&quot; );    
+
+	return Db::qstr($string);
+}
+
+// Return the number of rows in a particular query.
+function bb2_db_num_rows($result) {
+	return $result-&gt;RecordCount();
+}
+
+// Run a query and return the results, if any.
+// Should return FALSE if an error occurred.
+function bb2_db_query($query) {
+	include_once( PLOG_CLASS_PATH.&quot;class/database/db.class.php&quot; );    
+	$db =&amp; Db::getDb();
+
+	$result = $db-&gt;Execute( $query );
+
+	if (!$result)
+		return false;
+
+	return $result;
+}
+
+// Return all rows in a particular query.
+// Should contain an array of all rows generated by calling mysql_fetch_assoc()
+// or equivalent and appending the result of each call to an array.
+function bb2_db_rows($result) {
+	$rows = array();
+	while( $row = $result-&gt;FetchRow()) {
+		$rows[] = $row;
+	}
+
+	return $rows;
+}
+
+// Return emergency contact email address.
+function bb2_email() {
+	return BB2_EMERGENCY_EMAIL;
+}
+
+// retrieve settings from lifetype config
+function bb2_read_settings() {
+	include_once( PLOG_CLASS_PATH.&quot;class/database/db.class.php&quot; );
+	include_once( PLOG_CLASS_PATH.&quot;class/config/config.class.php&quot; );    
+	$config =&amp; Config::getConfig();
+	$prefix = Db::getPrefix();
+	$displayStats = $config-&gt;getValue( 'bb2_display_stats', true );
+	$verbose = $config-&gt;getValue( 'bb2_verbose', false );
+	$isInstalled = $config-&gt;getValue( 'bb2_installed', false );
+	
+	return array('log_table' =&gt; $prefix . 'bad_behavior', 
+				 'display_stats' =&gt; $displayStats,
+				 'verbose' =&gt; $verbose,
+				 'is_installed' =&gt; $isInstalled );
+}
+
+// write settings to lifetype config
+function bb2_write_settings($settings) {
+    include_once( PLOG_CLASS_PATH.&quot;class/config/config.class.php&quot; );
+	$config =&amp; Config::getConfig();
+
+	$config-&gt;setValue( 'bb2_display_stats', $settings['display_stats'] );
+	$config-&gt;setValue( 'bb2_verbose', $settings['verbose'] );
+	$config-&gt;setValue( 'bb2_installed', $settings['is_installed'] );
+	$config-&gt;save();
+}
+	
+// installation
+function bb2_install() {
+	$settings = bb2_read_settings();
+	if( $settings['is_installed'] == false )
+	{
+		bb2_db_query(bb2_table_structure($settings['log_table']));
+		$settings['is_installed'] = true;
+		bb2_write_settings( $settings );
+	}
+}
+
+// Return the top-level relative path of wherever we are (for cookies)
+function bb2_relative_path() {
+    include_once( PLOG_CLASS_PATH.&quot;class/config/config.class.php&quot; );
+	$config =&amp; Config::getConfig();
+	
+	$url = parse_url( $config-&gt;getValue( 'base_url' ) );
+	if( empty($url['path']) )
+		return '/';
+	else {
+		if( substr( $url['path'], -1, 1 ) == '/' )
+			return $url['path'];
+		else
+			return $url['path'] . '/';
+	}
+}
+
+// Start Bad Behavior investigation
+require_once(BB2_CWD . &quot;/bad-behavior/version.inc.php&quot;);
+require_once(BB2_CWD . &quot;/bad-behavior/core.inc.php&quot;);
+bb2_install();
+$settings = bb2_read_settings();
+bb2_start($settings);
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-mediawiki.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-mediawiki.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-mediawiki.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,154 @@
+&lt;?php
+/*
+<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>
+
+Bad Behavior - detects and blocks unwanted Web accesses
+Copyright (C) 2005 Michael Hampton
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+*/
+
+// This file is the entry point for Bad Behavior.
+
+if (!defined('MEDIAWIKI')) die();
+
+// Settings you can adjust for Bad Behavior.
+$bb2_settings_defaults = array(
+	'log_table' =&gt; $wgDBprefix . 'bad_behavior',
+	'display_stats' =&gt; true,
+	'strict' =&gt; false,
+	'verbose' =&gt; false
+);
+
+define('BB2_CWD', dirname(__FILE__));
+
+// Bad Behavior callback functions.
+
+// Return current time in the format preferred by your database.
+function bb2_db_date() {
+	return gmdate('Y-m-d H:i:s');
+}
+
+// Return affected rows from most recent query.
+function bb2_db_affected_rows($result) {
+	return wfAffectedRows($result);
+}
+
+// Escape a string for database usage
+function bb2_db_escape($string) {
+	// FIXME SECURITY: Get a straight answer from somebody on how MW escapes stuff
+	return addslashes($string);
+}
+
+// Return the number of rows in a particular query.
+function bb2_db_num_rows($result) {
+	return wfNumRows($result);
+}
+
+// Run a query and return the results, if any.
+// Should return FALSE if an error occurred.
+function bb2_db_query($query) {
+	$bb2_last_query = wfQuery($query, DB_WRITE);
+	return $bb2_last_query;
+}
+
+// Return all rows in a particular query.
+// Should contain an array of all rows generated by calling mysql_fetch_assoc()
+// or equivalent and appending the result of each call to an array.
+function bb2_db_rows($result) {
+	$rows = array();
+	while ($row = wfFetchRow($result)) {
+		$rows[] = $row;
+	}
+	return $rows;
+}
+
+// Return emergency contact email address.
+function bb2_email() {
+	global $wgEmergencyContact;
+	return $wgEmergencyContact;
+}
+
+// This Bad Behavior-related function is a stub. You can help MediaWiki by expanding it.
+// retrieve settings from database
+function bb2_read_settings() {
+	global $bb2_settings_defaults;
+	return $bb2_settings_defaults;
+}
+
+// This Bad Behavior-related function is a stub. You can help MediaWiki by expanding it.
+// write settings to database
+function bb2_write_settings($settings) {
+	return;
+}
+
+// In some configurations automatic table creation may fail with the message
+// You must update your load-balancing configuration.
+// You can create the table manually (see query in
+// bad-behavior/database.inc.php) and add this line to your LocalSettings.php:
+//
+//   define('BB2_NO_CREATE', true);
+
+// installation
+function bb2_install() {
+	$settings = bb2_read_settings();
+	if (defined('BB2_NO_CREATE')) return;
+	bb2_db_query(bb2_table_structure($settings['log_table']));
+}
+
+// Return the top-level relative path of wherever we are (for cookies)
+function bb2_relative_path() {
+	// TODO: This might not be the best way, but it seems to work
+	global $wgScript;
+	return dirname($wgScript) . &quot;/&quot;;
+}
+
+// Cute timer display
+function bb2_mediawiki_timer(&amp;$parser, &amp;$text) {
+	global $bb2_timer_total;
+	$text = &quot;&lt;!-- Bad Behavior &quot; . BB2_VERSION . &quot; run time: &quot; . number_format(1000 * $bb2_timer_total, 3) . &quot; ms --&gt;&quot; . $text;
+}
+
+function bb2_mediawiki_entry() {
+	global $bb2_timer_total;
+
+	$bb2_mtime = explode(&quot; &quot;, microtime());
+	$bb2_timer_start = $bb2_mtime[1] + $bb2_mtime[0];
+
+	if (php_sapi_name() != 'cli') {
+		require_once(BB2_CWD . &quot;/bad-behavior/core.inc.php&quot;);
+		bb2_install();	// FIXME: see above
+		$settings = bb2_read_settings();
+		bb2_start($settings);
+	}
+
+	$bb2_mtime = explode(&quot; &quot;, microtime());
+	$bb2_timer_stop = $bb2_mtime[1] + $bb2_mtime[0];
+	$bb2_timer_total = $bb2_timer_stop - $bb2_timer_start;
+}
+
+require_once(BB2_CWD . &quot;/bad-behavior/version.inc.php&quot;);
+$wgExtensionCredits['other'][] = array(
+	'name' =&gt; 'Bad Behavior',
+	'version' =&gt; BB2_VERSION,
+	'author' =&gt; 'Michael Hampton',
+	'description' =&gt; 'Detects and blocks unwanted Web accesses',
+	'url' =&gt; '<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>'
+);
+
+$wgHooks['ParserAfterTidy'][] = 'bb2_mediawiki_timer';
+$wgExtensionFunctions[] = 'bb2_mediawiki_entry';
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-wordpress.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-wordpress.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-wordpress.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,172 @@
+&lt;?php
+/*
+Plugin Name: Bad Behavior
+Version: 2.0.8
+Description: Deny automated spambots access to your PHP-based Web site.
+Plugin URI: <A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>
+Author: Michael Hampton
+Author URI: <A HREF="http://www.homelandstupidity.us/">http://www.homelandstupidity.us/</A>
+License: GPL
+
+Bad Behavior - detects and blocks unwanted Web accesses
+Copyright (C) 2005 Michael Hampton
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+As a special exemption, you may link this program with any of the
+programs listed below, regardless of the license terms of those
+programs, and distribute the resulting program, without including the
+source code for such programs: ExpressionEngine
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+
+Please report any problems to badbots AT ioerror DOT us
+*/
+
+###############################################################################
+###############################################################################
+
+if (!defined('ABSPATH')) die(&quot;No cheating!&quot;);
+
+$bb2_mtime = explode(&quot; &quot;, microtime());
+$bb2_timer_start = $bb2_mtime[1] + $bb2_mtime[0];
+
+define('BB2_CWD', dirname(__FILE__));
+
+// Bad Behavior callback functions.
+
+// Return current time in the format preferred by your database.
+function bb2_db_date() {
+	return get_gmt_from_date(current_time('mysql'));
+}
+
+// Return affected rows from most recent query.
+function bb2_db_affected_rows() {
+	global $wpdb;
+
+	return $wpdb-&gt;rows_affected;
+}
+
+// Escape a string for database usage
+function bb2_db_escape($string) {
+	global $wpdb;
+
+	return $wpdb-&gt;escape($string);
+}
+
+// Return the number of rows in a particular query.
+function bb2_db_num_rows($result) {
+	if ($result !== FALSE)
+		return count($result);
+	return 0;
+}
+
+// Run a query and return the results, if any.
+// Should return FALSE if an error occurred.
+// Bad Behavior will use the return value here in other callbacks.
+function bb2_db_query($query) {
+	global $wpdb;
+
+	$wpdb-&gt;hide_errors();
+	$result = $wpdb-&gt;get_results($query, ARRAY_A);
+	$wpdb-&gt;show_errors();
+	if (mysql_error()) {
+		return FALSE;
+	}
+	return $result;
+}
+
+// Return all rows in a particular query.
+// Should contain an array of all rows generated by calling mysql_fetch_assoc()
+// or equivalent and appending the result of each call to an array.
+// For WP this is pretty much a no-op.
+function bb2_db_rows($result) {
+	return $result;
+}
+
+// Return emergency contact email address.
+function bb2_email() {
+	return get_bloginfo('admin_email');
+}
+
+// retrieve settings from database
+function bb2_read_settings() {
+	global $wpdb;
+
+	// Add in default settings when they aren't yet present in WP
+	$settings = get_settings('bad_behavior_settings');
+
+	if (!$settings) $settings = array();
+	return array_merge(array('log_table' =&gt; $wpdb-&gt;prefix . 'bad_behavior', 'display_stats' =&gt; true, 'strict' =&gt; false, 'verbose' =&gt; false), $settings);
+}
+
+// write settings to database
+function bb2_write_settings($settings) {
+	update_option('bad_behavior_settings', $settings);
+}
+
+// installation
+function bb2_install() {
+	$settings = bb2_read_settings();
+	bb2_db_query(bb2_table_structure($settings['log_table']));
+}
+
+// Cute timer display; screener
+function bb2_insert_head() {
+	global $bb2_timer_total;
+	global $bb2_javascript;
+	echo &quot;\n&lt;!-- Bad Behavior &quot; . BB2_VERSION . &quot; run time: &quot; . number_format(1000 * $bb2_timer_total, 3) . &quot; ms --&gt;\n&quot;;
+	echo $bb2_javascript;
+}
+
+// Display stats?
+function bb2_insert_stats($force = false) {
+	$settings = bb2_read_settings();
+
+	if ($force || $settings['display_stats']) {
+		$blocked = bb2_db_query(&quot;SELECT COUNT(*) FROM &quot; . $settings['log_table'] . &quot; WHERE `key` NOT LIKE '00000000'&quot;);
+		if ($blocked !== FALSE) {
+			echo sprintf('&lt;p&gt;&lt;a href=&quot;<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>&quot;&gt;%1$s&lt;/a&gt; %2$s &lt;strong&gt;%3$s&lt;/strong&gt; %4$s&lt;/p&gt;', __('Bad Behavior'), __('has blocked'), $blocked[0][&quot;COUNT(*)&quot;], __('access attempts in the last 7 days.'));
+		}
+	}
+}
+
+// Return the top-level relative path of wherever we are (for cookies)
+function bb2_relative_path() {
+	$url = parse_url(get_bloginfo('url'));
+	return $url['path'] . '/';
+}
+
+// FIXME: some sort of hack to run install on 1.5 (and older?) blogs
+// FIXME: figure out what's wrong on 2.0 that this doesn't work
+// register_activation_hook(__FILE__, 'bb2_install');
+//add_action('activate_bb2/bad-behavior-wordpress.php', 'bb2_install');
+add_action('wp_head', 'bb2_insert_head');
+add_action('wp_footer', 'bb2_insert_stats');
+
+// Calls inward to Bad Behavor itself.
+require_once(BB2_CWD . &quot;/bad-behavior/version.inc.php&quot;);
+require_once(BB2_CWD . &quot;/bad-behavior/core.inc.php&quot;);
+bb2_install();	// FIXME: see above
+
+if (is_admin() || strstr($_SERVER['PHP_SELF'], 'wp-admin/')) {	// 1.5 kludge
+	require_once(BB2_CWD . &quot;/bad-behavior/admin.inc.php&quot;);
+}
+
+bb2_start(bb2_read_settings());
+
+$bb2_mtime = explode(&quot; &quot;, microtime());
+$bb2_timer_stop = $bb2_mtime[1] + $bb2_mtime[0];
+$bb2_timer_total = $bb2_timer_stop - $bb2_timer_start;
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-ydweblog.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-ydweblog.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/bad-behavior-ydweblog.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,136 @@
+&lt;?php
+/*
+Bad Behavior - detects and blocks unwanted Web accesses
+Copyright (C) 2005-2006 Michael Hampton
+
+This program is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+As a special exemption, you may link this program with any of the
+programs listed below, regardless of the license terms of those
+programs, and distribute the resulting program, without including the
+source code for such programs: ExpressionEngine
+
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+
+Please report any problems to badbots AT ioerror DOT us
+*/
+
+###############################################################################
+###############################################################################
+
+define('BB2_CWD', dirname(__FILE__));
+
+// Settings you can adjust for Bad Behavior.
+// Most of these are unused in non-database mode.
+$bb2_settings_defaults = array(
+	'log_table' =&gt; '#_bad_behavior',
+	'display_stats' =&gt; true,
+	'strict' =&gt; false,
+	'verbose' =&gt; true
+);
+
+// Return current time in the format preferred by your database.
+function bb2_db_date() {
+	return gmdate('Y-m-d H:i:s');
+}
+
+// Return affected rows from most recent query.
+function bb2_db_affected_rows() {
+    return mysql_affected_rows( $GLOBALS['db']-&gt;_conn );
+}
+
+// Escape a string for database usage
+function bb2_db_escape($string) {
+    return $GLOBALS['db']-&gt;escape( $string );
+}
+
+// Return the number of rows in a particular query.
+function bb2_db_num_rows($result) {
+	if ($result !== FALSE)
+		return count($result);
+	return 0;
+}
+
+// Run a query and return the results, if any.
+// Should return FALSE if an error occurred.
+// Bad Behavior will use the return value here in other callbacks.
+function bb2_db_query($query) {
+    return @ $GLOBALS['db']-&gt;getRecords( $query );
+}
+
+// Return all rows in a particular query.
+// Should contain an array of all rows generated by calling mysql_fetch_assoc()
+// or equivalent and appending the result of each call to an array.
+function bb2_db_rows($result) {
+	return $result;
+}
+
+// Return emergency contact email address.
+function bb2_email() {
+	return $_SERVER['SERVER_ADMIN'];
+}
+
+// retrieve settings from database
+// Settings are hard-coded for non-database use
+function bb2_read_settings() {
+	global $bb2_settings_defaults;
+	return $bb2_settings_defaults;
+}
+
+// write settings to database
+function bb2_write_settings($settings) {
+	return false;
+}
+
+// installation
+function bb2_install() {
+    $settings = bb2_read_settings();
+    $GLOBALS['db']-&gt;executeSql(bb2_table_structure($settings['log_table']));
+}
+
+// Screener
+// Insert this into the &lt;head&gt; section of your HTML through a template call
+// or whatever is appropriate. This is optional we'll fall back to cookies
+// if you don't use it.
+function bb2_insert_head() {
+	global $bb2_timer_total;
+	global $bb2_javascript;
+	return &quot;\n&lt;!-- Bad Behavior &quot; . BB2_VERSION . &quot; run time: &quot; . number_format(1000 * $bb2_timer_total, 3) . &quot; ms --&gt;\n&quot; . $bb2_javascript;
+}
+
+// Display stats? This is optional.
+function bb2_insert_stats($force = false) {
+	$settings = bb2_read_settings();
+
+	if ($force || $settings['display_stats']) {
+		$blocked = bb2_db_query(&quot;SELECT COUNT(*) FROM &quot; . $settings['log_table'] . &quot; WHERE `key` NOT LIKE '00000000'&quot;);
+		if ($blocked !== FALSE) {
+			echo sprintf('&lt;p&gt;&lt;a href=&quot;<A HREF="http://www.homelandstupidity.us/software/bad-behavior/">http://www.homelandstupidity.us/software/bad-behavior/</A>&quot;&gt;%1$s&lt;/a&gt; %2$s &lt;strong&gt;%3$s&lt;/strong&gt; %4$s&lt;/p&gt;', __('Bad Behavior'), __('has blocked'), $blocked[0][&quot;COUNT(*)&quot;], __('access attempts in the last 7 days.'));
+		}
+	}
+}
+
+// Return the top-level relative path of wherever we are (for cookies)
+// You should provide in $url the top-level URL for your site.
+function bb2_relative_path() {
+	return '/';
+}
+
+// Calls inward to Bad Behavor itself.
+require_once(BB2_CWD . &quot;/bad-behavior/version.inc.php&quot;);
+require_once(BB2_CWD . &quot;/bad-behavior/core.inc.php&quot;);
+bb2_install();
+
+bb2_start(bb2_read_settings());
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/include/Bad-Behavior/index.html
===================================================================

Modified: YDFramework2.0/trunk/examples/weblog/include/YDWeblogAPI.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/YDWeblogAPI.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/YDWeblogAPI.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -960,6 +960,21 @@
             $this-&gt;db-&gt;executeSql( $sql );
         }
 
+        // Get the bad behavior requests count
+        function getBadBehaviorRequestsCount() {
+            $settings = bb2_read_settings();
+            return $this-&gt;db-&gt;getValueByName(
+                &quot;SELECT COUNT(*) AS COUNT FROM &quot; . $settings['log_table'] . &quot; WHERE `key` NOT LIKE '00000000'&quot;
+                , 'count'
+            );
+        }
+
+        // Get the bad behavior requests
+        function getBadBehaviorRequests() {
+            $settings = bb2_read_settings();
+            return $this-&gt;db-&gt;getRecords( &quot;SELECT * FROM &quot; . $settings['log_table'] . &quot; WHERE `key` NOT LIKE '00000000' ORDER BY DATE DESC&quot; );
+        }
+
         // Function to resize an uploaded image. Takes a YDFSImage object as it's argument
         function resizeUploadedImage( $image ) {
 

Modified: YDFramework2.0/trunk/examples/weblog/include/YDWeblogRequest.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/YDWeblogRequest.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/YDWeblogRequest.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -149,6 +149,7 @@
             $this-&gt;tpl-&gt;assign( 'weblog_link_gallery_atom',    YDUrl::makeLinkAbsolute( 'xml.php?do=atomgallery' ) );
             $this-&gt;tpl-&gt;assign( 'weblog_link_archive',         YDUrl::makeLinkAbsolute( 'archive.php' ) );
             $this-&gt;tpl-&gt;assign( 'weblog_link_archive_gallery', YDUrl::makeLinkAbsolute( 'archive_gallery.php' ) );
+            $this-&gt;tpl-&gt;assign( 'bb2_comment',                 trim( bb2_insert_head() ) );
 
             // Add the Google Analytics tag
             if ( YDConfig::get( 'google_analytics', '' ) != '' ) {

Modified: YDFramework2.0/trunk/examples/weblog/include/YDWeblog_init.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/YDWeblog_init.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/YDWeblog_init.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -91,6 +91,9 @@
         YDConfig::get( 'db_pass', '' ), YDConfig::get( 'db_host', 'localhost' )
     );
 
+    // Include bad behaviour
+    @ include_once( dirname( __FILE__ ) . '/Bad-Behavior/bad-behavior-ydweblog.php' );
+
     // Set the right locale
     $language = YDConfig::get( 'weblog_language', 'en' );
     $language = empty( $language ) ? 'en' : $language;

Modified: YDFramework2.0/trunk/examples/weblog/include/languages/language_en.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/languages/language_en.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/languages/language_en.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -147,6 +147,7 @@
 $GLOBALS['t']['a_statistics'] = 'Statistics';
 $GLOBALS['t']['h_logoff'] = 'Logoff';
 $GLOBALS['t']['a_logoff'] = 'Logoff';
+$GLOBALS['t']['a_bad_behavior'] = 'Bad Behavior';
 
 // manage/login.tpl
 $GLOBALS['t']['username'] = 'User';
@@ -375,4 +376,12 @@
 $GLOBALS['t']['schema_version'] = 'Database schema version';
 $GLOBALS['t']['installed_on'] = 'installed on';
 
+// manage/bad_behavior.tpl
+$GLOBALS['t']['total_bad_requests_stopped'] = 'Total Count Of Denied Requests';
+$GLOBALS['t']['requests'] = 'requests';
+$GLOBALS['t']['total_bad_requests_stopped'] = 'Denied Requests';
+$GLOBALS['t']['ip'] = 'IP';
+$GLOBALS['t']['request_method'] = 'Method';
+$GLOBALS['t']['url'] = 'URL';
+
 ?&gt;

Modified: YDFramework2.0/trunk/examples/weblog/include/languages/language_nl.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/include/languages/language_nl.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/include/languages/language_nl.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -147,6 +147,7 @@
 $GLOBALS['t']['a_statistics'] = 'Statistieken';
 $GLOBALS['t']['h_logoff'] = 'Afmelden';
 $GLOBALS['t']['a_logoff'] = 'Afmelden';
+$GLOBALS['t']['a_bad_behavior'] = 'Bad Behavior';
 
 // manage/login.tpl
 $GLOBALS['t']['username'] = 'Gebruiker';
@@ -375,4 +376,12 @@
 $GLOBALS['t']['schema_version'] = 'Database schema versie';
 $GLOBALS['t']['installed_on'] = 'ge&iuml;nstalleerd op';
 
+// manage/bad_behavior.tpl
+$GLOBALS['t']['total_bad_requests_stopped'] = 'Total Aantal Geweigerde Requests';
+$GLOBALS['t']['requests'] = 'requests';
+$GLOBALS['t']['bad_requests_stopped'] = 'Geweigerde Requests';
+$GLOBALS['t']['ip'] = 'IP';
+$GLOBALS['t']['request_method'] = 'Methode';
+$GLOBALS['t']['url'] = 'URL';
+
 ?&gt;

Modified: YDFramework2.0/trunk/examples/weblog/manage/__mng_header.tpl
===================================================================
--- YDFramework2.0/trunk/examples/weblog/manage/__mng_header.tpl	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/manage/__mng_header.tpl	2006-12-30 21:22:13 UTC (rev 2283)
@@ -142,6 +142,7 @@
                         &lt;td class=&quot;adminRowL&quot;&gt;
                             &lt;b&gt;{t w=&quot;h_statistics&quot;}&lt;/b&gt;&lt;br/&gt;
                             &raquo; &lt;a href=&quot;<A HREF="https://www.google.com/analytics/home/">https://www.google.com/analytics/home/</A>&quot; target=&quot;_blank&quot;&gt;{t w=&quot;cfg_google_analytics&quot;}&lt;/a&gt;&lt;br/&gt;
+                            &raquo; &lt;a href=&quot;bad_behavior.php&quot;&gt;{t w=&quot;a_bad_behavior&quot;}&lt;/a&gt;&lt;br/&gt;
                         &lt;/td&gt;
                     &lt;/tr&gt;
                 {/if}

Added: YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.php
===================================================================
--- YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.php	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.php	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,41 @@
+&lt;?php
+
+    // Include the Yellow Duck Framework
+    include_once( dirname( __FILE__ ) . '/../include/YDWeblog_init.php' );
+
+    // Class definition
+    class bad_behavior extends YDWeblogAdminRequest {
+
+        // Class constructor
+        function bad_behavior() {
+            $this-&gt;YDWeblogAdminRequest();
+        }
+
+        // Default action
+        function actionDefault() {
+
+            // Get the count and number of requests
+            $requests_count = $this-&gt;weblog-&gt;getBadBehaviorRequestsCount();
+            $requests = $this-&gt;weblog-&gt;getBadBehaviorRequests();
+
+            // Get the pagesize and current page from the URL
+            $page = @ $_GET['page'];
+
+            // Create the YDRecordSet object
+            $requests = new YDRecordSet( $requests, $page, YDConfig::get( 'YD_DB_DEFAULTPAGESIZE', 20 ) );
+
+            // Assign it to the template
+            $this-&gt;tpl-&gt;assign( 'requests_count', $requests_count );
+            $this-&gt;tpl-&gt;assign( 'requests', $requests );
+
+            // Display the template
+            $this-&gt;display();
+
+        }
+
+    }
+
+    // Process the request
+    YDInclude( 'YDF2_process.php' );
+
+?&gt;

Added: YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.tpl
===================================================================
--- YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.tpl	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/manage/bad_behavior.tpl	2006-12-30 21:22:13 UTC (rev 2283)
@@ -0,0 +1,47 @@
+{include file=&quot;__mng_header.tpl&quot;}
+
+&lt;p class=&quot;title&quot;&gt;{t w=&quot;h_statistics&quot;} &raquo; {t w=&quot;a_bad_behavior&quot;}&lt;/p&gt;
+
+{if $YD_ACTION == 'default'}
+
+    &lt;table width=&quot;700&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot;&gt;
+        &lt;tr&gt;
+            &lt;th class=&quot;adminRowLG&quot; colspan=&quot;7&quot;&gt;
+                &raquo; {t w=&quot;total_bad_requests_stopped&quot;}
+            &lt;/th&gt;
+        &lt;/tr&gt;
+        &lt;tr&gt;&lt;td colspan=&quot;7&quot; class=&quot;adminRowL&quot;&gt;{$requests_count} {t w=&quot;requests&quot;}&lt;/td&gt;&lt;/tr&gt;
+        {if $requests-&gt;set}
+            &lt;tr&gt;&lt;td colspan=&quot;7&quot;&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;
+            &lt;tr&gt;
+                &lt;th class=&quot;adminRowLG&quot; colspan=&quot;7&quot;&gt;
+                    &raquo; {t w=&quot;bad_requests_stopped&quot;}
+                &lt;/th&gt;
+            &lt;/tr&gt;
+            &lt;tr&gt;
+                &lt;th class=&quot;adminRowL&quot;&gt;{t w=&quot;date&quot;}&lt;/th&gt;
+                &lt;th class=&quot;adminRowL&quot;&gt;{t w=&quot;ip&quot;}&lt;/th&gt;
+                &lt;th class=&quot;adminRowL&quot;&gt;{t w=&quot;request_method&quot;}&lt;/th&gt;
+                &lt;th class=&quot;adminRowL&quot;&gt;{t w=&quot;url&quot;}&lt;/th&gt;
+            &lt;/tr&gt;
+            &lt;tr&gt;&lt;td class=&quot;adminRowR&quot; colspan=&quot;5&quot;&gt;{$requests-&gt;getBrowseBar()}&lt;/td&gt;&lt;/tr&gt;
+            {foreach from=$requests-&gt;set item=&quot;request&quot;}
+                &lt;tr onMouseOver=&quot;YDRowMouseOver(this);&quot; onMouseOut=&quot;YDRowMouseOut(this);&quot; {if $comment.item_is_draft eq '1'}style=&quot;color: gray&quot;{/if}&gt;
+                    &lt;td class=&quot;adminRowL&quot;&gt;{$request.date}&lt;/td&gt;
+                    &lt;td class=&quot;adminRowL&quot;&gt;{$request.ip}&lt;/td&gt;
+                    &lt;td class=&quot;adminRowL&quot;&gt;{$request.request_method}&lt;/td&gt;
+                    &lt;td class=&quot;adminRowL&quot;&gt;{$request.request_uri}&lt;/td&gt;
+                &lt;/tr&gt;
+            {/foreach}
+            &lt;tr&gt;&lt;td class=&quot;adminRowR&quot; colspan=&quot;5&quot;&gt;{$requests-&gt;getBrowseBar()}&lt;/td&gt;&lt;/tr&gt;
+            &lt;tr&gt;
+                &lt;td class=&quot;adminRowLNB&quot; colspan=&quot;5&quot;&gt;
+                    &lt;p class=&quot;subline&quot;&gt;{t w=&quot;total&quot;}: {$requests-&gt;totalRows}&lt;/p&gt;
+                &lt;/td&gt;
+            &lt;/tr&gt;
+        {/if}
+    &lt;/table&gt;
+
+{/if}
+
+{include file=&quot;__mng_footer.tpl&quot;}

Modified: YDFramework2.0/trunk/examples/weblog/skins/default/__std_header.tpl
===================================================================
--- YDFramework2.0/trunk/examples/weblog/skins/default/__std_header.tpl	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/skins/default/__std_header.tpl	2006-12-30 21:22:13 UTC (rev 2283)
@@ -68,6 +68,8 @@
     //--&gt;
     &lt;/script&gt;
 
+    {$bb2_comment}
+
 &lt;/head&gt;
 
 &lt;body&gt;

Modified: YDFramework2.0/trunk/examples/weblog/skins/default_with_lightbox/__std_header.tpl
===================================================================
--- YDFramework2.0/trunk/examples/weblog/skins/default_with_lightbox/__std_header.tpl	2006-12-30 20:05:33 UTC (rev 2282)
+++ YDFramework2.0/trunk/examples/weblog/skins/default_with_lightbox/__std_header.tpl	2006-12-30 21:22:13 UTC (rev 2283)
@@ -74,6 +74,8 @@
     //--&gt;
     &lt;/script&gt;
 
+    {$bb2_comment}
+
 &lt;/head&gt;
 
 &lt;body&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000874.html">[ydf-devel] r2282 - YDFramework2.0/trunk/examples/weblog/include
</A></li>
	<LI>Next message: <A HREF="000876.html">[ydf-devel] r2284 - YDFramework2.0/trunk/examples/weblog/include
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#875">[ date ]</a>
              <a href="thread.html#875">[ thread ]</a>
              <a href="subject.html#875">[ subject ]</a>
              <a href="author.html#875">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/ydframework-devel">More information about the YDFramework-devel
mailing list</a><br>
</body></html>
